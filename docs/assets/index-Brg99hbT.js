const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-aHbKK8nV.js","assets/webworkerAll-DZgcpcJl.js","assets/colorToUniform-KTpA7KSL.js","assets/CanvasPool-Btwa6r10.js","assets/WebGPURenderer-C8iqI4mb.js","assets/SharedSystems-D3kIeP0I.js","assets/WebGLRenderer-yThigZ1g.js"])))=>i.map(i=>d[i]);
var ja=Object.defineProperty;var Za=(r,t,e)=>t in r?ja(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var L=(r,t,e)=>Za(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const Ha="modulepreload",Ya=function(r){return"/visualizer-demo/"+r},oi={},Ms=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(e.map(h=>{if(h=Ya(h),h in oi)return;oi[h]=!0;const l=h.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":Ha,l||(u.as="script"),u.crossOrigin="",u.href=h,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((f,d)=>{u.addEventListener("load",f),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${h}`)))})}))}function n(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&n(o.reason);return t().catch(n)})};var rt=(r=>(r.Application="application",r.WebGLPipes="webgl-pipes",r.WebGLPipesAdaptor="webgl-pipes-adaptor",r.WebGLSystem="webgl-system",r.WebGPUPipes="webgpu-pipes",r.WebGPUPipesAdaptor="webgpu-pipes-adaptor",r.WebGPUSystem="webgpu-system",r.CanvasSystem="canvas-system",r.CanvasPipesAdaptor="canvas-pipes-adaptor",r.CanvasPipes="canvas-pipes",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r.MaskEffect="mask-effect",r.BlendMode="blend-mode",r.TextureSource="texture-source",r.Environment="environment",r.ShapeBuilder="shape-builder",r.Batcher="batcher",r))(rt||{});const vr=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},fs=(r,t)=>vr(r).priority??t,Pt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(vr).forEach(t=>{t.type.forEach(e=>{var s,i;return(i=(s=this._removeHandlers)[e])==null?void 0:i.call(s,t)})}),this},add(...r){return r.map(vr).forEach(t=>{t.type.forEach(e=>{var n,a;const s=this._addHandlers,i=this._queue;s[e]?(a=s[e])==null||a.call(s,t):(i[e]=i[e]||[],(n=i[e])==null||n.push(t))})}),this},handle(r,t,e){var a;const s=this._addHandlers,i=this._removeHandlers;if(s[r]||i[r])throw new Error(`Extension type ${r} already has a handler`);s[r]=t,i[r]=e;const n=this._queue;return n[r]&&((a=n[r])==null||a.forEach(o=>t(o)),delete n[r]),this},handleByMap(r,t){return this.handle(r,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(r,t,e=-1){return this.handle(r,s=>{t.findIndex(n=>n.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((n,a)=>fs(a.value,e)-fs(n.value,e)))},s=>{const i=t.findIndex(n=>n.name===s.name);i!==-1&&t.splice(i,1)})},handleByList(r,t,e=-1){return this.handle(r,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((i,n)=>fs(n,e)-fs(i,e)))},s=>{const i=t.indexOf(s.ref);i!==-1&&t.splice(i,1)})},mixin(r,...t){for(const e of t)Object.defineProperties(r.prototype,Object.getOwnPropertyDescriptors(e))}},Xa={extension:{type:rt.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ms(()=>import("./browserAll-aHbKK8nV.js"),__vite__mapDeps([0,1,2,3]))}},qa={extension:{type:rt.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ms(()=>import("./webworkerAll-DZgcpcJl.js"),__vite__mapDeps([1,2,3]))}};class wt{constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new wt(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Ur(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Vs={exports:{}},hi;function Ka(){return hi||(hi=1,function(r){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function i(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new i(c,u||h,f),g=e?e+l:l;return h._events[g]?h._events[g].fn?h._events[g]=[h._events[g],d]:h._events[g].push(d):(h._events[g]=d,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,g=new Array(d);f<d;f++)g[f]=u[f].fn;return g},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,f,d,g){var x=e?e+l:l;if(!this._events[x])return!1;var m=this._events[x],b=arguments.length,v,w;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),b){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,f),!0;case 5:return m.fn.call(m.context,c,u,f,d),!0;case 6:return m.fn.call(m.context,c,u,f,d,g),!0}for(w=1,v=new Array(b-1);w<b;w++)v[w-1]=arguments[w];m.fn.apply(m.context,v)}else{var A=m.length,R;for(w=0;w<A;w++)switch(m[w].once&&this.removeListener(l,m[w].fn,void 0,!0),b){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,c);break;case 3:m[w].fn.call(m[w].context,c,u);break;case 4:m[w].fn.call(m[w].context,c,u,f);break;default:if(!v)for(R=1,v=new Array(b-1);R<b;R++)v[R-1]=arguments[R];m[w].fn.apply(m[w].context,v)}}return!0},o.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,f){var d=e?e+l:l;if(!this._events[d])return this;if(!c)return a(this,d),this;var g=this._events[d];if(g.fn)g.fn===c&&(!f||g.once)&&(!u||g.context===u)&&a(this,d);else{for(var x=0,m=[],b=g.length;x<b;x++)(g[x].fn!==c||f&&!g[x].once||u&&g[x].context!==u)&&m.push(g[x]);m.length?this._events[d]=m.length===1?m[0]:m:a(this,d)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,r.exports=o}(Vs)),Vs.exports}var Ja=Ka();const Zt=Ur(Ja),Qa=Math.PI*2,to=180/Math.PI,eo=Math.PI/180;class xt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new xt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Us.x=0,Us.y=0,Us}}const Us=new xt;class J{constructor(t=1,e=0,s=0,i=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,i,n,a){return this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new xt;const s=t.x,i=t.y;return e.x=this.a*s+this.c*i+this.tx,e.y=this.b*s+this.d*i+this.ty,e}applyInverse(t,e){e=e||new xt;const s=this.a,i=this.b,n=this.c,a=this.d,o=this.tx,h=this.ty,l=1/(s*a+n*-i),c=t.x,u=t.y;return e.x=a*l*c+-n*l*u+(h*n-o*a)*l,e.y=s*l*u+-i*l*c+(-h*s+o*i)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),i=this.a,n=this.c,a=this.tx;return this.a=i*e-this.b*s,this.b=i*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=a*e-this.ty*s,this.ty=a*s+this.ty*e,this}append(t){const e=this.a,s=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}appendFrom(t,e){const s=t.a,i=t.b,n=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,f=e.d;return this.a=s*l+i*u,this.b=s*c+i*f,this.c=n*l+a*u,this.d=n*c+a*f,this.tx=o*l+h*u+e.tx,this.ty=o*c+h*f+e.ty,this}setTransform(t,e,s,i,n,a,o,h,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(s*this.a+i*this.c),this.ty=e-(s*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,i=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,i=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-i,n),h=Math.atan2(s,e),l=Math.abs(o+h);return l<1e-5||Math.abs(Qa-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(a.x*e+a.y*i),t.position.y=this.ty+(a.x*s+a.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,i=this.d,n=this.tx,a=t*i-e*s;return this.a=i/a,this.b=-e/a,this.c=-s/a,this.d=t/a,this.tx=(s*this.ty-i*n)/a,this.ty=-(t*this.ty-e*n)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new J;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return ro.identity()}static get shared(){return so.identity()}}const so=new J,ro=new J,ce=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ue=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],de=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],fe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],wr=[],yn=[],ps=Math.sign;function io(){for(let r=0;r<16;r++){const t=[];wr.push(t);for(let e=0;e<16;e++){const s=ps(ce[r]*ce[e]+de[r]*ue[e]),i=ps(ue[r]*ce[e]+fe[r]*ue[e]),n=ps(ce[r]*de[e]+de[r]*fe[e]),a=ps(ue[r]*de[e]+fe[r]*fe[e]);for(let o=0;o<16;o++)if(ce[o]===s&&ue[o]===i&&de[o]===n&&fe[o]===a){t.push(o);break}}}for(let r=0;r<16;r++){const t=new J;t.set(ce[r],ue[r],de[r],fe[r],0,0),yn.push(t)}}io();const ht={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>ce[r],uY:r=>ue[r],vX:r=>de[r],vY:r=>fe[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>wr[r][t],sub:(r,t)=>wr[r][ht.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?ht.S:ht.N:Math.abs(t)*2<=Math.abs(r)?r>0?ht.E:ht.W:t>0?r>0?ht.SE:ht.SW:r>0?ht.NE:ht.NW,matrixAppendRotationInv:(r,t,e=0,s=0)=>{const i=yn[ht.inv(t)];i.tx=e,i.ty=s,r.append(i)}},ms=[new xt,new xt,new xt,new xt];class pt{constructor(t=0,e=0,s=0,i=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new pt(0,0,0,0)}clone(){return new pt(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,s,i=.5){const{width:n,height:a}=this;if(n<=0||a<=0)return!1;const o=this.x,h=this.y,l=s*(1-i),c=s-l,u=o-l,f=o+n+l,d=h-l,g=h+a+l,x=o+c,m=o+n-c,b=h+c,v=h+a-c;return t>=u&&t<=f&&e>=d&&e<=g&&!(t>x&&t<m&&e>b&&e<v)}intersects(t,e){if(!e){const Z=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=Z)return!1;const B=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>B}const s=this.left,i=this.right,n=this.top,a=this.bottom;if(i<=s||a<=n)return!1;const o=ms[0].set(t.left,t.top),h=ms[1].set(t.left,t.bottom),l=ms[2].set(t.right,t.top),c=ms[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=s||Math.min(o.x,h.x,l.x,c.x)>=i||Math.max(o.y,h.y,l.y,c.y)<=n||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const f=u*(h.y-o.y),d=u*(o.x-h.x),g=f*s+d*n,x=f*i+d*n,m=f*s+d*a,b=f*i+d*a;if(Math.max(g,x,m,b)<=f*o.x+d*o.y||Math.min(g,x,m,b)>=f*c.x+d*c.y)return!1;const v=u*(o.y-l.y),w=u*(l.x-o.x),A=v*s+w*n,R=v*i+w*n,k=v*s+w*a,P=v*i+w*a;return!(Math.max(A,R,k,P)<=v*o.x+w*o.y||Math.min(A,R,k,P)>=v*c.x+w*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=i-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=i,this.height=n-i,this}getBounds(t){return t||(t=new pt),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,s=t.y,i=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height&&i>=this.x&&i<this.x+this.width&&n>=this.y&&n<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const $s={default:-1};function ft(r="default"){return $s[r]===void 0&&($s[r]=-1),++$s[r]}const li={},ct="8.0.0",no="8.3.4";function X(r,t,e=3){if(li[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(s))),li[t]=!0}const xn=()=>{};function ci(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function ui(r){return!(r&r-1)&&!!r}function _n(r){const t={};for(const e in r)r[e]!==void 0&&(t[e]=r[e]);return t}const di=Object.create(null);function ao(r){const t=di[r];return t===void 0&&(di[r]=ft("resource")),t}const bn=class vn extends Zt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...vn.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){X(ct,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=ao(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};bn.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let oo=bn;const wn=class Cn extends Zt{constructor(t={}){super(),this.options=t,this.uid=ft("textureSource"),this._resourceType="textureSource",this._resourceId=ft("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Cn.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new oo(_n(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,s;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(s=this._style)==null||s.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=ft("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s||(s=this._resolution),t||(t=this.width),e||(e=this.height);const i=Math.round(t*s),n=Math.round(e*s);return this.width=i/s,this.height=n/s,this._resolution=s,this.pixelWidth===i&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=n,this.emit("resize",this),this._resourceId=ft("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=ui(this.pixelWidth)&&ui(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};wn.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Ht=wn;class $r extends Ht{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let s=t.format;s||(e instanceof Float32Array?s="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?s="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?s="rgba16uint":(e instanceof Int8Array,s="bgra8unorm")),super({...t,resource:e,format:s}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}$r.extension=rt.TextureSource;const fi=new J;class ho{constructor(t,e){this.mapCoord=new J,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let i=0;i<t.length;i+=2){const n=t[i],a=t[i+1];e[i]=n*s.a+a*s.c+s.tx,e[i+1]=n*s.b+a*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.orig,i=t.trim;i&&(fi.set(s.width/i.width,0,0,s.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(fi));const n=t.source,a=this.uClampFrame,o=this.clampMargin/n._resolution,h=this.clampOffset/n._resolution;return a[0]=(t.frame.x+o+h)/n.width,a[1]=(t.frame.y+o+h)/n.height,a[2]=(t.frame.x+t.frame.width-o+h)/n.width,a[3]=(t.frame.y+t.frame.height-o+h)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}class nt extends Zt{constructor({source:t,label:e,frame:s,orig:i,trim:n,defaultAnchor:a,defaultBorders:o,rotate:h,dynamic:l}={}){if(super(),this.uid=ft("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new pt,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Ht,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=i||this.frame,this.trim=n,this.rotate=h??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ho(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:s,height:i}=this._source,n=e.x/s,a=e.y/i,o=e.width/s,h=e.height/i;let l=this.rotate;if(l){const c=o/2,u=h/2,f=n+c,d=a+u;l=ht.add(l,ht.NW),t.x0=f+c*ht.uX(l),t.y0=d+u*ht.uY(l),l=ht.add(l,2),t.x1=f+c*ht.uX(l),t.y1=d+u*ht.uY(l),l=ht.add(l,2),t.x2=f+c*ht.uX(l),t.y2=d+u*ht.uY(l),l=ht.add(l,2),t.x3=f+c*ht.uX(l),t.y3=d+u*ht.uY(l)}else t.x0=n,t.y0=a,t.x1=n+o,t.y1=a,t.x2=n+o,t.y2=a+h,t.x3=n,t.y3=a+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return X(ct,"Texture.baseTexture is now Texture.source"),this._source}}nt.EMPTY=new nt({label:"EMPTY",source:new Ht({label:"EMPTY"})});nt.EMPTY.destroy=xn;nt.WHITE=new nt({source:new $r({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});nt.WHITE.destroy=xn;function lo(r,t,e){const{width:s,height:i}=e.orig,n=e.trim;if(n){const a=n.width,o=n.height;r.minX=n.x-t._x*s,r.maxX=r.minX+a,r.minY=n.y-t._y*i,r.maxY=r.minY+o}else r.minX=-t._x*s,r.maxX=r.minX+s,r.minY=-t._y*i,r.maxY=r.minY+i}const pi=new J;class Bt{constructor(t=1/0,e=1/0,s=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=pi,this.minX=t,this.minY=e,this.maxX=s,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new pt);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=pi,this}set(t,e,s,i){this.minX=t,this.minY=e,this.maxX=s,this.maxY=i}addFrame(t,e,s,i,n){n||(n=this.matrix);const a=n.a,o=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let f=this.minX,d=this.minY,g=this.maxX,x=this.maxY,m=a*t+h*e+c,b=o*t+l*e+u;m<f&&(f=m),b<d&&(d=b),m>g&&(g=m),b>x&&(x=b),m=a*s+h*e+c,b=o*s+l*e+u,m<f&&(f=m),b<d&&(d=b),m>g&&(g=m),b>x&&(x=b),m=a*t+h*i+c,b=o*t+l*i+u,m<f&&(f=m),b<d&&(d=b),m>g&&(g=m),b>x&&(x=b),m=a*s+h*i+c,b=o*s+l*i+u,m<f&&(f=m),b<d&&(d=b),m>g&&(g=m),b>x&&(x=b),this.minX=f,this.minY=d,this.maxX=g,this.maxY=x}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,i=this.maxX,n=this.maxY,{a,b:o,c:h,d:l,tx:c,ty:u}=t;let f=a*e+h*s+c,d=o*e+l*s+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=a*i+h*s+c,d=o*i+l*s+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*e+h*n+c,d=o*e+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*i+h*n+c,d=o*i+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,s,i){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<s&&(this.minY=s),this.maxY>i&&(this.maxY=i),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Bt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s,i){let n=this.minX,a=this.minY,o=this.maxX,h=this.maxY;i||(i=this.matrix);const l=i.a,c=i.b,u=i.c,f=i.d,d=i.tx,g=i.ty;for(let x=e;x<s;x+=2){const m=t[x],b=t[x+1],v=l*m+u*b+d,w=c*m+f*b+g;n=v<n?v:n,a=w<a?w:a,o=v>o?v:o,h=w>h?w:h}this.minX=n,this.minY=a,this.maxX=o,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var co={grad:.9,turn:360,rad:360/(2*Math.PI)},Kt=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},gt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},kt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},Sn=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},mi=function(r){return{r:kt(r.r,0,255),g:kt(r.g,0,255),b:kt(r.b,0,255),a:kt(r.a)}},Ws=function(r){return{r:gt(r.r),g:gt(r.g),b:gt(r.b),a:gt(r.a,3)}},uo=/^#([0-9a-f]{3,8})$/i,gs=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},An=function(r){var t=r.r,e=r.g,s=r.b,i=r.a,n=Math.max(t,e,s),a=n-Math.min(t,e,s),o=a?n===t?(e-s)/a:n===e?2+(s-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:i}},Tn=function(r){var t=r.h,e=r.s,s=r.v,i=r.a;t=t/360*6,e/=100,s/=100;var n=Math.floor(t),a=s*(1-e),o=s*(1-(t-n)*e),h=s*(1-(1-t+n)*e),l=n%6;return{r:255*[s,o,a,a,h,s][l],g:255*[h,s,s,o,a,a][l],b:255*[a,a,h,s,s,o][l],a:i}},gi=function(r){return{h:Sn(r.h),s:kt(r.s,0,100),l:kt(r.l,0,100),a:kt(r.a)}},yi=function(r){return{h:gt(r.h),s:gt(r.s),l:gt(r.l),a:gt(r.a,3)}},xi=function(r){return Tn((e=(t=r).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},$e=function(r){return{h:(t=An(r)).h,s:(i=(200-(e=t.s))*(s=t.v)/100)>0&&i<200?e*s/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,e,s,i},fo=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,po=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mo=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,go=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Cr={string:[[function(r){var t=uo.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?gt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?gt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=mo.exec(r)||go.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:mi({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=fo.exec(r)||po.exec(r);if(!t)return null;var e,s,i=gi({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(co[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return xi(i)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,s=r.b,i=r.a,n=i===void 0?1:i;return Kt(t)&&Kt(e)&&Kt(s)?mi({r:Number(t),g:Number(e),b:Number(s),a:Number(n)}):null},"rgb"],[function(r){var t=r.h,e=r.s,s=r.l,i=r.a,n=i===void 0?1:i;if(!Kt(t)||!Kt(e)||!Kt(s))return null;var a=gi({h:Number(t),s:Number(e),l:Number(s),a:Number(n)});return xi(a)},"hsl"],[function(r){var t=r.h,e=r.s,s=r.v,i=r.a,n=i===void 0?1:i;if(!Kt(t)||!Kt(e)||!Kt(s))return null;var a=function(o){return{h:Sn(o.h),s:kt(o.s,0,100),v:kt(o.v,0,100),a:kt(o.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(n)});return Tn(a)},"hsv"]]},_i=function(r,t){for(var e=0;e<t.length;e++){var s=t[e][0](r);if(s)return[s,t[e][1]]}return[null,void 0]},yo=function(r){return typeof r=="string"?_i(r.trim(),Cr.string):typeof r=="object"&&r!==null?_i(r,Cr.object):[null,void 0]},js=function(r,t){var e=$e(r);return{h:e.h,s:kt(e.s+100*t,0,100),l:e.l,a:e.a}},Zs=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},bi=function(r,t){var e=$e(r);return{h:e.h,s:e.s,l:kt(e.l+100*t,0,100),a:e.a}},Sr=function(){function r(t){this.parsed=yo(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return gt(Zs(this.rgba),2)},r.prototype.isDark=function(){return Zs(this.rgba)<.5},r.prototype.isLight=function(){return Zs(this.rgba)>=.5},r.prototype.toHex=function(){return t=Ws(this.rgba),e=t.r,s=t.g,i=t.b,a=(n=t.a)<1?gs(gt(255*n)):"","#"+gs(e)+gs(s)+gs(i)+a;var t,e,s,i,n,a},r.prototype.toRgb=function(){return Ws(this.rgba)},r.prototype.toRgbString=function(){return t=Ws(this.rgba),e=t.r,s=t.g,i=t.b,(n=t.a)<1?"rgba("+e+", "+s+", "+i+", "+n+")":"rgb("+e+", "+s+", "+i+")";var t,e,s,i,n},r.prototype.toHsl=function(){return yi($e(this.rgba))},r.prototype.toHslString=function(){return t=yi($e(this.rgba)),e=t.h,s=t.s,i=t.l,(n=t.a)<1?"hsla("+e+", "+s+"%, "+i+"%, "+n+")":"hsl("+e+", "+s+"%, "+i+"%)";var t,e,s,i,n},r.prototype.toHsv=function(){return t=An(this.rgba),{h:gt(t.h),s:gt(t.s),v:gt(t.v),a:gt(t.a,3)};var t},r.prototype.invert=function(){return Lt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),Lt(js(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),Lt(js(this.rgba,-t))},r.prototype.grayscale=function(){return Lt(js(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),Lt(bi(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),Lt(bi(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?Lt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):gt(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=$e(this.rgba);return typeof t=="number"?Lt({h:t,s:e.s,l:e.l,a:e.a}):gt(e.h)},r.prototype.isEqual=function(t){return this.toHex()===Lt(t).toHex()},r}(),Lt=function(r){return r instanceof Sr?r:new Sr(r)},vi=[],xo=function(r){r.forEach(function(t){vi.indexOf(t)<0&&(t(Sr,Cr),vi.push(t))})};function _o(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var i in e)s[e[i]]=i;var n={};r.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,h,l=s[this.toHex()];if(l)return l;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,f="black";if(!n.length)for(var d in e)n[d]=new r(e[d]).toRgb();for(var g in e){var x=(o=c,h=n[g],Math.pow(o.r-h.r,2)+Math.pow(o.g-h.g,2)+Math.pow(o.b-h.b,2));x<u&&(u=x,f=g)}return f}},t.string.push([function(a){var o=a.toLowerCase(),h=o==="transparent"?"#0000":e[o];return h?new r(h).toRgb():null},"name"])}xo([_o]);const ke=class Ge{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Ge)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,a)=>n===e[a]);if(t!==null&&e!==null){const n=Object.keys(t),a=Object.keys(e);return n.length!==a.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,s,i]=this._components;return{r:t,g:e,b:s,a:i}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(i*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,s,i,n]=this._components;return t[0]=e,t[1]=s,t[2]=i,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,s,i]=this._components;return t[0]=e,t[1]=s,t[2]=i,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,i,n]=Ge._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=i,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,i=this._int>>8&255,n=this._int&255;return e&&(s=s*t+.5|0,i=i*t+.5|0,n=n*t+.5|0),(t*255<<24)+(s<<16)+(i<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,s,i,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,s=(a>>8&255)/255,i=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,i,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,i,n=255]=t,e/=255,s/=255,i/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=Ge.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=Lt(t);a.isValid()&&({r:e,g:s,b:i,a:n}=a.rgba,e/=255,s/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=i,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((i,n)=>{t[n]=Math.min(Math.max(i,e),s)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Ge||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};ke.shared=new ke;ke._temp=new ke;ke.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let yt=ke;const bo={cullArea:null,cullable:!1,cullableChildren:!0};class Wr{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var s;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(s=e.init)==null||s.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class vo{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Wr(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const te=new vo,wo={get isCachedAsTexture(){var r;return!!((r=this.renderGroup)!=null&&r.isCachedAsTexture)},cacheAsTexture(r){typeof r=="boolean"&&r===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(r===!0?{}:r))},updateCacheTexture(){var r;(r=this.renderGroup)==null||r.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(r){X("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(r)}};function Co(r,t,e){const s=r.length;let i;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(i=t;i<n;++i)r[i]=r[i+e];r.length=n}const So={allowChildren:!0,removeChildren(r=0,t){const e=t??this.children.length,s=e-r,i=[];if(s>0&&s<=e){for(let a=e-1;a>=r;a--){const o=this.children[a];o&&(i.push(o),o.parent=null)}Co(this.children,r,e);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(i);for(let a=0;a<i.length;++a)this.emit("childRemoved",i[a],this,a),i[a].emit("removed",this);return i.length>0&&this._didViewChangeTick++,i}else if(s===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(r){const t=this.getChildAt(r);return this.removeChild(t)},getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]},setChildIndex(r,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(r),this.addChildAt(r,t)},getChildIndex(r){const t=this.children.indexOf(r);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(r,t){this.allowChildren||X(ct,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${r}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(r.parent){const i=r.parent.children.indexOf(r);if(r.parent===this&&i===t)return r;i!==-1&&r.parent.children.splice(i,1)}t===e.length?e.push(r):e.splice(t,0,r),r.parent=this,r.didChange=!0,r._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(r),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",r,this,t),r.emit("added",this),r},swapChildren(r,t){if(r===t)return;const e=this.getChildIndex(r),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=r;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var r;(r=this.parent)==null||r.removeChild(this)},reparentChild(...r){return r.length===1?this.reparentChildAt(r[0],this.children.length):(r.forEach(t=>this.reparentChildAt(t,this.children.length)),r[0])},reparentChildAt(r,t){if(r.parent===this)return this.setChildIndex(r,t),r;const e=r.worldTransform.clone();r.removeFromParent(),this.addChildAt(r,t);const s=this.worldTransform.clone();return s.invert(),e.prepend(s),r.setFromMatrix(e),r}},Ao={collectRenderables(r,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(r,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,r):this.collectRenderablesWithEffects(r,t,e))},collectRenderablesSimple(r,t,e){const s=this.children,i=s.length;for(let n=0;n<i;n++)s[n].collectRenderables(r,t,e)},collectRenderablesWithEffects(r,t,e){const{renderPipes:s}=t;for(let i=0;i<this.effects.length;i++){const n=this.effects[i];s[n.pipe].push(n,this,r)}this.collectRenderablesSimple(r,t,e);for(let i=this.effects.length-1;i>=0;i--){const n=this.effects[i];s[n.pipe].pop(n,this,r)}}};class wi{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class To{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const s=this._tests[e];if(s.test(t))return te.get(s.maskClass,t)}return t}returnMaskEffect(t){te.return(t)}}const Ar=new To;Pt.handleByList(rt.MaskEffect,Ar._effectClasses);const Mo={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0)},addEffect(r){this.effects.indexOf(r)===-1&&(this.effects.push(r),this.effects.sort((e,s)=>e.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(r){const t=this.effects.indexOf(r);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(r){const t=this._maskEffect;(t==null?void 0:t.mask)!==r&&(t&&(this.removeEffect(t),Ar.returnMaskEffect(t),this._maskEffect=null),r!=null&&(this._maskEffect=Ar.getMaskEffect(r),this.addEffect(this._maskEffect)))},setMask(r){this._maskOptions={...this._maskOptions,...r},r.mask&&(this.mask=r.mask),this._markStructureAsChanged()},get mask(){var r;return(r=this._maskEffect)==null?void 0:r.mask},set filters(r){var n;!Array.isArray(r)&&r&&(r=[r]);const t=this._filterEffect||(this._filterEffect=new wi);r=r;const e=(r==null?void 0:r.length)>0,s=((n=t.filters)==null?void 0:n.length)>0,i=e!==s;r=Array.isArray(r)?r.slice(0):r,t.filters=Object.freeze(r),i&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=r??null))},get filters(){var r;return(r=this._filterEffect)==null?void 0:r.filters},set filterArea(r){this._filterEffect||(this._filterEffect=new wi),this._filterEffect.filterArea=r},get filterArea(){var r;return(r=this._filterEffect)==null?void 0:r.filterArea}},ko={label:null,get name(){return X(ct,"Container.name property has been removed, use Container.label instead"),this.label},set name(r){X(ct,"Container.name property has been removed, use Container.label instead"),this.label=r},getChildByName(r,t=!1){return this.getChildByLabel(r,t)},getChildByLabel(r,t=!1){const e=this.children;for(let s=0;s<e.length;s++){const i=e[s];if(i.label===r||r instanceof RegExp&&r.test(i.label))return i}if(t)for(let s=0;s<e.length;s++){const n=e[s].getChildByLabel(r,!0);if(n)return n}return null},getChildrenByLabel(r,t=!1,e=[]){const s=this.children;for(let i=0;i<s.length;i++){const n=s[i];(n.label===r||r instanceof RegExp&&r.test(n.label))&&e.push(n)}if(t)for(let i=0;i<s.length;i++)s[i].getChildrenByLabel(r,!0,e);return e}},bt=new Wr(J),ee=new Wr(Bt),Po=new J,Io={getFastGlobalBounds(r,t){t||(t=new Bt),t.clear(),this._getGlobalBoundsRecursive(!!r,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(r,t,e){let s=t;if(r&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const i=!!this.effects.length;if((this.renderGroup||i)&&(s=ee.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;s.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const n=this.children;for(let a=0;a<n.length;a++)n[a]._getGlobalBoundsRecursive(r,s,e)}if(i){let n=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(n||(n=!0,s.applyMatrix(a.worldTransform)),this.effects[o].addBounds(s,!0));n&&(s.applyMatrix(a.worldTransform.copyTo(Po).invert()),t.addBounds(s,this.relativeGroupTransform)),t.addBounds(s),ee.return(s)}else this.renderGroup&&(t.addBounds(s,this.relativeGroupTransform),ee.return(s))}};function Mn(r,t,e){e.clear();let s,i;return r.parent?t?s=r.parent.worldTransform:(i=bt.get().identity(),s=jr(r,i)):s=J.IDENTITY,kn(r,e,s,t),i&&bt.return(i),e.isValid||e.set(0,0,0,0),e}function kn(r,t,e,s){var o,h;if(!r.visible||!r.measurable)return;let i;s?i=r.worldTransform:(r.updateLocalTransform(),i=bt.get(),i.appendFrom(r.localTransform,e));const n=t,a=!!r.effects.length;if(a&&(t=ee.get().clear()),r.boundsArea)t.addRect(r.boundsArea,i);else{r.bounds&&(t.matrix=i,t.addBounds(r.bounds));for(let l=0;l<r.children.length;l++)kn(r.children[l],t,i,s)}if(a){for(let l=0;l<r.effects.length;l++)(h=(o=r.effects[l]).addBounds)==null||h.call(o,t);n.addBounds(t,J.IDENTITY),ee.return(t)}s||bt.return(i)}function jr(r,t){const e=r.parent;return e&&(jr(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Pn(r,t){if(r===16777215||!t)return t;if(t===16777215||!r)return r;const e=r>>16&255,s=r>>8&255,i=r&255,n=t>>16&255,a=t>>8&255,o=t&255,h=e*n/255|0,l=s*a/255|0,c=i*o/255|0;return(h<<16)+(l<<8)+c}const Ci=16777215;function Si(r,t){return r===Ci?t:t===Ci?r:Pn(r,t)}function Ss(r){return((r&255)<<16)+(r&65280)+(r>>16&255)}const Ro={getGlobalAlpha(r){if(r)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(r,t){if(t)return r.copyFrom(this.worldTransform);this.updateLocalTransform();const e=jr(this,bt.get().identity());return r.appendFrom(this.localTransform,e),bt.return(e),r},getGlobalTint(r){if(r)return this.renderGroup?Ss(this.renderGroup.worldColor):this.parentRenderGroup?Ss(Si(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=Si(t,e.localColor),e=e.parent;return Ss(t)}};let Hs=0;const Ai=500;function Tt(...r){Hs!==Ai&&(Hs++,Hs===Ai?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...r))}function In(r,t,e){return t.clear(),e||(e=J.IDENTITY),Rn(r,t,e,r,!0),t.isValid||t.set(0,0,0,0),t}function Rn(r,t,e,s,i){var h,l;let n;if(i)n=bt.get(),n=e.copyTo(n);else{if(!r.visible||!r.measurable)return;r.updateLocalTransform();const c=r.localTransform;n=bt.get(),n.appendFrom(c,e)}const a=t,o=!!r.effects.length;if(o&&(t=ee.get().clear()),r.boundsArea)t.addRect(r.boundsArea,n);else{r.renderPipeId&&(t.matrix=n,t.addBounds(r.bounds));const c=r.children;for(let u=0;u<c.length;u++)Rn(c[u],t,n,s,!1)}if(o){for(let c=0;c<r.effects.length;c++)(l=(h=r.effects[c]).addLocalBounds)==null||l.call(h,t,s);a.addBounds(t,J.IDENTITY),ee.return(t)}bt.return(n)}function En(r,t){const e=r.children;for(let s=0;s<e.length;s++){const i=e[s],n=i.uid,a=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,o=t.index;(t.data[o]!==n||t.data[o+1]!==a)&&(t.data[t.index]=n,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,i.children.length&&En(i,t)}return t.didChange}const Eo=new J,Fo={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(r,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=r/t*e:this.scale.x=e},_setHeight(r,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=r/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Bt});const r=this._localBoundsCacheData;return r.index=1,r.didChange=!1,r.data[0]!==this._didViewChangeTick&&(r.didChange=!0,r.data[0]=this._didViewChangeTick),En(this,r),r.didChange&&In(this,r.localBounds,Eo),r.localBounds},getBounds(r,t){return Mn(this,r,t||new Bt)}},Oo={_onRender:null,set onRender(r){const t=this.renderGroup||this.parentRenderGroup;if(!r){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=r},get onRender(){return this._onRender}},Bo={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(r){this._zIndex!==r&&(this._zIndex=r,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(No))}};function No(r,t){return r._zIndex-t._zIndex}const Do={getGlobalPosition(r=new xt,t=!1){return this.parent?this.parent.toGlobal(this._position,r,t):(r.x=this._position.x,r.y=this._position.y),r},toGlobal(r,t,e=!1){const s=this.getGlobalTransform(bt.get(),e);return t=s.apply(r,t),bt.return(s),t},toLocal(r,t,e,s){t&&(r=t.toGlobal(r,e,s));const i=this.getGlobalTransform(bt.get(),s);return e=i.applyInverse(r,e),bt.return(i),e}};class Fn{constructor(){this.uid=ft("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Go=0;class zo{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,s){const i=new Ht({...this.textureOptions,width:t,height:e,resolution:1,antialias:s,autoGarbageCollect:!1});return new nt({source:i,label:`texturePool_${Go++}`})}getOptimalTexture(t,e,s=1,i){let n=Math.ceil(t*s-1e-6),a=Math.ceil(e*s-1e-6);n=ci(n),a=ci(a);const o=(n<<17)+(a<<1)+(i?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let h=this._texturePool[o].pop();return h||(h=this.createTexture(n,a,i)),h.source._resolution=s,h.source.width=n/s,h.source.height=a/s,h.source.pixelWidth=n,h.source.pixelHeight=a,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=o,h}getSameSizeTexture(t,e=!1){const s=t.source;return this.getOptimalTexture(t.width,t.height,s._resolution,e)}returnTexture(t){const e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const s=this._texturePool[e];if(s)for(let i=0;i<s.length;i++)s[i].destroy(!0)}this._texturePool={}}}const Ze=new zo;class Lo{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new J,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Fn,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let s=0;s<e.length;s++){const i=e[s];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Ze.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let s=0;s<e.length;s++)this.addChild(e[s])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let s=0;s<e.length;s++)this.removeChild(e[s])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let s=0;s<e.length;s++)this._getChildren(e[s],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const s=t.children;for(let i=0;i<s.length;i++)this._getChildren(s[i],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return this._matrixDirty&1?(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new J),this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return this._matrixDirty&2?(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new J),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(this._matrixDirty&4))return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new J),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Vo(r,t,e={}){for(const s in t)!e[s]&&t[s]!==void 0&&(r[s]=t[s])}const Ys=new wt(null),Xs=new wt(null),qs=new wt(null,1,1),Ti=1,Uo=2,Ks=4;class Yt extends Zt{constructor(t={}){var e,s;super(),this.uid=ft("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new J,this.relativeGroupTransform=new J,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new wt(this,0,0),this._scale=qs,this._pivot=Xs,this._skew=Ys,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Vo(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(i=>this.addChild(i)),(s=t.parent)==null||s.addChild(this)}static mixin(t){X("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Pt.mixin(Yt,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||X(ct,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0],s=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),s&&(s.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,s&&s.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.removeChild(t[i]);return t[0]}const e=t[0],s=this.children.indexOf(e);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,s),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=te.get(Lo,this),this.groupTransform=J.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),te.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new J),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*to}set angle(t){this.rotation=t*eo}get pivot(){return this._pivot===Xs&&(this._pivot=new wt(this,0,0)),this._pivot}set pivot(t){this._pivot===Xs&&(this._pivot=new wt(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Ys&&(this._skew=new wt(this,0,0)),this._skew}set skew(t){this._skew===Ys&&(this._skew=new wt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===qs&&(this._scale=new wt(this,1,1)),this._scale}set scale(t){this._scale===qs&&(this._scale=new wt(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const s=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,s.width),e!==void 0&&this._setHeight(e,s.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,s=this._scale,i=this._pivot,n=this._position,a=s._x,o=s._y,h=i._x,l=i._y;e.a=this._cx*a,e.b=this._sx*a,e.c=this._cy*o,e.d=this._sy*o,e.tx=n._x-(h*e.a+l*e.c),e.ty=n._y-(h*e.b+l*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=Ti,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const s=yt.shared.setValue(t??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=Ti,this._onUpdate())}get tint(){return Ss(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Uo,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ks,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ks,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Ks,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var i;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let n=0;n<e.length;++n)e[n].destroy(t);(i=this.renderGroup)==null||i.destroy(),this.renderGroup=null}}Pt.mixin(Yt,So,Io,Do,Oo,Fo,Mo,ko,Bo,bo,wo,Ro,Ao);class Zr extends Yt{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new Bt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:s,y:i}=t;return s>=e.minX&&s<=e.maxX&&i>=e.minY&&i<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}collectRenderablesSimple(t,e,s){const{renderPipes:i,renderableGC:n}=e;i.blendMode.setBlendMode(this,this.groupBlendMode,t),i[this.renderPipeId].addRenderable(this,t),n.addRenderable(this),this.didViewUpdate=!1;const o=this.children,h=o.length;for(let l=0;l<h;l++)o[l].collectRenderables(t,e,s)}}class Pe extends Zr{constructor(t=nt.EMPTY){t instanceof nt&&(t={texture:t});const{texture:e=nt.EMPTY,anchor:s,roundPixels:i,width:n,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new wt({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=i??!1,n!==void 0&&(this.width=n),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof nt?new Pe(t):new Pe(nt.from(t,e))}set texture(t){t||(t=nt.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return lo(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return X("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,s=this._bounds,{width:i,height:n}=e.orig;s.minX=-t._x*i,s.maxX=s.minX+i,s.minY=-t._y*n,s.maxY=s.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const $o=new Bt;function On(r,t,e){const s=$o;r.measurable=!0,Mn(r,e,s),t.addBoundsMask(s),r.measurable=!1}function Bn(r,t,e){const s=ee.get();r.measurable=!0;const i=bt.get().identity(),n=Nn(r,e,i);In(r,s,n),r.measurable=!1,t.addBoundsMask(s),bt.return(i),ee.return(s)}function Nn(r,t,e){return r?(r!==t&&(Nn(r.parent,t,e),r.updateLocalTransform(),e.append(r.localTransform)),e):(Tt("Mask bounds, renderable is not inside the root container"),e)}class Dn{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Pe),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||On(this.mask,t,e)}addLocalBounds(t,e){Bn(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof Pe}}Dn.extension=rt.MaskEffect;class Gn{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}Gn.extension=rt.MaskEffect;class zn{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){On(this.mask,t,e)}addLocalBounds(t,e){Bn(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof Yt}}zn.extension=rt.MaskEffect;const Wo={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};let Mi=Wo;const Ft={get(){return Mi},set(r){Mi=r}};class Ln extends Ht{constructor(t){t.resource||(t.resource=Ft.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,s=this._resolution){const i=super.resize(t,e,s);return i&&this.resizeCanvas(),i}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Ln.extension=rt.TextureSource;class ks extends Ht{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=Ft.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,Tt("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}ks.extension=rt.TextureSource;var Tr=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Tr||{});class Js{constructor(t,e=null,s=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=s,this._once=i}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Vn=class At{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Js(null,null,1/0),this.deltaMS=1/At.targetFPMS,this.elapsedMS=1/At.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=Tr.NORMAL){return this._addListener(new Js(t,e,s))}addOnce(t,e,s=Tr.NORMAL){return this._addListener(new Js(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*At.targetFPMS;const s=this._head;let i=s.next;for(;i;)i=i.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,At.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!At._shared){const t=At._shared=new At;t.autoStart=!0,t._protected=!0}return At._shared}static get system(){if(!At._system){const t=At._system=new At;t.autoStart=!0,t._protected=!0}return At._system}};Vn.targetFPMS=.06;let ys=Vn,Qs;async function jo(){return Qs??(Qs=(async()=>{var a;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const h=document.createElement("video");h.onloadeddata=()=>o(h),h.onerror=()=>o(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(i),t.deleteTexture(s),(a=t.getExtension("WEBGL_lose_context"))==null||a.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Qs}const Ds=class Un extends Ht{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Un.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=ys.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await jo(),this._load=new Promise((s,i)=>{this.isValid?s(this):(this._resolve=s,this._reject=i,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(ys.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ys.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ys.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};Ds.extension=rt.TextureSource;Ds.defaultOptions={...Ht.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Ds.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Zo=Ds;const we=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(s=>typeof s=="string"||e?t(s):s):r);class Ho{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||Tt(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=we(t);let i;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.test(e)){i=l.getCacheableAssets(s,e);break}}const n=new Map(Object.entries(i||{}));i||s.forEach(h=>{n.set(h,e)});const a=[...n.keys()],o={cacheKeys:a,keys:s};s.forEach(h=>{this._cacheMap.set(h,o)}),a.forEach(h=>{const l=i?i[h]:e;this._cache.has(h)&&this._cache.get(h)!==l&&Tt("[Cache] already has key:",h),this._cache.set(h,n.get(h))})}remove(t){if(!this._cacheMap.has(t)){Tt(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Ce=new Ho,Mr=[];Pt.handleByList(rt.TextureSource,Mr);function $n(r={}){const t=r&&r.resource,e=t?r.resource:r,s=t?r:{resource:r};for(let i=0;i<Mr.length;i++){const n=Mr[i];if(n.test(e))return new n(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function Yo(r={},t=!1){const e=r&&r.resource,s=e?r.resource:r,i=e?r:{resource:r};if(!t&&Ce.has(s))return Ce.get(s);const n=new nt({source:$n(i)});return n.on("destroy",()=>{Ce.has(s)&&Ce.remove(s)}),t||Ce.set(s,n),n}function Xo(r,t=!1){return typeof r=="string"?Ce.get(r):r instanceof Ht?new nt({source:r}):Yo(r,t)}nt.from=Xo;Ht.from=$n;Pt.add(Dn,Gn,zn,Zo,ks,Ln,$r);var Wn=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Wn||{});function It(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Oe(r){return r.split("?")[0].split("#")[0]}function qo(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ko(r,t,e){return r.replace(new RegExp(qo(t),"g"),e)}function Jo(r,t){let e="",s=0,i=-1,n=0,a=-1;for(let o=0;o<=r.length;++o){if(o<r.length)a=r.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(i===o-1||n===1))if(i!==o-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),i=o,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,i=o,n=0;continue}}}else e.length>0?e+=`/${r.slice(i+1,o)}`:e=r.slice(i+1,o),s=o-i-1;i=o,n=0}else a===46&&n!==-1?++n:n=-1}return e}const He={toPosix(r){return Ko(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){It(r),r=this.toPosix(r);const t=/^file:\/\/\//.exec(r);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(It(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const s=Oe(this.toPosix(t??Ft.get().getBaseUrl())),i=Oe(this.toPosix(e??this.rootname(s)));return r=this.toPosix(r),r.startsWith("/")?He.join(i,r.slice(1)):this.isAbsolute(r)?r:this.join(s,r)},normalize(r){if(It(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const s=r.endsWith("/");return r=Jo(r),r.length>0&&s&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return It(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const s=r[e];if(It(s),s.length>0)if(t===void 0)t=s;else{const i=r[e-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(It(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let s=-1,i=!0;const n=this.getProtocol(r),a=r;r=r.slice(n.length);for(let o=r.length-1;o>=1;--o)if(t=r.charCodeAt(o),t===47){if(!i){s=o;break}}else i=!1;return s===-1?e?"/":this.isUrl(a)?n+r:n:e&&s===1?"//":n+r.slice(0,s)},rootname(r){It(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){It(r),t&&It(t),r=Oe(this.toPosix(r));let e=0,s=-1,i=!0,n;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let a=t.length-1,o=-1;for(n=r.length-1;n>=0;--n){const h=r.charCodeAt(n);if(h===47){if(!i){e=n+1;break}}else o===-1&&(i=!1,o=n+1),a>=0&&(h===t.charCodeAt(a)?--a===-1&&(s=n):(a=-1,s=o))}return e===s?s=o:s===-1&&(s=r.length),r.slice(e,s)}for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!i){e=n+1;break}}else s===-1&&(i=!1,s=n+1);return s===-1?"":r.slice(e,s)},extname(r){It(r),r=Oe(this.toPosix(r));let t=-1,e=0,s=-1,i=!0,n=0;for(let a=r.length-1;a>=0;--a){const o=r.charCodeAt(a);if(o===47){if(!i){e=a+1;break}continue}s===-1&&(i=!1,s=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":r.slice(t,s)},parse(r){It(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=Oe(this.toPosix(r));let e=r.charCodeAt(0);const s=this.isAbsolute(r);let i;t.root=this.rootname(r),s||this.hasProtocol(r)?i=1:i=0;let n=-1,a=0,o=-1,h=!0,l=r.length-1,c=0;for(;l>=i;--l){if(e=r.charCodeAt(l),e===47){if(!h){a=l+1;break}continue}o===-1&&(h=!1,o=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||o===-1||c===0||c===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&s?t.base=t.name=r.slice(1,o):t.base=t.name=r.slice(a,o)):(a===0&&s?(t.name=r.slice(1,n),t.base=r.slice(1,o)):(t.name=r.slice(a,n),t.base=r.slice(a,o)),t.ext=r.slice(n,o)),t.dir=this.dirname(r),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function jn(r,t,e,s,i){const n=t[e];for(let a=0;a<n.length;a++){const o=n[a];e<t.length-1?jn(r.replace(s[e],o),t,e+1,s,i):i.push(r.replace(s[e],o))}}function Qo(r){const t=/\{(.*?)\}/g,e=r.match(t),s=[];if(e){const i=[];e.forEach(n=>{const a=n.substring(1,n.length-1).split(",");i.push(a)}),jn(r,i,0,e,s)}else s.push(r);return s}const ki=r=>!Array.isArray(r);class Zn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return we(e||s,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>(a==null?void 0:a.src)??a):n!=null&&n.src?n.src:n,!0)}addManifest(t){this._manifest&&Tt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];let i=e;Array.isArray(e)||(i=Object.entries(e).map(([n,a])=>typeof a=="string"||Array.isArray(a)?{alias:n,src:a}:{alias:n,...a})),i.forEach(n=>{const a=n.src,o=n.alias;let h;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);s.push(l),h=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(t,c));s.push(...l),h=[...o,...l]}this.add({...n,alias:h,src:a})}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let s;s=n=>{this.hasKey(n)&&Tt(`[Resolver] already has key: ${n} overwriting`)},we(e).forEach(n=>{const{src:a}=n;let{data:o,format:h,loadParser:l}=n;const c=we(a).map(d=>typeof d=="string"?Qo(d):Array.isArray(d)?d:[d]),u=this.getAlias(n);Array.isArray(u)?u.forEach(s):s(u);const f=[];c.forEach(d=>{d.forEach(g=>{let x={};if(typeof g!="object"){x.src=g;for(let m=0;m<this._parsers.length;m++){const b=this._parsers[m];if(b.test(g)){x=b.parse(g);break}}}else o=g.data??o,h=g.format??h,l=g.loadParser??l,x={...x,...g};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${x.src}`);x=this._buildResolvedAsset(x,{aliases:u,data:o,format:h,loadParser:l}),f.push(x)})}),u.forEach(d=>{this._assetMap[d]=f})})}resolveBundle(t){const e=ki(t);t=we(t);const s={};return t.forEach(i=>{const n=this._bundles[i];if(n){const a=this.resolve(n),o={};for(const h in a){const l=a[h];o[this._extractAssetIdFromBundle(i,h)]=l}s[i]=o}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const i in e)s[i]=e[i].src;return s}return e.src}resolve(t){const e=ki(t);t=we(t);const s={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let n=this._assetMap[i];const a=this._getPreferredOrder(n);a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const l=n.filter(c=>c[o]?c[o]===h:!1);l.length&&(n=l)})}),this._resolverHash[i]=n[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});s[i]=this._resolverHash[i]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[e],i=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:i,loadParser:n,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=He.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...i||{},...t.data},t.loadParser=n??t.loadParser,t.format=a??t.format??th(t.src),t}}Zn.RETINA_PREFIX=/@([0-9\.]+)x/;function th(r){return r.split(".").pop().split("?").shift().split("#").shift()}const Pi=(r,t)=>{const e=t.split("?")[1];return e&&(r+=`?${e}`),r},Hn=class ze{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof nt?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const s=parseFloat(e.meta.scale);s?(this.resolution=s,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ze.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const s=ze.BATCH_SIZE;for(;e-t<s&&e<this._frameKeys.length;){const i=this._frameKeys[e],n=this._frames[i],a=n.frame;if(a){let o=null,h=null;const l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new pt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?o=new pt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new pt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new pt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new nt({source:this.textureSource,frame:o,orig:c,trim:h,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:i.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let s=0;s<t[e].length;s++){const i=t[e][s];this.animations[e].push(this.textures[i])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ze.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ze.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Hn.BATCH_SIZE=1e3;let Ii=Hn;const eh=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Yn(r,t,e){const s={};if(r.forEach(i=>{s[i]=t}),Object.keys(t.textures).forEach(i=>{s[i]=t.textures[i]}),!e){const i=He.dirname(r[0]);t.linkedSheets.forEach((n,a)=>{const o=Yn([`${i}/${t.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(s,o)})}return s}const sh={extension:rt.Asset,cache:{test:r=>r instanceof Ii,getCacheableAssets:(r,t)=>Yn(r,t,!1)},resolver:{extension:{type:rt.ResolveParser,name:"resolveSpritesheet"},test:r=>{const e=r.split("?")[0].split("."),s=e.pop(),i=e.pop();return s==="json"&&eh.includes(i)},parse:r=>{var e;const t=r.split(".");return{resolution:parseFloat(((e=Zn.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:rt.LoadParser,priority:Wn.Normal,name:"spritesheetLoader"},async testParse(r,t){return He.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){var c,u;const{texture:s,imageFilename:i,textureOptions:n}=(t==null?void 0:t.data)??{};let a=He.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let o;if(s instanceof nt)o=s;else{const f=Pi(a+(i??r.meta.image),t.src);o=(await e.load([{src:f,data:n}]))[f]}const h=new Ii(o.source,r);await h.parse();const l=(c=r==null?void 0:r.meta)==null?void 0:c.related_multi_packs;if(Array.isArray(l)){const f=[];for(const g of l){if(typeof g!="string")continue;let x=a+g;(u=t.data)!=null&&u.ignoreMultiPack||(x=Pi(x,t.src),f.push(e.load({src:x,data:{textureOptions:n,ignoreMultiPack:!0}})))}const d=await Promise.all(f);h.linkedSheets=d,d.forEach(g=>{g.linkedSheets=[h].concat(h.linkedSheets.filter(x=>x!==g))})}return h},async unload(r,t,e){await e.unload(r.textureSource._sourceOrigin),r.destroy(!1)}}};Pt.add(sh);const tr=Object.create(null),Ri=Object.create(null);function Hr(r,t){let e=Ri[r];return e===void 0&&(tr[t]===void 0&&(tr[t]=1),Ri[r]=e=tr[t]++),e}let be;function Xn(){return(!be||be!=null&&be.isContextLost())&&(be=Ft.get().createCanvas().getContext("webgl",{})),be}let xs;function rh(){if(!xs){xs="mediump";const r=Xn();r&&r.getShaderPrecisionFormat&&(xs=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision?"highp":"mediump")}return xs}function ih(r,t,e){return t?r:e?(r=r.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${r}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${r}
        `}function nh(r,t,e){const s=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(r.substring(0,9)!=="precision"){let i=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return i==="highp"&&s!=="highp"&&(i="mediump"),`precision ${i} float;
${r}`}else if(s!=="highp"&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}function ah(r,t){return t?`#version 300 es
${r}`:r}const oh={},hh={};function lh(r,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const s=e?oh:hh;return s[t]?(s[t]++,t+=`-${s[t]}`):s[t]=1,r.indexOf("#define SHADER_NAME")!==-1?r:`${`#define SHADER_NAME ${t}`}
${r}`}function ch(r,t){return t?r.replace("#version 300 es",""):r}const er={stripVersion:ch,ensurePrecision:nh,addProgramDefines:ih,setProgramName:lh,insertVersion:ah},sr=Object.create(null),qn=class kr{constructor(t){t={...kr.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:rh()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let i=t.fragment,n=t.vertex;Object.keys(er).forEach(a=>{const o=s[a];i=er[a](i,o,!0),n=er[a](n,o,!1)}),this.fragment=i,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Hr(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return sr[e]||(sr[e]=new kr(t)),sr[e]}};qn.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let us=qn;const Ei={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function uh(r){return Ei[r]??Ei.float32}const dh={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function fh({source:r,entryPoint:t}){const e={},s=r.indexOf(`fn ${t}`);if(s!==-1){const i=r.indexOf("->",s);if(i!==-1){const n=r.substring(s,i),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(n))!==null;){const h=dh[o[3]]??"float32";e[o[2]]={location:parseInt(o[1],10),format:h,stride:uh(h).stride,offset:0,instance:!1,start:0}}}}return e}function rr(r){var u,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=r.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(s)[1],10),name:d.match(i)[2],isUniform:d.match(i)[1]==="<uniform>",type:d.match(n)[1]}));if(!l)return{groups:[],structs:[]};const c=((f=r.match(a))==null?void 0:f.map(d=>{const g=d.match(h)[1],x=d.match(o).reduce((m,b)=>{const[v,w]=b.split(":");return m[v.trim()]=w.trim(),m},{});return x?{name:g,members:x}:null}).filter(({name:d})=>l.some(g=>g.type===d)))??[];return{groups:l,structs:c}}var Le=(r=>(r[r.VERTEX=1]="VERTEX",r[r.FRAGMENT=2]="FRAGMENT",r[r.COMPUTE=4]="COMPUTE",r))(Le||{});function ph({groups:r}){const t=[];for(let e=0;e<r.length;e++){const s=r[e];t[s.group]||(t[s.group]=[]),s.isUniform?t[s.group].push({binding:s.binding,visibility:Le.VERTEX|Le.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?t[s.group].push({binding:s.binding,visibility:Le.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&t[s.group].push({binding:s.binding,visibility:Le.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function mh({groups:r}){const t=[];for(let e=0;e<r.length;e++){const s=r[e];t[s.group]||(t[s.group]={}),t[s.group][s.name]=s.binding}return t}function gh(r,t){const e=new Set,s=new Set,i=[...r.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),n=[...r.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return s.has(o)?!1:(s.add(o),!0)});return{structs:i,groups:n}}const ir=Object.create(null);class _e{constructor(t){var o,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:s,layout:i,gpuLayout:n,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=s,e.source===s.source){const l=rr(e.source);this.structsAndGroups=l}else{const l=rr(s.source),c=rr(e.source);this.structsAndGroups=gh(l,c)}this.layout=i??mh(this.structsAndGroups),this.gpuLayout=n??ph(this.structsAndGroups),this.autoAssignGlobalUniforms=((o=this.layout[0])==null?void 0:o.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,s=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Hr(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=fh(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return ir[e]||(ir[e]=new _e(t)),ir[e]}}const Kn=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],yh=Kn.reduce((r,t)=>(r[t]=!0,r),{});function xh(r,t){switch(r){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Jn=class Qn{constructor(t,e){this._touched=0,this.uid=ft("uniform"),this._resourceType="uniformGroup",this._resourceId=ft("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Qn.defaultOptions,...e},this.uniformStructures=t;const s={};for(const i in t){const n=t[i];if(n.name=i,n.size=n.size??1,!yh[n.type])throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${Kn.join(", ")}`);n.value??(n.value=xh(n.type,n.size)),s[i]=n.value}this.uniforms=s,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Hr(Object.keys(s).map(i=>`${i}-${t[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Jn.defaultOptions={ubo:!1,isStatic:!1};let Yr=Jn;class As{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const s in t){const i=t[s];this.setResource(i,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const s in this.resources)t[e++]=this.resources[s]._resourceId;this._key=t.join("|")}setResource(t,e){var i,n;const s=this.resources[e];t!==s&&(s&&((i=t.off)==null||i.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const s in e)e[s]._touched=t}destroy(){var e;const t=this.resources;for(const s in t){const i=t[s];(e=i.off)==null||e.call(i,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const s in e)e[s]===t&&(e[s]=null)}else this._updateKey()}}var Ye=(r=>(r[r.WEBGL=1]="WEBGL",r[r.WEBGPU=2]="WEBGPU",r[r.BOTH=3]="BOTH",r))(Ye||{});class Gs extends Zt{constructor(t){super(),this.uid=ft("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:s,groups:i,resources:n,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=s,a===void 0&&(a=0,e&&(a|=Ye.WEBGPU),s&&(a|=Ye.WEBGL)),this.compatibleRenderers=a;const h={};if(!n&&!i&&(n={}),n&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&i&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&i&&o)for(const l in o)for(const c in o[l]){const u=o[l][c];h[u]={group:l,binding:c,name:u}}else if(e&&i&&!o){const l=e.structsAndGroups.groups;o={},l.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,h[c.name]=c})}else if(n){i={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,h[u.name]=u});let l=0;for(const c in n)h[c]||(i[99]||(i[99]=new As,this._ownedBindGroups.push(i[99])),h[c]={group:99,binding:l,name:c},o[99]=o[99]||{},o[99][l]=c,l++);for(const c in n){const u=c;let f=n[c];!f.source&&!f._resourceType&&(f=new Yr(f));const d=h[u];d&&(i[d.group]||(i[d.group]=new As,this._ownedBindGroups.push(i[d.group])),i[d.group].setResource(f,d.binding))}}this.groups=i,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(i,h)}addResource(t,e,s){var i,n;(i=this._uniformBindMap)[e]||(i[e]={}),(n=this._uniformBindMap[e])[s]||(n[s]=t),this.groups[e]||(this.groups[e]=new As,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const s={};for(const i in e){const n=e[i];Object.defineProperty(s,n.name,{get(){return t[n.group].getResource(n.binding)},set(a){t[n.group].setResource(a,n.binding)}})}return s}destroy(t=!1){var e,s;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(s=this.glProgram)==null||s.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(i=>{i.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:s,...i}=t;let n,a;return e&&(n=_e.from(e)),s&&(a=us.from(s)),new Gs({gpuProgram:n,glProgram:a,...i})}}const _h={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},nr=0,ar=1,or=2,hr=3,lr=4,cr=5,Pr=class ta{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<nr)}set blend(t){!!(this.data&1<<nr)!==t&&(this.data^=1<<nr)}get offsets(){return!!(this.data&1<<ar)}set offsets(t){!!(this.data&1<<ar)!==t&&(this.data^=1<<ar)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<or)}set culling(t){!!(this.data&1<<or)!==t&&(this.data^=1<<or)}get depthTest(){return!!(this.data&1<<hr)}set depthTest(t){!!(this.data&1<<hr)!==t&&(this.data^=1<<hr)}get depthMask(){return!!(this.data&1<<cr)}set depthMask(t){!!(this.data&1<<cr)!==t&&(this.data^=1<<cr)}get clockwiseFrontFace(){return!!(this.data&1<<lr)}set clockwiseFrontFace(t){!!(this.data&1<<lr)!==t&&(this.data^=1<<lr)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=_h[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new ta;return t.depthTest=!1,t.blend=!0,t}};Pr.default2d=Pr.for2d();let bh=Pr;const ea=class Ir extends Gs{constructor(t){t={...Ir.defaultOptions,...t},super(t),this.enabled=!0,this._state=bh.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,s,i){t.applyFilter(this,e,s,i)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:s,...i}=t;let n,a;return e&&(n=_e.from(e)),s&&(a=us.from(s)),new Ir({gpuProgram:n,glProgram:a,...i})}};ea.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Xr=ea;const Rr=[];Pt.handleByNamedList(rt.Environment,Rr);async function vh(r){if(!r)for(let t=0;t<Rr.length;t++){const e=Rr[t];if(e.value.test()){await e.value.load();return}}}let Be;function wh(){if(typeof Be=="boolean")return Be;try{Be=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Be=!1}return Be}var _s={exports:{}},Fi;function Ch(){if(Fi)return _s.exports;Fi=1,_s.exports=r,_s.exports.default=r;function r(p,y,_){_=_||2;var C=y&&y.length,S=C?y[0]*_:p.length,T=t(p,0,S,_,!0),M=[];if(!T||T.next===T.prev)return M;var E,U,z,et,st,K,dt;if(C&&(T=h(p,y,T,_)),p.length>80*_){E=z=p[0],U=et=p[1];for(var tt=_;tt<S;tt+=_)st=p[tt],K=p[tt+1],st<E&&(E=st),K<U&&(U=K),st>z&&(z=st),K>et&&(et=K);dt=Math.max(z-E,et-U),dt=dt!==0?32767/dt:0}return s(T,M,_,E,U,dt,0),M}function t(p,y,_,C,S){var T,M;if(S===Xt(p,y,_,C)>0)for(T=y;T<_;T+=C)M=at(T,p[T],p[T+1],M);else for(T=_-C;T>=y;T-=C)M=at(T,p[T],p[T+1],M);return M&&A(M,M.next)&&(it(M),M=M.next),M}function e(p,y){if(!p)return p;y||(y=p);var _=p,C;do if(C=!1,!_.steiner&&(A(_,_.next)||w(_.prev,_,_.next)===0)){if(it(_),_=y=_.prev,_===_.next)break;C=!0}else _=_.next;while(C||_!==y);return y}function s(p,y,_,C,S,T,M){if(p){!M&&T&&d(p,C,S,T);for(var E=p,U,z;p.prev!==p.next;){if(U=p.prev,z=p.next,T?n(p,C,S,T):i(p)){y.push(U.i/_|0),y.push(p.i/_|0),y.push(z.i/_|0),it(p),p=z.next,E=z.next;continue}if(p=z,p===E){M?M===1?(p=a(e(p),y,_),s(p,y,_,C,S,T,2)):M===2&&o(p,y,_,C,S,T):s(e(p),y,_,C,S,T,1);break}}}}function i(p){var y=p.prev,_=p,C=p.next;if(w(y,_,C)>=0)return!1;for(var S=y.x,T=_.x,M=C.x,E=y.y,U=_.y,z=C.y,et=S<T?S<M?S:M:T<M?T:M,st=E<U?E<z?E:z:U<z?U:z,K=S>T?S>M?S:M:T>M?T:M,dt=E>U?E>z?E:z:U>z?U:z,tt=C.next;tt!==y;){if(tt.x>=et&&tt.x<=K&&tt.y>=st&&tt.y<=dt&&b(S,E,T,U,M,z,tt.x,tt.y)&&w(tt.prev,tt,tt.next)>=0)return!1;tt=tt.next}return!0}function n(p,y,_,C){var S=p.prev,T=p,M=p.next;if(w(S,T,M)>=0)return!1;for(var E=S.x,U=T.x,z=M.x,et=S.y,st=T.y,K=M.y,dt=E<U?E<z?E:z:U<z?U:z,tt=et<st?et<K?et:K:st<K?st:K,qt=E>U?E>z?E:z:U>z?U:z,St=et>st?et>K?et:K:st>K?st:K,Gt=x(dt,tt,y,_,C),zt=x(qt,St,y,_,C),Y=p.prevZ,Q=p.nextZ;Y&&Y.z>=Gt&&Q&&Q.z<=zt;){if(Y.x>=dt&&Y.x<=qt&&Y.y>=tt&&Y.y<=St&&Y!==S&&Y!==M&&b(E,et,U,st,z,K,Y.x,Y.y)&&w(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,Q.x>=dt&&Q.x<=qt&&Q.y>=tt&&Q.y<=St&&Q!==S&&Q!==M&&b(E,et,U,st,z,K,Q.x,Q.y)&&w(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;Y&&Y.z>=Gt;){if(Y.x>=dt&&Y.x<=qt&&Y.y>=tt&&Y.y<=St&&Y!==S&&Y!==M&&b(E,et,U,st,z,K,Y.x,Y.y)&&w(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;Q&&Q.z<=zt;){if(Q.x>=dt&&Q.x<=qt&&Q.y>=tt&&Q.y<=St&&Q!==S&&Q!==M&&b(E,et,U,st,z,K,Q.x,Q.y)&&w(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function a(p,y,_){var C=p;do{var S=C.prev,T=C.next.next;!A(S,T)&&R(S,C,C.next,T)&&W(S,T)&&W(T,S)&&(y.push(S.i/_|0),y.push(C.i/_|0),y.push(T.i/_|0),it(C),it(C.next),C=p=T),C=C.next}while(C!==p);return e(C)}function o(p,y,_,C,S,T){var M=p;do{for(var E=M.next.next;E!==M.prev;){if(M.i!==E.i&&v(M,E)){var U=D(M,E);M=e(M,M.next),U=e(U,U.next),s(M,y,_,C,S,T,0),s(U,y,_,C,S,T,0);return}E=E.next}M=M.next}while(M!==p)}function h(p,y,_,C){var S=[],T,M,E,U,z;for(T=0,M=y.length;T<M;T++)E=y[T]*C,U=T<M-1?y[T+1]*C:p.length,z=t(p,E,U,C,!1),z===z.next&&(z.steiner=!0),S.push(m(z));for(S.sort(l),T=0;T<S.length;T++)_=c(S[T],_);return _}function l(p,y){return p.x-y.x}function c(p,y){var _=u(p,y);if(!_)return y;var C=D(_,p);return e(C,C.next),e(_,_.next)}function u(p,y){var _=y,C=p.x,S=p.y,T=-1/0,M;do{if(S<=_.y&&S>=_.next.y&&_.next.y!==_.y){var E=_.x+(S-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(E<=C&&E>T&&(T=E,M=_.x<_.next.x?_:_.next,E===C))return M}_=_.next}while(_!==y);if(!M)return null;var U=M,z=M.x,et=M.y,st=1/0,K;_=M;do C>=_.x&&_.x>=z&&C!==_.x&&b(S<et?C:T,S,z,et,S<et?T:C,S,_.x,_.y)&&(K=Math.abs(S-_.y)/(C-_.x),W(_,p)&&(K<st||K===st&&(_.x>M.x||_.x===M.x&&f(M,_)))&&(M=_,st=K)),_=_.next;while(_!==U);return M}function f(p,y){return w(p.prev,p,y.prev)<0&&w(y.next,p,p.next)<0}function d(p,y,_,C){var S=p;do S.z===0&&(S.z=x(S.x,S.y,y,_,C)),S.prevZ=S.prev,S.nextZ=S.next,S=S.next;while(S!==p);S.prevZ.nextZ=null,S.prevZ=null,g(S)}function g(p){var y,_,C,S,T,M,E,U,z=1;do{for(_=p,p=null,T=null,M=0;_;){for(M++,C=_,E=0,y=0;y<z&&(E++,C=C.nextZ,!!C);y++);for(U=z;E>0||U>0&&C;)E!==0&&(U===0||!C||_.z<=C.z)?(S=_,_=_.nextZ,E--):(S=C,C=C.nextZ,U--),T?T.nextZ=S:p=S,S.prevZ=T,T=S;_=C}T.nextZ=null,z*=2}while(M>1);return p}function x(p,y,_,C,S){return p=(p-_)*S|0,y=(y-C)*S|0,p=(p|p<<8)&16711935,p=(p|p<<4)&252645135,p=(p|p<<2)&858993459,p=(p|p<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,p|y<<1}function m(p){var y=p,_=p;do(y.x<_.x||y.x===_.x&&y.y<_.y)&&(_=y),y=y.next;while(y!==p);return _}function b(p,y,_,C,S,T,M,E){return(S-M)*(y-E)>=(p-M)*(T-E)&&(p-M)*(C-E)>=(_-M)*(y-E)&&(_-M)*(T-E)>=(S-M)*(C-E)}function v(p,y){return p.next.i!==y.i&&p.prev.i!==y.i&&!Z(p,y)&&(W(p,y)&&W(y,p)&&B(p,y)&&(w(p.prev,p,y.prev)||w(p,y.prev,y))||A(p,y)&&w(p.prev,p,p.next)>0&&w(y.prev,y,y.next)>0)}function w(p,y,_){return(y.y-p.y)*(_.x-y.x)-(y.x-p.x)*(_.y-y.y)}function A(p,y){return p.x===y.x&&p.y===y.y}function R(p,y,_,C){var S=P(w(p,y,_)),T=P(w(p,y,C)),M=P(w(_,C,p)),E=P(w(_,C,y));return!!(S!==T&&M!==E||S===0&&k(p,_,y)||T===0&&k(p,C,y)||M===0&&k(_,p,C)||E===0&&k(_,y,C))}function k(p,y,_){return y.x<=Math.max(p.x,_.x)&&y.x>=Math.min(p.x,_.x)&&y.y<=Math.max(p.y,_.y)&&y.y>=Math.min(p.y,_.y)}function P(p){return p>0?1:p<0?-1:0}function Z(p,y){var _=p;do{if(_.i!==p.i&&_.next.i!==p.i&&_.i!==y.i&&_.next.i!==y.i&&R(_,_.next,p,y))return!0;_=_.next}while(_!==p);return!1}function W(p,y){return w(p.prev,p,p.next)<0?w(p,y,p.next)>=0&&w(p,p.prev,y)>=0:w(p,y,p.prev)<0||w(p,p.next,y)<0}function B(p,y){var _=p,C=!1,S=(p.x+y.x)/2,T=(p.y+y.y)/2;do _.y>T!=_.next.y>T&&_.next.y!==_.y&&S<(_.next.x-_.x)*(T-_.y)/(_.next.y-_.y)+_.x&&(C=!C),_=_.next;while(_!==p);return C}function D(p,y){var _=new mt(p.i,p.x,p.y),C=new mt(y.i,y.x,y.y),S=p.next,T=y.prev;return p.next=y,y.prev=p,_.next=S,S.prev=_,C.next=_,_.prev=C,T.next=C,C.prev=T,C}function at(p,y,_,C){var S=new mt(p,y,_);return C?(S.next=C.next,S.prev=C,C.next.prev=S,C.next=S):(S.prev=S,S.next=S),S}function it(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function mt(p,y,_){this.i=p,this.x=y,this.y=_,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(p,y,_,C){var S=y&&y.length,T=S?y[0]*_:p.length,M=Math.abs(Xt(p,0,T,_));if(S)for(var E=0,U=y.length;E<U;E++){var z=y[E]*_,et=E<U-1?y[E+1]*_:p.length;M-=Math.abs(Xt(p,z,et,_))}var st=0;for(E=0;E<C.length;E+=3){var K=C[E]*_,dt=C[E+1]*_,tt=C[E+2]*_;st+=Math.abs((p[K]-p[tt])*(p[dt+1]-p[K+1])-(p[K]-p[dt])*(p[tt+1]-p[K+1]))}return M===0&&st===0?0:Math.abs((st-M)/M)};function Xt(p,y,_,C){for(var S=0,T=y,M=_-C;T<_;T+=C)S+=(p[M]-p[T])*(p[T+1]+p[M+1]),M=T;return S}return r.flatten=function(p){for(var y=p[0][0].length,_={vertices:[],holes:[],dimensions:y},C=0,S=0;S<p.length;S++){for(var T=0;T<p[S].length;T++)for(var M=0;M<y;M++)_.vertices.push(p[S][T][M]);S>0&&(C+=p[S-1].length,_.holes.push(C))}return _},_s.exports}var Sh=Ch();const Ah=Ur(Sh);var sa=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(sa||{});class Th{constructor(t){this.items=[],this._name=t}emit(t,e,s,i,n,a,o,h){const{name:l,items:c}=this;for(let u=0,f=c.length;u<f;u++)c[u][l](t,e,s,i,n,a,o,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Mh=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],ra=class ia extends Zt{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Mh,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await vh(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)t={...this._systemsHash[s].constructor.defaultOptions,...t};t={...ia.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(t);this._initOptions=t}render(t,e){let s=t;if(s instanceof Yt&&(s={container:s},e&&(X(ct,"passing a second argument is deprecated, please use render options instead"),s.target=e.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor??(s.clearColor=this.background.colorRgba),s.clear??(s.clear=this.background.clearBeforeRender)),s.clearColor){const i=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=i?s.clearColor:yt.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),s.container.enableRenderGroup(),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s)}resize(t,e,s){const i=this.view.resolution;this.view.resize(t,e,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==i&&this.runners.resolutionChange.emit(s)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=sa.ALL);const{clear:s,clearColor:i,target:n}=t;yt.shared.setValue(i??this.background.colorRgba),e.renderTarget.clear(n,s,yt.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Th(e)})}_addSystems(t){let e;for(e in t){const s=t[e];this._addSystem(s.value,s.name)}}_addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const i in this.runners)this.runners[i].add(s);return this}_addPipes(t,e){const s=e.reduce((i,n)=>(i[n.name]=n.value,i),{});t.forEach(i=>{const n=i.value,a=i.name,o=s[a];this.renderPipes[a]=new n(this,o?new o:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!wh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};ra.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let na=ra,bs;function kh(r){return bs!==void 0||(bs=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:r??na.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ft.get().getWebGLRenderingContext())return!1;let i=Ft.get().createCanvas().getContext("webgl",t);const n=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const a=i.getExtension("WEBGL_lose_context");a&&a.loseContext()}return i=null,n}catch{return!1}})()),bs}let vs;async function Ph(r={}){return vs!==void 0||(vs=await(async()=>{const t=Ft.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),vs}const Oi=["webgl","webgpu","canvas"];async function Ih(r){let t=[];r.preference?(t.push(r.preference),Oi.forEach(n=>{n!==r.preference&&t.push(n)})):t=Oi.slice();let e,s={};for(let n=0;n<t.length;n++){const a=t[n];if(a==="webgpu"&&await Ph()){const{WebGPURenderer:o}=await Ms(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-C8iqI4mb.js");return{WebGPURenderer:h}},__vite__mapDeps([4,2,5,3]));e=o,s={...r,...r.webgpu};break}else if(a==="webgl"&&kh(r.failIfMajorPerformanceCaveat??na.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await Ms(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-yThigZ1g.js");return{WebGLRenderer:h}},__vite__mapDeps([6,2,5]));e=o,s={...r,...r.webgl};break}else if(a==="canvas")throw s={...r},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!e)throw new Error("No available renderer for the current environment");const i=new e;return await i.init(s),i}const aa="8.8.0";class oa{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,aa)}static destroy(){}}oa.extension=rt.Application;class Rh{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,aa)}destroy(){this._renderer=null}}Rh.extension={type:[rt.WebGLSystem,rt.WebGPUSystem],name:"initHook",priority:-10};const ha=class Er{constructor(...t){this.stage=new Yt,t[0]!==void 0&&X(ct,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Ih(t),Er._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return X(ct,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const s=Er._plugins.slice(0);s.reverse(),s.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};ha._plugins=[];let la=ha;Pt.handleByList(rt.Application,la._plugins);Pt.add(oa);const Bi=[{offset:0,color:"white"},{offset:1,color:"black"}],qr=class Fr{constructor(...t){this.uid=ft("fillGradient"),this.type="linear",this.colorStops=[];let e=Eh(t);e={...e.type==="radial"?Fr.defaultRadialOptions:Fr.defaultLinearOptions,..._n(e)},this._textureSize=e.textureSize,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:yt.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Bi,e=this._textureSize,{canvas:s,context:i}=Di(e,1),n=i.createLinearGradient(0,0,this._textureSize,0);Ni(n,t),i.fillStyle=n,i.fillRect(0,0,e,1),this.texture=new nt({source:new ks({resource:s})});const{x:a,y:o}=this.start,{x:h,y:l}=this.end,c=new J,u=h-a,f=l-o,d=Math.sqrt(u*u+f*f),g=Math.atan2(f,u);c.scale(d/e,1),c.rotate(g),c.translate(a,o),this.textureSpace==="local"&&c.scale(e,e),this.transform=c}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Bi,e=this._textureSize,{canvas:s,context:i}=Di(e,e),{x:n,y:a}=this.center,{x:o,y:h}=this.outerCenter,l=this.innerRadius,c=this.outerRadius,u=o-c,f=h-c,d=e/(c*2),g=(n-u)*d,x=(a-f)*d,m=i.createRadialGradient(g,x,l*d,(o-u)*d,(h-f)*d,c*d);Ni(m,t),i.fillStyle=t[t.length-1].color,i.fillRect(0,0,e,e),i.fillStyle=m,i.translate(g,x),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-g,-x),i.fillRect(0,0,e,e),this.texture=new nt({source:new ks({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const b=new J;b.scale(1/d,1/d),b.translate(u,f),this.textureSpace==="local"&&b.scale(e,e),this.transform=b}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};qr.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};qr.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let ie=qr;function Ni(r,t){for(let e=0;e<t.length;e++){const s=t[e];r.addColorStop(s.offset,s.color)}}function Di(r,t){const e=Ft.get().createCanvas(r,t),s=e.getContext("2d");return{canvas:e,context:s}}function Eh(r){let t=r[0]??{};return(typeof t=="number"||r[1])&&(X("8.5.2","use options object instead"),t={type:"linear",start:{x:r[0],y:r[1]},end:{x:r[2],y:r[3]},textureSpace:r[4],textureSize:r[5]??ie.defaultLinearOptions.textureSize}),t}const Gi={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Kr{constructor(t,e){this.uid=ft("fillPattern"),this.transform=new J,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Gi[e].addressModeU,t.source.style.addressModeV=Gi[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var ur,zi;function Fh(){if(zi)return ur;zi=1,ur=e;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var a=[];return n.replace(t,function(o,h,l){var c=h.toLowerCase();for(l=i(l),c=="m"&&l.length>2&&(a.push([h].concat(l.splice(0,2))),c="l",h=h=="m"?"l":"L");;){if(l.length==r[c])return l.unshift(h),a.push(l);if(l.length<r[c])throw new Error("malformed path data");a.push([h].concat(l.splice(0,r[c])))}}),a}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function i(n){var a=n.match(s);return a?a.map(Number):[]}return ur}var Oh=Fh();const Bh=Ur(Oh);function Nh(r,t){const e=Bh(r),s=[];let i=null,n=0,a=0;for(let o=0;o<e.length;o++){const h=e[o],l=h[0],c=h;switch(l){case"M":n=c[1],a=c[2],t.moveTo(n,a);break;case"m":n+=c[1],a+=c[2],t.moveTo(n,a);break;case"H":n=c[1],t.lineTo(n,a);break;case"h":n+=c[1],t.lineTo(n,a);break;case"V":a=c[1],t.lineTo(n,a);break;case"v":a+=c[1],t.lineTo(n,a);break;case"L":n=c[1],a=c[2],t.lineTo(n,a);break;case"l":n+=c[1],a+=c[2],t.lineTo(n,a);break;case"C":n=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],n,a);break;case"c":t.bezierCurveTo(n+c[1],a+c[2],n+c[3],a+c[4],n+c[5],a+c[6]),n+=c[5],a+=c[6];break;case"S":n=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],n,a);break;case"s":t.bezierCurveToShort(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"Q":n=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],n,a);break;case"q":t.quadraticCurveTo(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"T":n=c[1],a=c[2],t.quadraticCurveToShort(n,a);break;case"t":n+=c[1],a+=c[2],t.quadraticCurveToShort(n,a);break;case"A":n=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"a":n+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"Z":case"z":t.closePath(),s.length>0&&(i=s.pop(),i?(n=i.startX,a=i.startY):(n=0,a=0)),i=null;break;default:Tt(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&i===null&&(i={startX:n,startY:a},s.push(i))}return t}class Jr{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new Jr(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let i=this.x-t,n=this.y-e;return i*=i,n*=n,i+n<=s}strokeContains(t,e,s,i=.5){if(this.radius===0)return!1;const n=this.x-t,a=this.y-e,o=this.radius,h=(1-i)*s,l=Math.sqrt(n*n+a*a);return l<=o+h&&l>o-(s-h)}getBounds(t){return t||(t=new pt),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Qr{constructor(t=0,e=0,s=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=i}clone(){return new Qr(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return s*=s,i*=i,s+i<=1}strokeContains(t,e,s,i=.5){const{halfWidth:n,halfHeight:a}=this;if(n<=0||a<=0)return!1;const o=s*(1-i),h=s-o,l=n-h,c=a-h,u=n+o,f=a+o,d=t-this.x,g=e-this.y,x=d*d/(l*l)+g*g/(c*c),m=d*d/(u*u)+g*g/(f*f);return x>1&&m<=1}getBounds(t){return t||(t=new pt),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Dh(r,t,e,s,i,n){const a=r-e,o=t-s,h=i-e,l=n-s,c=a*h+o*l,u=h*h+l*l;let f=-1;u!==0&&(f=c/u);let d,g;f<0?(d=e,g=s):f>1?(d=i,g=n):(d=e+f*h,g=s+f*l);const x=r-d,m=t-g;return x*x+m*m}let Gh,zh;class We{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let i=0,n=e.length;i<n;i++)s.push(e[i].x,e[i].y);e=s}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let i=0;i<s;i+=2){const n=e[i],a=e[i+1],o=e[(i+2)%s],h=e[(i+3)%s];t+=(o-n)*(h+a)}return t<0}containsPolygon(t){const e=this.getBounds(Gh),s=t.getBounds(zh);if(!e.containsRect(s))return!1;const i=t.points;for(let n=0;n<i.length;n+=2){const a=i[n],o=i[n+1];if(!this.contains(a,o))return!1}return!0}clone(){const t=this.points.slice(),e=new We(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const i=this.points.length/2;for(let n=0,a=i-1;n<i;a=n++){const o=this.points[n*2],h=this.points[n*2+1],l=this.points[a*2],c=this.points[a*2+1];h>e!=c>e&&t<(l-o)*((e-h)/(c-h))+o&&(s=!s)}return s}strokeContains(t,e,s,i=.5){const n=s*s,a=n*(1-i),o=n-a,{points:h}=this,l=h.length-(this.closePath?0:2);for(let c=0;c<l;c+=2){const u=h[c],f=h[c+1],d=h[(c+2)%h.length],g=h[(c+3)%h.length],x=Dh(t,e,u,f,d,g),m=Math.sign((d-u)*(e-f)-(g-f)*(t-u));if(x<=(m<0?o:a))return!0}return!1}getBounds(t){t||(t=new pt);const e=this.points;let s=1/0,i=-1/0,n=1/0,a=-1/0;for(let o=0,h=e.length;o<h;o+=2){const l=e[o],c=e[o+1];s=l<s?l:s,i=l>i?l:i,n=c<n?c:n,a=c>a?c:a}return t.x=s,t.width=i-s,t.y=n,t.height=a-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const ws=(r,t,e,s,i,n,a)=>{const o=r-e,h=t-s,l=Math.sqrt(o*o+h*h);return l>=i-n&&l<=i+a};class ti{constructor(t=0,e=0,s=0,i=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=i,this.radius=n}getBounds(t){return t||(t=new pt),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new ti(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let i=t-(this.x+s),n=e-(this.y+s);const a=s*s;if(i*i+n*n<=a||(i=t-(this.x+this.width-s),i*i+n*n<=a)||(n=e-(this.y+this.height-s),i*i+n*n<=a)||(i=t-(this.x+s),i*i+n*n<=a))return!0}return!1}strokeContains(t,e,s,i=.5){const{x:n,y:a,width:o,height:h,radius:l}=this,c=s*(1-i),u=s-c,f=n+l,d=a+l,g=o-l*2,x=h-l*2,m=n+o,b=a+h;return(t>=n-c&&t<=n+u||t>=m-u&&t<=m+c)&&e>=d&&e<=d+x||(e>=a-c&&e<=a+u||e>=b-u&&e<=b+c)&&t>=f&&t<=f+g?!0:t<f&&e<d&&ws(t,e,f,d,l,u,c)||t>m-l&&e<d&&ws(t,e,m-l,d,l,u,c)||t>m-l&&e>b-l&&ws(t,e,m-l,b-l,l,u,c)||t<f&&e>b-l&&ws(t,e,f,b-l,l,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Lh=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Vh(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function Uh(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const s=Lh.replace(/%forloop%/gi,Vh(r));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}}finally{t.deleteShader(e)}return r}let ve=null;function ca(){var t;if(ve)return ve;const r=Xn();return ve=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),ve=Uh(ve,r),(t=r.getExtension("WEBGL_lose_context"))==null||t.loseContext(),ve}const ua={};function $h(r,t){let e=2166136261;for(let s=0;s<t;s++)e^=r[s].uid,e=Math.imul(e,16777619),e>>>=0;return ua[e]||Wh(r,t,e)}let dr=0;function Wh(r,t,e){const s={};let i=0;dr||(dr=ca());for(let a=0;a<dr;a++){const o=a<t?r[a]:nt.EMPTY.source;s[i++]=o.source,s[i++]=o.style}const n=new As(s);return ua[e]=n,n}class Li{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Vi(r,t){const e=r.byteLength/8|0,s=new Float64Array(r,0,e);new Float64Array(t,0,e).set(s);const n=r.byteLength-e*8;if(n>0){const a=new Uint8Array(r,e*8,n);new Uint8Array(t,e*8,n).set(a)}}const jh={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Zh=(r=>(r[r.DISABLED=0]="DISABLED",r[r.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",r[r.MASK_ACTIVE=2]="MASK_ACTIVE",r[r.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",r[r.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",r[r.NONE=5]="NONE",r))(Zh||{});function Ui(r,t){return t.alphaMode==="no-premultiply-alpha"&&jh[r]||r}class Hh{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class Yh{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Hh,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const da=[];let Or=0;function $i(){return Or>0?da[--Or]:new Yh}function Wi(r){da[Or++]=r}let Ne=0;const fa=class Ts{constructor(t={}){this.uid=ft("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Ts.defaultOptions.maxTextures=Ts.defaultOptions.maxTextures??ca(),t={...Ts.defaultOptions,...t};const{maxTextures:e,attributesInitialSize:s,indicesInitialSize:i}=t;this.attributeBuffer=new Li(s*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Wi(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const s=t._batch.textures.ids[e._source.uid];return!s&&s!==0?!1:(t._textureId=s,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let s=$i(),i=s.textures;i.clear();const n=e[this.elementStart];let a=Ui(n.blendMode,n.texture._source),o=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch";const g=this.maxTextures;for(let x=this.elementStart;x<this.elementSize;++x){const m=e[x];e[x]=null;const v=m.texture._source,w=Ui(m.blendMode,v),A=a!==w||o!==m.topology;if(v._batchTick===Ne&&!A){m._textureId=v._textureBindLocation,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,l,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,l,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=s;continue}v._batchTick=Ne,(i.count>=g||A)&&(this._finishBatch(s,f,u-f,i,a,o,t,d),d="renderBatch",f=u,a=w,o=m.topology,s=$i(),i=s.textures,i.clear(),++Ne),m._textureId=v._textureBindLocation=i.count,i.ids[v.uid]=i.count,i.textures[i.count++]=v,m._batch=s,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,l,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,l,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(s,f,u-f,i,a,o,t,d),f=u,++Ne),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,e,s,i,n,a,o,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=i,t.blendMode=n,t.topology=a,t.start=e,t.size=s,++Ne,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),s=new Li(e);Vi(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(t){const e=this.indexBuffer;let s=Math.max(t,e.length*1.5);s+=s%2;const i=s>65535?new Uint32Array(s):new Uint16Array(s);if(i.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)i[n]=e[n];else Vi(e.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(t,e,s){t[e]=s+0,t[e+1]=s+1,t[e+2]=s+2,t[e+3]=s+0,t[e+4]=s+2,t[e+5]=s+3}packIndex(t,e,s,i){const n=t.indices,a=t.indexSize,o=t.indexOffset,h=t.attributeOffset;for(let l=0;l<a;l++)e[s++]=i+n[l+o]-h}destroy(){for(let t=0;t<this.batches.length;t++)Wi(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};fa.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Xh=fa;var Ct=(r=>(r[r.MAP_READ=1]="MAP_READ",r[r.MAP_WRITE=2]="MAP_WRITE",r[r.COPY_SRC=4]="COPY_SRC",r[r.COPY_DST=8]="COPY_DST",r[r.INDEX=16]="INDEX",r[r.VERTEX=32]="VERTEX",r[r.UNIFORM=64]="UNIFORM",r[r.STORAGE=128]="STORAGE",r[r.INDIRECT=256]="INDIRECT",r[r.QUERY_RESOLVE=512]="QUERY_RESOLVE",r[r.STATIC=1024]="STATIC",r))(Ct||{});class Xe extends Zt{constructor(t){let{data:e,size:s}=t;const{usage:i,label:n,shrinkToFit:a}=t;super(),this.uid=ft("buffer"),this._resourceType="buffer",this._resourceId=ft("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,s??(s=e==null?void 0:e.byteLength);const o=!!e;this.descriptor={size:s,usage:i,mappedAtCreation:o,label:n},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Ct.STATIC)}set static(t){t?this.descriptor.usage|=Ct.STATIC:this.descriptor.usage&=~Ct.STATIC}setDataWithSize(t,e,s){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){s&&this.emit("update",this);return}const i=this._data;if(this._data=t,this._dataInt32=null,!i||i.length!==t.length){!this.shrinkToFit&&i&&t.byteLength<i.byteLength?s&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=ft("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function pa(r,t){if(!(r instanceof Xe)){let e=t?Ct.INDEX:Ct.VERTEX;r instanceof Array&&(t?(r=new Uint32Array(r),e=Ct.INDEX|Ct.COPY_DST):(r=new Float32Array(r),e=Ct.VERTEX|Ct.COPY_DST)),r=new Xe({data:r,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return r}function qh(r,t,e){const s=r.getAttribute(t);if(!s)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const i=s.buffer.data;let n=1/0,a=1/0,o=-1/0,h=-1/0;const l=i.BYTES_PER_ELEMENT,c=(s.offset||0)/l,u=(s.stride||2*4)/l;for(let f=c;f<i.length;f+=u){const d=i[f],g=i[f+1];d>o&&(o=d),g>h&&(h=g),d<n&&(n=d),g<a&&(a=g)}return e.minX=n,e.minY=a,e.maxX=o,e.maxY=h,e}function Kh(r){return(r instanceof Xe||Array.isArray(r)||r.BYTES_PER_ELEMENT)&&(r={buffer:r}),r.buffer=pa(r.buffer,!1),r}class Jh extends Zt{constructor(t={}){super(),this.uid=ft("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Bt,this._boundsDirty=!0;const{attributes:e,indexBuffer:s,topology:i}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,s&&this.addIndex(s),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const s=Kh(e);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=s}addIndex(t){this.indexBuffer=pa(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,qh(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Qh=new Float32Array(1),tl=new Uint32Array(1);class el extends Jh{constructor(){const e=new Xe({data:Qh,label:"attribute-batch-buffer",usage:Ct.VERTEX|Ct.COPY_DST,shrinkToFit:!1}),s=new Xe({data:tl,label:"index-batch-buffer",usage:Ct.INDEX|Ct.COPY_DST,shrinkToFit:!1}),i=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:i,offset:0},aUV:{buffer:e,format:"float32x2",stride:i,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:i,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:i,offset:5*4}},indexBuffer:s})}}function ji(r,t,e){if(r)for(const s in r){const i=s.toLocaleLowerCase(),n=t[i];if(n){let a=r[s];s==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(a)}else Tt(`${s} placement hook does not exist in shader`)}}const sl=/\{\{(.*?)\}\}/g;function Zi(r){var s;const t={};return(((s=r.match(sl))==null?void 0:s.map(i=>i.replace(/[{()}]/g,"")))??[]).forEach(i=>{t[i]=[]}),t}function Hi(r,t){let e;const s=/@in\s+([^;]+);/g;for(;(e=s.exec(r))!==null;)t.push(e[1])}function Yi(r,t,e=!1){const s=[];Hi(t,s),r.forEach(o=>{o.header&&Hi(o.header,s)});const i=s;e&&i.sort();const n=i.map((o,h)=>`       @location(${h}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${n}
`),a}function Xi(r,t){let e;const s=/@out\s+([^;]+);/g;for(;(e=s.exec(r))!==null;)t.push(e[1])}function rl(r){const e=/\b(\w+)\s*:/g.exec(r);return e?e[1]:""}function il(r){const t=/@.*?\s+/g;return r.replace(t,"")}function nl(r,t){const e=[];Xi(t,e),r.forEach(h=>{h.header&&Xi(h.header,e)});let s=0;const i=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${s++}) ${h}`).join(`,
`),n=e.sort().map(h=>`       var ${il(h)};`).join(`
`),a=`return VSOutput(
            ${e.sort().map(h=>` ${rl(h)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${i}
`),o=o.replace("{{start}}",`
${n}
`),o=o.replace("{{return}}",`
${a}
`),o}function qi(r,t){let e=r;for(const s in t){const i=t[s];i.join(`
`).length?e=e.replace(`{{${s}}}`,`//-----${s} START-----//
${i.join(`
`)}
//----${s} FINISH----//`):e=e.replace(`{{${s}}}`,"")}return e}const re=Object.create(null),fr=new Map;let al=0;function ol({template:r,bits:t}){const e=ma(r,t);if(re[e])return re[e];const{vertex:s,fragment:i}=ll(r,t);return re[e]=ga(s,i,t),re[e]}function hl({template:r,bits:t}){const e=ma(r,t);return re[e]||(re[e]=ga(r.vertex,r.fragment,t)),re[e]}function ll(r,t){const e=t.map(a=>a.vertex).filter(a=>!!a),s=t.map(a=>a.fragment).filter(a=>!!a);let i=Yi(e,r.vertex,!0);i=nl(e,i);const n=Yi(s,r.fragment,!0);return{vertex:i,fragment:n}}function ma(r,t){return t.map(e=>(fr.has(e)||fr.set(e,al++),fr.get(e))).sort((e,s)=>e-s).join("-")+r.vertex+r.fragment}function ga(r,t,e){const s=Zi(r),i=Zi(t);return e.forEach(n=>{ji(n.vertex,s,n.name),ji(n.fragment,i,n.name)}),{vertex:qi(r,s),fragment:qi(t,i)}}const cl=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,ul=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,dl=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,fl=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,pl={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},ml={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function gl({bits:r,name:t}){const e=ol({template:{fragment:ul,vertex:cl},bits:[pl,...r]});return _e.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function yl({bits:r,name:t}){return new us({name:t,...hl({template:{vertex:dl,fragment:fl},bits:[ml,...r]})})}const xl={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},_l={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},pr={};function bl(r){const t=[];if(r===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let s=0;s<r;s++)t.push(`@group(1) @binding(${e++}) var textureSource${s+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${s+1}: sampler;`)}return t.join(`
`)}function vl(r){const t=[];if(r===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<r;e++)e===r-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function wl(r){return pr[r]||(pr[r]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${bl(r)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${vl(r)}
            `}}),pr[r]}const mr={};function Cl(r){const t=[];for(let e=0;e<r;e++)e>0&&t.push("else"),e<r-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Sl(r){return mr[r]||(mr[r]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${r}];

            `,main:`

                ${Cl(r)}
            `}}),mr[r]}const Al={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Tl={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Ki={};function Ml(r){let t=Ki[r];if(t)return t;const e=new Int32Array(r);for(let s=0;s<r;s++)e[s]=s;return t=Ki[r]=new Yr({uTextures:{value:e,type:"i32",size:r}},{isStatic:!0}),t}class kl extends Gs{constructor(t){const e=yl({name:"batch",bits:[_l,Sl(t),Tl]}),s=gl({name:"batch",bits:[xl,wl(t),Al]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:Ml(t)}})}}let Ji=null;const ya=class xa extends Xh{constructor(){super(...arguments),this.geometry=new el,this.shader=Ji||(Ji=new kl(this.maxTextures)),this.name=xa.extension.name,this.vertexSize=6}packAttributes(t,e,s,i,n){const a=n<<16|t.roundPixels&65535,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,{positions:g,uvs:x}=t,m=t.color,b=t.attributeOffset,v=b+t.attributeSize;for(let w=b;w<v;w++){const A=w*2,R=g[A],k=g[A+1];e[i++]=h*R+c*k+f,e[i++]=u*k+l*R+d,e[i++]=x[A],e[i++]=x[A+1],s[i++]=m,s[i++]=a}}packQuadAttributes(t,e,s,i,n){const a=t.texture,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,g=t.bounds,x=g.maxX,m=g.minX,b=g.maxY,v=g.minY,w=a.uvs,A=t.color,R=n<<16|t.roundPixels&65535;e[i+0]=h*m+c*v+f,e[i+1]=u*v+l*m+d,e[i+2]=w.x0,e[i+3]=w.y0,s[i+4]=A,s[i+5]=R,e[i+6]=h*x+c*v+f,e[i+7]=u*v+l*x+d,e[i+8]=w.x1,e[i+9]=w.y1,s[i+10]=A,s[i+11]=R,e[i+12]=h*x+c*b+f,e[i+13]=u*b+l*x+d,e[i+14]=w.x2,e[i+15]=w.y2,s[i+16]=A,s[i+17]=R,e[i+18]=h*m+c*b+f,e[i+19]=u*b+l*m+d,e[i+20]=w.x3,e[i+21]=w.y3,s[i+22]=A,s[i+23]=R}};ya.extension={type:[rt.Batcher],name:"default"};let Pl=ya;function Il(r,t,e,s,i,n,a,o=null){let h=0;e*=t,i*=n;const l=o.a,c=o.b,u=o.c,f=o.d,d=o.tx,g=o.ty;for(;h<a;){const x=r[e],m=r[e+1];s[i]=l*x+u*m+d,s[i+1]=c*x+f*m+g,i+=n,e+=t,h++}}function Rl(r,t,e,s){let i=0;for(t*=e;i<s;)r[t]=0,r[t+1]=0,t+=e,i++}function _a(r,t,e,s,i){const n=t.a,a=t.b,o=t.c,h=t.d,l=t.tx,c=t.ty;e||(e=0),s||(s=2),i||(i=r.length/s-e);let u=e*s;for(let f=0;f<i;f++){const d=r[u],g=r[u+1];r[u]=n*d+o*g+l,r[u+1]=a*d+h*g+c,u+=s}}const El=new J;class ba{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,s=this.renderable;return s?Pn(e,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||El}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const qe={extension:{type:rt.ShapeBuilder,name:"circle"},build(r,t){let e,s,i,n,a,o;if(r.type==="circle"){const A=r;e=A.x,s=A.y,a=o=A.radius,i=n=0}else if(r.type==="ellipse"){const A=r;e=A.x,s=A.y,a=A.halfWidth,o=A.halfHeight,i=n=0}else{const A=r,R=A.width/2,k=A.height/2;e=A.x+R,s=A.y+k,a=o=Math.max(0,Math.min(A.radius,Math.min(R,k))),i=R-a,n=k-o}if(!(a>=0&&o>=0&&i>=0&&n>=0))return t;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=h*8+(i?4:0)+(n?4:0);if(l===0)return t;if(h===0)return t[0]=t[6]=e+i,t[1]=t[3]=s+n,t[2]=t[4]=e-i,t[5]=t[7]=s-n,t;let c=0,u=h*4+(i?2:0)+2,f=u,d=l,g=i+a,x=n,m=e+g,b=e-g,v=s+x;if(t[c++]=m,t[c++]=v,t[--u]=v,t[--u]=b,n){const A=s-x;t[f++]=b,t[f++]=A,t[--d]=A,t[--d]=m}for(let A=1;A<h;A++){const R=Math.PI/2*(A/h),k=i+Math.cos(R)*a,P=n+Math.sin(R)*o,Z=e+k,W=e-k,B=s+P,D=s-P;t[c++]=Z,t[c++]=B,t[--u]=B,t[--u]=W,t[f++]=W,t[f++]=D,t[--d]=D,t[--d]=Z}g=i,x=n+o,m=e+g,b=e-g,v=s+x;const w=s-x;return t[c++]=m,t[c++]=v,t[--d]=w,t[--d]=m,i&&(t[c++]=b,t[c++]=v,t[--d]=w,t[--d]=b),t},triangulate(r,t,e,s,i,n){if(r.length===0)return;let a=0,o=0;for(let c=0;c<r.length;c+=2)a+=r[c],o+=r[c+1];a/=r.length/2,o/=r.length/2;let h=s;t[h*e]=a,t[h*e+1]=o;const l=h++;for(let c=0;c<r.length;c+=2)t[h*e]=r[c],t[h*e+1]=r[c+1],c>0&&(i[n++]=h,i[n++]=l,i[n++]=h-1),h++;i[n++]=l+1,i[n++]=l,i[n++]=h-1}},Fl={...qe,extension:{...qe.extension,name:"ellipse"}},Ol={...qe,extension:{...qe.extension,name:"roundedRectangle"}},va=1e-4,Qi=1e-4;function Bl(r){const t=r.length;if(t<6)return 1;let e=0;for(let s=0,i=r[t-2],n=r[t-1];s<t;s+=2){const a=r[s],o=r[s+1];e+=(a-i)*(o+n),i=a,n=o}return e<0?-1:1}function tn(r,t,e,s,i,n,a,o){const h=r-e*i,l=t-s*i,c=r+e*n,u=t+s*n;let f,d;a?(f=s,d=-e):(f=-s,d=e);const g=h+f,x=l+d,m=c+f,b=u+d;return o.push(g,x),o.push(m,b),2}function le(r,t,e,s,i,n,a,o){const h=e-r,l=s-t;let c=Math.atan2(h,l),u=Math.atan2(i-r,n-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let f=c;const d=u-c,g=Math.abs(d),x=Math.sqrt(h*h+l*l),m=(15*g*Math.sqrt(x)/Math.PI>>0)+1,b=d/m;if(f+=b,o){a.push(r,t),a.push(e,s);for(let v=1,w=f;v<m;v++,w+=b)a.push(r,t),a.push(r+Math.sin(w)*x,t+Math.cos(w)*x);a.push(r,t),a.push(i,n)}else{a.push(e,s),a.push(r,t);for(let v=1,w=f;v<m;v++,w+=b)a.push(r+Math.sin(w)*x,t+Math.cos(w)*x),a.push(r,t);a.push(i,n),a.push(r,t)}return m*2}function Nl(r,t,e,s,i,n){const a=va;if(r.length===0)return;const o=t;let h=o.alignment;if(t.alignment!==.5){let C=Bl(r);h=(h-.5)*C+.5}const l=new xt(r[0],r[1]),c=new xt(r[r.length-2],r[r.length-1]),u=s,f=Math.abs(l.x-c.x)<a&&Math.abs(l.y-c.y)<a;if(u){r=r.slice(),f&&(r.pop(),r.pop(),c.set(r[r.length-2],r[r.length-1]));const C=(l.x+c.x)*.5,S=(c.y+l.y)*.5;r.unshift(C,S),r.push(C,S)}const d=i,g=r.length/2;let x=r.length;const m=d.length/2,b=o.width/2,v=b*b,w=o.miterLimit*o.miterLimit;let A=r[0],R=r[1],k=r[2],P=r[3],Z=0,W=0,B=-(R-P),D=A-k,at=0,it=0,mt=Math.sqrt(B*B+D*D);B/=mt,D/=mt,B*=b,D*=b;const Xt=h,p=(1-Xt)*2,y=Xt*2;u||(o.cap==="round"?x+=le(A-B*(p-y)*.5,R-D*(p-y)*.5,A-B*p,R-D*p,A+B*y,R+D*y,d,!0)+2:o.cap==="square"&&(x+=tn(A,R,B,D,p,y,!0,d))),d.push(A-B*p,R-D*p),d.push(A+B*y,R+D*y);for(let C=1;C<g-1;++C){A=r[(C-1)*2],R=r[(C-1)*2+1],k=r[C*2],P=r[C*2+1],Z=r[(C+1)*2],W=r[(C+1)*2+1],B=-(R-P),D=A-k,mt=Math.sqrt(B*B+D*D),B/=mt,D/=mt,B*=b,D*=b,at=-(P-W),it=k-Z,mt=Math.sqrt(at*at+it*it),at/=mt,it/=mt,at*=b,it*=b;const S=k-A,T=R-P,M=k-Z,E=W-P,U=S*M+T*E,z=T*M-E*S,et=z<0;if(Math.abs(z)<.001*Math.abs(U)){d.push(k-B*p,P-D*p),d.push(k+B*y,P+D*y),U>=0&&(o.join==="round"?x+=le(k,P,k-B*p,P-D*p,k-at*p,P-it*p,d,!1)+4:x+=2,d.push(k-at*y,P-it*y),d.push(k+at*p,P+it*p));continue}const st=(-B+A)*(-D+P)-(-B+k)*(-D+R),K=(-at+Z)*(-it+P)-(-at+k)*(-it+W),dt=(S*K-M*st)/z,tt=(E*st-T*K)/z,qt=(dt-k)*(dt-k)+(tt-P)*(tt-P),St=k+(dt-k)*p,Gt=P+(tt-P)*p,zt=k-(dt-k)*y,Y=P-(tt-P)*y,Q=Math.min(S*S+T*T,M*M+E*E),ai=et?p:y,Wa=Q+ai*ai*v;qt<=Wa?o.join==="bevel"||qt/v>w?(et?(d.push(St,Gt),d.push(k+B*y,P+D*y),d.push(St,Gt),d.push(k+at*y,P+it*y)):(d.push(k-B*p,P-D*p),d.push(zt,Y),d.push(k-at*p,P-it*p),d.push(zt,Y)),x+=2):o.join==="round"?et?(d.push(St,Gt),d.push(k+B*y,P+D*y),x+=le(k,P,k+B*y,P+D*y,k+at*y,P+it*y,d,!0)+4,d.push(St,Gt),d.push(k+at*y,P+it*y)):(d.push(k-B*p,P-D*p),d.push(zt,Y),x+=le(k,P,k-B*p,P-D*p,k-at*p,P-it*p,d,!1)+4,d.push(k-at*p,P-it*p),d.push(zt,Y)):(d.push(St,Gt),d.push(zt,Y)):(d.push(k-B*p,P-D*p),d.push(k+B*y,P+D*y),o.join==="round"?et?x+=le(k,P,k+B*y,P+D*y,k+at*y,P+it*y,d,!0)+2:x+=le(k,P,k-B*p,P-D*p,k-at*p,P-it*p,d,!1)+2:o.join==="miter"&&qt/v<=w&&(et?(d.push(zt,Y),d.push(zt,Y)):(d.push(St,Gt),d.push(St,Gt)),x+=2),d.push(k-at*p,P-it*p),d.push(k+at*y,P+it*y),x+=2)}A=r[(g-2)*2],R=r[(g-2)*2+1],k=r[(g-1)*2],P=r[(g-1)*2+1],B=-(R-P),D=A-k,mt=Math.sqrt(B*B+D*D),B/=mt,D/=mt,B*=b,D*=b,d.push(k-B*p,P-D*p),d.push(k+B*y,P+D*y),u||(o.cap==="round"?x+=le(k-B*(p-y)*.5,P-D*(p-y)*.5,k-B*p,P-D*p,k+B*y,P+D*y,d,!1)+2:o.cap==="square"&&(x+=tn(k,P,B,D,p,y,!1,d)));const _=Qi*Qi;for(let C=m;C<x+m-2;++C)A=d[C*2],R=d[C*2+1],k=d[(C+1)*2],P=d[(C+1)*2+1],Z=d[(C+2)*2],W=d[(C+2)*2+1],!(Math.abs(A*(P-W)+k*(W-R)+Z*(R-P))<_)&&n.push(C,C+1,C+2)}function Dl(r,t,e,s){const i=va;if(r.length===0)return;const n=r[0],a=r[1],o=r[r.length-2],h=r[r.length-1],l=t||Math.abs(n-o)<i&&Math.abs(a-h)<i,c=e,u=r.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(r[d*2]),c.push(r[d*2+1]);for(let d=0;d<u-1;d++)s.push(f+d,f+d+1);l&&s.push(f+u-1,f)}function wa(r,t,e,s,i,n,a){const o=Ah(r,t,2);if(!o)return;for(let l=0;l<o.length;l+=3)n[a++]=o[l]+i,n[a++]=o[l+1]+i,n[a++]=o[l+2]+i;let h=i*s;for(let l=0;l<r.length;l+=2)e[h]=r[l],e[h+1]=r[l+1],h+=s}const Gl=[],zl={extension:{type:rt.ShapeBuilder,name:"polygon"},build(r,t){for(let e=0;e<r.points.length;e++)t[e]=r.points[e];return t},triangulate(r,t,e,s,i,n){wa(r,Gl,t,e,s,i,n)}},Ll={extension:{type:rt.ShapeBuilder,name:"rectangle"},build(r,t){const e=r,s=e.x,i=e.y,n=e.width,a=e.height;return n>=0&&a>=0&&(t[0]=s,t[1]=i,t[2]=s+n,t[3]=i,t[4]=s+n,t[5]=i+a,t[6]=s,t[7]=i+a),t},triangulate(r,t,e,s,i,n){let a=0;s*=e,t[s+a]=r[0],t[s+a+1]=r[1],a+=e,t[s+a]=r[2],t[s+a+1]=r[3],a+=e,t[s+a]=r[6],t[s+a+1]=r[7],a+=e,t[s+a]=r[4],t[s+a+1]=r[5],a+=e;const o=s/e;i[n++]=o,i[n++]=o+1,i[n++]=o+2,i[n++]=o+1,i[n++]=o+3,i[n++]=o+2}},Vl={extension:{type:rt.ShapeBuilder,name:"triangle"},build(r,t){return t[0]=r.x,t[1]=r.y,t[2]=r.x2,t[3]=r.y2,t[4]=r.x3,t[5]=r.y3,t},triangulate(r,t,e,s,i,n){let a=0;s*=e,t[s+a]=r[0],t[s+a+1]=r[1],a+=e,t[s+a]=r[2],t[s+a+1]=r[3],a+=e,t[s+a]=r[4],t[s+a+1]=r[5];const o=s/e;i[n++]=o,i[n++]=o+1,i[n++]=o+2}},Ul=new J,$l=new pt;function Wl(r,t,e,s){const i=t.matrix?r.copyFrom(t.matrix).invert():r.identity();if(t.textureSpace==="local"){const n=e.getBounds($l);i.translate(-n.x,-n.y),i.scale(1/n.width,1/n.height)}else{i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);const n=t.texture.source.style;n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update())}return s&&i.append(Ul.copyFrom(s).invert()),i}const zs={};Pt.handleByMap(rt.ShapeBuilder,zs);Pt.add(Ll,zl,Vl,qe,Fl,Ol);const jl=new pt,Zl=new J;function Hl(r,t){const{geometryData:e,batches:s}=t;s.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let i=0;i<r.instructions.length;i++){const n=r.instructions[i];if(n.action==="texture")Yl(n.data,s,e);else if(n.action==="fill"||n.action==="stroke"){const a=n.action==="stroke",o=n.data.path.shapePath,h=n.data.style,l=n.data.hole;a&&l&&en(l.shapePath,h,!0,s,e),l&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),en(o,h,a,s,e)}}}function Yl(r,t,e){const{vertices:s,uvs:i,indices:n}=e,a=n.length,o=s.length/2,h=[],l=zs.rectangle,c=jl,u=r.image;c.x=r.dx,c.y=r.dy,c.width=r.dw,c.height=r.dh;const f=r.transform;l.build(c,h),f&&_a(h,f),l.triangulate(h,s,2,o,n,a);const d=u.uvs;i.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const g=te.get(ba);g.indexOffset=a,g.indexSize=n.length-a,g.attributeOffset=o,g.attributeSize=s.length/2-o,g.baseColor=r.style,g.alpha=r.alpha,g.texture=u,g.geometryData=e,t.push(g)}function en(r,t,e,s,i){const{vertices:n,uvs:a,indices:o}=i;r.shapePrimitives.forEach(({shape:h,transform:l,holes:c})=>{const u=o.length,f=n.length/2,d=[],g=zs[h.type];let x="triangle-list";if(g.build(h,d),l&&_a(d,l),e){const w=h.closePath??!0,A=t;A.pixelLine?(Dl(d,w,n,o),x="line-list"):Nl(d,A,!1,w,n,o)}else if(c){const w=[],A=d.slice();Xl(c).forEach(k=>{w.push(A.length/2),A.push(...k)}),wa(A,w,n,2,f,o,u)}else g.triangulate(d,n,2,f,o,u);const m=a.length/2,b=t.texture;if(b!==nt.WHITE){const w=Wl(Zl,t,h,l);Il(n,2,f,a,m,2,n.length/2-f,w)}else Rl(a,m,2,n.length/2-f);const v=te.get(ba);v.indexOffset=u,v.indexSize=o.length-u,v.attributeOffset=f,v.attributeSize=n.length/2-f,v.baseColor=t.color,v.alpha=t.alpha,v.texture=b,v.geometryData=i,v.topology=x,s.push(v)})}function Xl(r){const t=[];for(let e=0;e<r.length;e++){const s=r[e].shape,i=[];zs[s.type].build(s,i),t.push(i)}return t}class ql{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Kl{constructor(){this.batcher=new Pl,this.instructions=new Fn}init(){this.instructions.reset()}get geometry(){return X(no,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const ei=class Br{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){Br.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??Br.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Hl(t,e);const s=t.batchMode;t.customShader||s==="no-batch"?e.isBatchable=!1:s==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=te.get(Kl),{batches:s,geometryData:i}=this._gpuContextHash[t.uid],n=i.vertices.length,a=i.indices.length;for(let c=0;c<s.length;c++)s[c].applyTransform=!1;const o=e.batcher;o.ensureAttributeBuffer(n),o.ensureIndexBuffer(a),o.begin();for(let c=0;c<s.length;c++){const u=s[c];o.add(u)}o.finish(e.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let c=0;c<l.length;c++){const u=l[c];u.bindGroup=$h(u.textures.textures,u.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new ql;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(te.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(s=>{te.return(s)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};ei.extension={type:[rt.WebGLSystem,rt.WebGPUSystem,rt.CanvasSystem],name:"graphicsContext"};ei.defaultOptions={bezierSmoothness:.5};let Ca=ei;const Jl=8,Cs=11920929e-14,Ql=1;function Sa(r,t,e,s,i,n,a,o,h,l){const u=Math.min(.99,Math.max(0,l??Ca.defaultOptions.bezierSmoothness));let f=(Ql-u)/1;return f*=f,tc(t,e,s,i,n,a,o,h,r,f),r}function tc(r,t,e,s,i,n,a,o,h,l){Nr(r,t,e,s,i,n,a,o,h,l,0),h.push(a,o)}function Nr(r,t,e,s,i,n,a,o,h,l,c){if(c>Jl)return;const u=(r+e)/2,f=(t+s)/2,d=(e+i)/2,g=(s+n)/2,x=(i+a)/2,m=(n+o)/2,b=(u+d)/2,v=(f+g)/2,w=(d+x)/2,A=(g+m)/2,R=(b+w)/2,k=(v+A)/2;if(c>0){let P=a-r,Z=o-t;const W=Math.abs((e-a)*Z-(s-o)*P),B=Math.abs((i-a)*Z-(n-o)*P);if(W>Cs&&B>Cs){if((W+B)*(W+B)<=l*(P*P+Z*Z)){h.push(R,k);return}}else if(W>Cs){if(W*W<=l*(P*P+Z*Z)){h.push(R,k);return}}else if(B>Cs){if(B*B<=l*(P*P+Z*Z)){h.push(R,k);return}}else if(P=R-(r+a)/2,Z=k-(t+o)/2,P*P+Z*Z<=l){h.push(R,k);return}}Nr(r,t,u,f,b,v,R,k,h,l,c+1),Nr(R,k,w,A,x,m,a,o,h,l,c+1)}const ec=8,sc=11920929e-14,rc=1;function ic(r,t,e,s,i,n,a,o){const l=Math.min(.99,Math.max(0,o??Ca.defaultOptions.bezierSmoothness));let c=(rc-l)/1;return c*=c,nc(t,e,s,i,n,a,r,c),r}function nc(r,t,e,s,i,n,a,o){Dr(a,r,t,e,s,i,n,o,0),a.push(i,n)}function Dr(r,t,e,s,i,n,a,o,h){if(h>ec)return;const l=(t+s)/2,c=(e+i)/2,u=(s+n)/2,f=(i+a)/2,d=(l+u)/2,g=(c+f)/2;let x=n-t,m=a-e;const b=Math.abs((s-n)*m-(i-a)*x);if(b>sc){if(b*b<=o*(x*x+m*m)){r.push(d,g);return}}else if(x=d-(t+n)/2,m=g-(e+a)/2,x*x+m*m<=o){r.push(d,g);return}Dr(r,t,e,l,c,d,g,o,h+1),Dr(r,d,g,u,f,n,a,o,h+1)}function Aa(r,t,e,s,i,n,a,o){let h=Math.abs(i-n);(!a&&i>n||a&&n>i)&&(h=2*Math.PI-h),o||(o=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI)))),o=Math.max(o,3);let l=h/o,c=i;l*=a?-1:1;for(let u=0;u<o+1;u++){const f=Math.cos(c),d=Math.sin(c),g=t+f*s,x=e+d*s;r.push(g,x),c+=l}}function ac(r,t,e,s,i,n){const a=r[r.length-2],h=r[r.length-1]-e,l=a-t,c=i-e,u=s-t,f=Math.abs(h*u-l*c);if(f<1e-8||n===0){(r[r.length-2]!==t||r[r.length-1]!==e)&&r.push(t,e);return}const d=h*h+l*l,g=c*c+u*u,x=h*c+l*u,m=n*Math.sqrt(d)/f,b=n*Math.sqrt(g)/f,v=m*x/d,w=b*x/g,A=m*u+b*l,R=m*c+b*h,k=l*(b+v),P=h*(b+v),Z=u*(m+w),W=c*(m+w),B=Math.atan2(P-R,k-A),D=Math.atan2(W-R,Z-A);Aa(r,A+t,R+e,n,B,D,l*c>u*h)}const je=Math.PI*2,gr={centerX:0,centerY:0,ang1:0,ang2:0},yr=({x:r,y:t},e,s,i,n,a,o,h)=>{r*=e,t*=s;const l=i*r-n*t,c=n*r+i*t;return h.x=l+a,h.y=c+o,h};function oc(r,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,i=Math.cos(r),n=Math.sin(r),a=Math.cos(r+t),o=Math.sin(r+t);return[{x:i-n*s,y:n+i*s},{x:a+o*s,y:o-a*s},{x:a,y:o}]}const sn=(r,t,e,s)=>{const i=r*s-t*e<0?-1:1;let n=r*e+t*s;return n>1&&(n=1),n<-1&&(n=-1),i*Math.acos(n)},hc=(r,t,e,s,i,n,a,o,h,l,c,u,f)=>{const d=Math.pow(i,2),g=Math.pow(n,2),x=Math.pow(c,2),m=Math.pow(u,2);let b=d*g-d*m-g*x;b<0&&(b=0),b/=d*m+g*x,b=Math.sqrt(b)*(a===o?-1:1);const v=b*i/n*u,w=b*-n/i*c,A=l*v-h*w+(r+e)/2,R=h*v+l*w+(t+s)/2,k=(c-v)/i,P=(u-w)/n,Z=(-c-v)/i,W=(-u-w)/n,B=sn(1,0,k,P);let D=sn(k,P,Z,W);o===0&&D>0&&(D-=je),o===1&&D<0&&(D+=je),f.centerX=A,f.centerY=R,f.ang1=B,f.ang2=D};function lc(r,t,e,s,i,n,a,o=0,h=0,l=0){if(n===0||a===0)return;const c=Math.sin(o*je/360),u=Math.cos(o*je/360),f=u*(t-s)/2+c*(e-i)/2,d=-c*(t-s)/2+u*(e-i)/2;if(f===0&&d===0)return;n=Math.abs(n),a=Math.abs(a);const g=Math.pow(f,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(a,2);g>1&&(n*=Math.sqrt(g),a*=Math.sqrt(g)),hc(t,e,s,i,n,a,h,l,c,u,f,d,gr);let{ang1:x,ang2:m}=gr;const{centerX:b,centerY:v}=gr;let w=Math.abs(m)/(je/4);Math.abs(1-w)<1e-7&&(w=1);const A=Math.max(Math.ceil(w),1);m/=A;let R=r[r.length-2],k=r[r.length-1];const P={x:0,y:0};for(let Z=0;Z<A;Z++){const W=oc(x,m),{x:B,y:D}=yr(W[0],n,a,u,c,b,v,P),{x:at,y:it}=yr(W[1],n,a,u,c,b,v,P),{x:mt,y:Xt}=yr(W[2],n,a,u,c,b,v,P);Sa(r,R,k,B,D,at,it,mt,Xt),R=mt,k=Xt,x+=m}}function cc(r,t,e){const s=(a,o)=>{const h=o.x-a.x,l=o.y-a.y,c=Math.sqrt(h*h+l*l),u=h/c,f=l/c;return{len:c,nx:u,ny:f}},i=(a,o)=>{a===0?r.moveTo(o.x,o.y):r.lineTo(o.x,o.y)};let n=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],h=o.radius??e;if(h<=0){i(a,o),n=o;continue}const l=t[(a+1)%t.length],c=s(o,n),u=s(o,l);if(c.len<1e-4||u.len<1e-4){i(a,o),n=o;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,g=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,g=!0):f>0&&(d=-1,g=!0);const x=f/2;let m,b=Math.abs(Math.cos(x)*h/Math.sin(x));b>Math.min(c.len/2,u.len/2)?(b=Math.min(c.len/2,u.len/2),m=Math.abs(b*Math.sin(x)/Math.cos(x))):m=h;const v=o.x+u.nx*b+-u.ny*m*d,w=o.y+u.ny*b+u.nx*m*d,A=Math.atan2(c.ny,c.nx)+Math.PI/2*d,R=Math.atan2(u.ny,u.nx)-Math.PI/2*d;a===0&&r.moveTo(v+Math.cos(A)*m,w+Math.sin(A)*m),r.arc(v,w,m,A,R,g),n=o}}function uc(r,t,e,s){const i=(o,h)=>Math.sqrt((o.x-h.x)**2+(o.y-h.y)**2),n=(o,h,l)=>({x:o.x+(h.x-o.x)*l,y:o.y+(h.y-o.y)*l}),a=t.length;for(let o=0;o<a;o++){const h=t[(o+1)%a],l=h.radius??e;if(l<=0){o===0?r.moveTo(h.x,h.y):r.lineTo(h.x,h.y);continue}const c=t[o],u=t[(o+2)%a],f=i(c,h);let d;if(f<1e-4)d=h;else{const m=Math.min(f/2,l);d=n(h,c,m/f)}const g=i(u,h);let x;if(g<1e-4)x=h;else{const m=Math.min(g/2,l);x=n(h,u,m/g)}o===0?r.moveTo(d.x,d.y):r.lineTo(d.x,d.y),r.quadraticCurveTo(h.x,h.y,x.x,x.y,s)}}const dc=new pt;class fc{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Bt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,i=s[s.length-2],n=s[s.length-1];return(i!==t||n!==e)&&s.push(t,e),this}arc(t,e,s,i,n,a){this._ensurePoly(!1);const o=this._currentPoly.points;return Aa(o,t,e,s,i,n,a),this}arcTo(t,e,s,i,n){this._ensurePoly();const a=this._currentPoly.points;return ac(a,t,e,s,i,n),this}arcToSvg(t,e,s,i,n,a,o){const h=this._currentPoly.points;return lc(h,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,s,i,n),this}bezierCurveTo(t,e,s,i,n,a,o){this._ensurePoly();const h=this._currentPoly;return Sa(this._currentPoly.points,h.lastX,h.lastY,t,e,s,i,n,a,o),this}quadraticCurveTo(t,e,s,i,n){this._ensurePoly();const a=this._currentPoly;return ic(this._currentPoly.points,a.lastX,a.lastY,t,e,s,i,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const s=this.shapePrimitives,i=s.length;for(let n=0;n<t.instructions.length;n++){const a=t.instructions[n];this[a.action](...a.data)}if(t.checkForHoles&&s.length-i>1){let n=null;for(let a=i;a<s.length;a++){const o=s[a];if(o.shape.type==="polygon"){const h=o.shape,l=n==null?void 0:n.shape;l&&l.containsPolygon(h)?(n.holes||(n.holes=[]),n.holes.push(o),s.copyWithin(a,a+1),s.length--,a--):n=o}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,i,n){return this.drawShape(new pt(t,e,s,i),n),this}circle(t,e,s,i){return this.drawShape(new Jr(t,e,s),i),this}poly(t,e,s){const i=new We(t);return i.closePath=e,this.drawShape(i,s),this}regularPoly(t,e,s,i,n=0,a){i=Math.max(i|0,3);const o=-1*Math.PI/2+n,h=Math.PI*2/i,l=[];for(let c=0;c<i;c++){const u=o-c*h;l.push(t+s*Math.cos(u),e+s*Math.sin(u))}return this.poly(l,!0,a),this}roundPoly(t,e,s,i,n,a=0,o){if(i=Math.max(i|0,3),n<=0)return this.regularPoly(t,e,s,i,a);const h=s*Math.sin(Math.PI/i)-.001;n=Math.min(n,h);const l=-1*Math.PI/2+a,c=Math.PI*2/i,u=(i-2)*Math.PI/i/2;for(let f=0;f<i;f++){const d=f*c+l,g=t+s*Math.cos(d),x=e+s*Math.sin(d),m=d+Math.PI+u,b=d-Math.PI-u,v=g+n*Math.cos(m),w=x+n*Math.sin(m),A=g+n*Math.cos(b),R=x+n*Math.sin(b);f===0?this.moveTo(v,w):this.lineTo(v,w),this.quadraticCurveTo(g,x,A,R,o)}return this.closePath()}roundShape(t,e,s=!1,i){return t.length<3?this:(s?uc(this,t,e,i):cc(this,t,e),this.closePath())}filletRect(t,e,s,i,n){if(n===0)return this.rect(t,e,s,i);const a=Math.min(s,i)/2,o=Math.min(a,Math.max(-a,n)),h=t+s,l=e+i,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(h-u,e).arcTo(h-c,e+c,h,e+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+s-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,e,s,i,n,a){if(n<=0)return this.rect(t,e,s,i);const o=Math.min(n,Math.min(s,i)/2),h=t+s,l=e+i,c=[t+o,e,h-o,e,h,e+o,h,l-o,h-o,l,t+o,l,t,l-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,s,i,n){return this.drawShape(new Qr(t,e,s,i),n),this}roundRect(t,e,s,i,n,a){return this.drawShape(new ti(t,e,s,i,n),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new We,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new We,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,a=s;s=n.a*s+n.c*i+n.tx,i=n.b*a+n.d*i+n.ty}this._currentPoly.points.push(s,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const i=e[s],n=i.shape.getBounds(dc);i.transform?t.addRect(n,i.transform):t.addRect(n)}return t}}class Ie{constructor(t,e=!1){this.instructions=[],this.uid=ft("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Nh(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new fc(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,i,n){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(xt.shared);let h=0,l=0;if(!a||a.action!=="bezierCurveTo")h=o.x,l=o.y;else{h=a.data[2],l=a.data[3];const c=o.x,u=o.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,s,i,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const i=this.instructions[this.instructions.length-1],n=this.getLastPoint(xt.shared);let a=0,o=0;if(!i||i.action!=="quadraticCurveTo")a=n.x,o=n.y;else{a=i.data[0],o=i.data[1];const h=n.x,l=n.y;a=h+(h-a),o=l+(l-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,s]}),this._dirty=!0,this}rect(t,e,s,i,n){return this.instructions.push({action:"rect",data:[t,e,s,i,n]}),this._dirty=!0,this}circle(t,e,s,i){return this.instructions.push({action:"circle",data:[t,e,s,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,i,n,a,o){n||(n=i/2);const h=-1*Math.PI/2+a,l=s*2,c=Math.PI*2/l,u=[];for(let f=0;f<l;f++){const d=f%2?n:i,g=f*c+h;u.push(t+d*Math.cos(g),e+d*Math.sin(g))}return this.poly(u,!0,o),this}clone(t=!1){const e=new Ie;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const i=this.instructions[s];e.instructions.push({action:i.action,data:i.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,i=t.c,n=t.d,a=t.tx,o=t.ty;let h=0,l=0,c=0,u=0,f=0,d=0,g=0,x=0;for(let m=0;m<this.instructions.length;m++){const b=this.instructions[m],v=b.data;switch(b.action){case"moveTo":case"lineTo":h=v[0],l=v[1],v[0]=e*h+i*l+a,v[1]=s*h+n*l+o;break;case"bezierCurveTo":c=v[0],u=v[1],f=v[2],d=v[3],h=v[4],l=v[5],v[0]=e*c+i*u+a,v[1]=s*c+n*u+o,v[2]=e*f+i*d+a,v[3]=s*f+n*d+o,v[4]=e*h+i*l+a,v[5]=s*h+n*l+o;break;case"quadraticCurveTo":c=v[0],u=v[1],h=v[2],l=v[3],v[0]=e*c+i*u+a,v[1]=s*c+n*u+o,v[2]=e*h+i*l+a,v[3]=s*h+n*l+o;break;case"arcToSvg":h=v[5],l=v[6],g=v[0],x=v[1],v[0]=e*g+i*x,v[1]=s*g+n*x,v[5]=e*h+i*l+a,v[6]=s*h+n*l+o;break;case"circle":v[4]=De(v[3],t);break;case"rect":v[4]=De(v[4],t);break;case"ellipse":v[8]=De(v[8],t);break;case"roundRect":v[5]=De(v[5],t);break;case"addPath":v[0].transform(t);break;case"poly":v[2]=De(v[2],t);break;default:Tt("unknown transform action",b.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function De(r,t){return r?r.prepend(t):t.clone()}function ut(r,t,e){const s=r.getAttribute(t);return s?Number(s):e}function pc(r,t){const e=r.querySelectorAll("defs");for(let s=0;s<e.length;s++){const i=e[s];for(let n=0;n<i.children.length;n++){const a=i.children[n];switch(a.nodeName.toLowerCase()){case"lineargradient":t.defs[a.id]=mc(a);break;case"radialgradient":t.defs[a.id]=gc();break}}}}function mc(r){const t=ut(r,"x1",0),e=ut(r,"y1",0),s=ut(r,"x2",1),i=ut(r,"y2",0),n=r.getAttribute("gradientUnits")||"objectBoundingBox",a=new ie(t,e,s,i,n==="objectBoundingBox"?"local":"global");for(let o=0;o<r.children.length;o++){const h=r.children[o],l=ut(h,"offset",0),c=yt.shared.setValue(h.getAttribute("stop-color")).toNumber();a.addColorStop(l,c)}return a}function gc(r){return Tt("[SVG Parser] Radial gradients are not yet supported"),new ie(0,0,1,0)}function rn(r){const t=r.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const nn={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Ta(r,t){const e=r.getAttribute("style"),s={},i={},n={strokeStyle:s,fillStyle:i,useFill:!1,useStroke:!1};for(const a in nn){const o=r.getAttribute(a);o&&an(t,n,a,o.trim())}if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const h=a[o].trim(),[l,c]=h.split(":");nn[l]&&an(t,n,l,c.trim())}}return{strokeStyle:n.useStroke?s:null,fillStyle:n.useFill?i:null,useFill:n.useFill,useStroke:n.useStroke}}function an(r,t,e,s){switch(e){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const i=rn(s);t.strokeStyle.fill=r.defs[i]}else t.strokeStyle.color=yt.shared.setValue(s).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const i=rn(s);t.fillStyle.fill=r.defs[i]}else t.fillStyle.color=yt.shared.setValue(s).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(s);break;case"stroke-opacity":t.strokeStyle.alpha=Number(s);break;case"opacity":t.fillStyle.alpha=Number(s),t.strokeStyle.alpha=Number(s);break}}function yc(r,t){if(typeof r=="string"){const a=document.createElement("div");a.innerHTML=r.trim(),r=a.querySelector("svg")}const e={context:t,defs:{},path:new Ie};pc(r,e);const s=r.children,{fillStyle:i,strokeStyle:n}=Ta(r,e);for(let a=0;a<s.length;a++){const o=s[a];o.nodeName.toLowerCase()!=="defs"&&Ma(o,e,i,n)}return t}function Ma(r,t,e,s){const i=r.children,{fillStyle:n,strokeStyle:a}=Ta(r,t);n&&e?e={...e,...n}:n&&(e=n),a&&s?s={...s,...a}:a&&(s=a);const o=!e&&!s;o&&(e={color:0});let h,l,c,u,f,d,g,x,m,b,v,w,A,R,k,P,Z;switch(r.nodeName.toLowerCase()){case"path":R=r.getAttribute("d"),r.getAttribute("fill-rule")==="evenodd"&&Tt("SVG Evenodd fill rule not supported, your svg may render incorrectly"),k=new Ie(R,!0),t.context.path(k),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"circle":g=ut(r,"cx",0),x=ut(r,"cy",0),m=ut(r,"r",0),t.context.ellipse(g,x,m,m),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"rect":h=ut(r,"x",0),l=ut(r,"y",0),P=ut(r,"width",0),Z=ut(r,"height",0),b=ut(r,"rx",0),v=ut(r,"ry",0),b||v?t.context.roundRect(h,l,P,Z,b||v):t.context.rect(h,l,P,Z),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"ellipse":g=ut(r,"cx",0),x=ut(r,"cy",0),b=ut(r,"rx",0),v=ut(r,"ry",0),t.context.beginPath(),t.context.ellipse(g,x,b,v),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"line":c=ut(r,"x1",0),u=ut(r,"y1",0),f=ut(r,"x2",0),d=ut(r,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(f,d),s&&t.context.stroke(s);break;case"polygon":A=r.getAttribute("points"),w=A.match(/\d+/g).map(W=>parseInt(W,10)),t.context.poly(w,!0),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"polyline":A=r.getAttribute("points"),w=A.match(/\d+/g).map(W=>parseInt(W,10)),t.context.poly(w,!1),s&&t.context.stroke(s);break;case"g":case"svg":break;default:{Tt(`[SVG parser] <${r.nodeName}> elements unsupported`);break}}o&&(e=null);for(let W=0;W<i.length;W++)Ma(i[W],t,e,s)}function xc(r){return yt.isColorLike(r)}function on(r){return r instanceof Kr}function hn(r){return r instanceof ie}function _c(r){return r instanceof nt}function bc(r,t,e){const s=yt.shared.setValue(t??0);return r.color=s.toNumber(),r.alpha=s.alpha===1?e.alpha:s.alpha,r.texture=nt.WHITE,{...e,...r}}function vc(r,t,e){return r.texture=t,{...e,...r}}function ln(r,t,e){return r.fill=t,r.color=16777215,r.texture=t.texture,r.matrix=t.transform,{...e,...r}}function cn(r,t,e){return t.buildGradient(),r.fill=t,r.color=16777215,r.texture=t.texture,r.matrix=t.transform,r.textureSpace=t.textureSpace,{...e,...r}}function wc(r,t){const e={...t,...r},s=yt.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e}function pe(r,t){if(r==null)return null;const e={},s=r;return xc(r)?bc(e,r,t):_c(r)?vc(e,r,t):on(r)?ln(e,r,t):hn(r)?cn(e,r,t):s.fill&&on(s.fill)?ln(s,s.fill,t):s.fill&&hn(s.fill)?cn(s,s.fill,t):wc(s,t)}function Ps(r,t){const{width:e,alignment:s,miterLimit:i,cap:n,join:a,pixelLine:o,...h}=t,l=pe(r,h);return l?{width:e,alignment:s,miterLimit:i,cap:n,join:a,pixelLine:o,...l}:null}const Cc=new xt,un=new J,si=class Vt extends Zt{constructor(){super(...arguments),this.uid=ft("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Ie,this._transform=new J,this._fillStyle={...Vt.defaultFillStyle},this._strokeStyle={...Vt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Bt,this._boundsDirty=!0}clone(){const t=new Vt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=pe(t,Vt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ps(t,Vt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=pe(t,Vt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=pe(t,Vt.defaultStrokeStyle),this}texture(t,e,s,i,n,a){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:i||0,dw:n||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?yt.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Ie,this}fill(t,e){let s;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="stroke"?s=i.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(X(ct,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=pe(t,Vt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(xt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ps(t,Vt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,i,n,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,s,i,n,a),this}arcTo(t,e,s,i,n){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*s+a.c*i+a.tx,a.b*s+a.d*i+a.ty,n),this}arcToSvg(t,e,s,i,n,a,o){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,s,i,n,h.a*a+h.c*o+h.tx,h.b*a+h.d*o+h.ty),this}bezierCurveTo(t,e,s,i,n,a,o){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*s+h.c*i+h.tx,h.b*s+h.d*i+h.ty,h.a*n+h.c*a+h.tx,h.b*n+h.d*a+h.ty,o),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,s,i){return this._tick++,this._activePath.ellipse(t,e,s,i,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,i=this._activePath.instructions,n=s.a*t+s.c*e+s.tx,a=s.b*t+s.d*e+s.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=n,i[0].data[1]=a,this):(this._activePath.moveTo(n,a),this)}quadraticCurveTo(t,e,s,i,n){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*s+a.c*i+a.tx,a.b*s+a.d*i+a.ty,n),this}rect(t,e,s,i){return this._tick++,this._activePath.rect(t,e,s,i,this._transform.clone()),this}roundRect(t,e,s,i,n){return this._tick++,this._activePath.roundRect(t,e,s,i,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,i,n=0,a){return this._tick++,this._activePath.regularPoly(t,e,s,i,n,a),this}roundPoly(t,e,s,i,n,a){return this._tick++,this._activePath.roundPoly(t,e,s,i,n,a),this}roundShape(t,e,s,i){return this._tick++,this._activePath.roundShape(t,e,s,i),this}filletRect(t,e,s,i,n){return this._tick++,this._activePath.filletRect(t,e,s,i,n),this}chamferRect(t,e,s,i,n,a){return this._tick++,this._activePath.chamferRect(t,e,s,i,n,a),this}star(t,e,s,i,n=0,a=0){return this._tick++,this._activePath.star(t,e,s,i,n,a,this._transform.clone()),this}svg(t){return this._tick++,yc(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,i,n,a){return t instanceof J?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,i,n,a),this)}transform(t,e,s,i,n,a){return t instanceof J?(this._transform.append(t),this):(un.set(t,e,s,i,n,a),this._transform.append(un),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],i=s.action;if(i==="fill"){const n=s.data;t.addBounds(n.path.bounds)}else if(i==="texture"){const n=s.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(i==="stroke"){const n=s.data,a=n.style.alignment,o=n.style.width*(1-a),h=n.path.bounds;t.addFrame(h.minX-o,h.minY-o,h.maxX+o,h.maxY+o)}}return t}containsPoint(t){var i;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let n=0;n<e.length;n++){const a=e[n],o=a.data,h=o.path;if(!a.action||!h)continue;const l=o.style,c=h.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const f=c[u].shape;if(!l||!f)continue;const d=c[u].transform,g=d?d.applyInverse(t,Cc):t;if(a.action==="fill")s=f.contains(g.x,g.y);else{const m=l;s=f.strokeContains(g.x,g.y,m.width,m.alignment)}const x=o.hole;if(x){const m=(i=x.shapePath)==null?void 0:i.shapePrimitives;if(m)for(let b=0;b<m.length;b++)m[b].shape.contains(g.x,g.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};si.defaultFillStyle={color:16777215,alpha:1,texture:nt.WHITE,matrix:null,fill:null,textureSpace:"local"};si.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:nt.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Rt=si;const dn=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Sc(r){const t=[];let e=0;for(let s=0;s<dn.length;s++){const i=`_${dn[s]}`;t[e++]=r[i]}return e=ka(r._fill,t,e),e=Ac(r._stroke,t,e),e=Tc(r.dropShadow,t,e),t.join("-")}function ka(r,t,e){var s;return r&&(t[e++]=r.color,t[e++]=r.alpha,t[e++]=(s=r.fill)==null?void 0:s.styleKey),e}function Ac(r,t,e){return r&&(e=ka(r,t,e),t[e++]=r.width,t[e++]=r.alignment,t[e++]=r.cap,t[e++]=r.join,t[e++]=r.miterLimit),e}function Tc(r,t,e){return r&&(t[e++]=r.alpha,t[e++]=r.angle,t[e++]=r.blur,t[e++]=r.distance,t[e++]=yt.shared.setValue(r.color).toNumber()),e}const ri=class Se extends Zt{constructor(t={}){super(),Mc(t);const e={...Se.defaultTextStyle,...t};for(const s in e){const i=s;this[i]=e[s]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Se.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Se.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Rt.defaultFillStyle,...t},()=>{this._fill=pe({...this._originalFill},Rt.defaultFillStyle)})),this._fill=pe(t===0?"black":t,Rt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Rt.defaultStrokeStyle,...t},()=>{this._stroke=Ps({...this._originalStroke},Rt.defaultStrokeStyle)})),this._stroke=Ps(t,Rt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Sc(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Se.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Se({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var s,i,n,a;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const o=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(s=this._fill)!=null&&s.texture&&this._fill.texture.destroy(o),(i=this._originalFill)!=null&&i.texture&&this._originalFill.texture.destroy(o),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(s,i,n)=>(s[i]=n,e==null||e(i,n),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(yt.isColorLike(t)||t instanceof ie||t instanceof Kr)}};ri.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};ri.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ke=ri;function Mc(r){const t=r;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Ke.defaultDropShadow;r.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){X(ct,"strokeThickness is now a part of stroke");const e=t.stroke;let s={};if(yt.isColorLike(e))s.color=e;else if(e instanceof ie||e instanceof Kr)s.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))s=e;else throw new Error("Invalid stroke value.");r.stroke={...s,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){X(ct,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;r.fontSize==null?r.fontSize=Ke.defaultTextStyle.fontSize:typeof r.fontSize=="string"?e=parseInt(r.fontSize,10):e=r.fontSize;const s=new ie({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),i=t.fillGradientStops.map(n=>yt.shared.setValue(n).toNumber());i.forEach((n,a)=>{const o=a/(i.length-1);s.addColorStop(o,n)}),r.fill={fill:s}}}const kc=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Pc(r){const t=typeof r.fontSize=="number"?`${r.fontSize}px`:r.fontSize;let e=r.fontFamily;Array.isArray(r.fontFamily)||(e=r.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let i=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!kc.includes(i)&&(i=`"${i}"`),e[s]=i}return`${r.fontStyle} ${r.fontVariant} ${r.fontWeight} ${t} ${e.join(",")}`}const xr={willReadFrequently:!0},Dt=class G{static get experimentalLetterSpacingSupported(){let t=G._experimentalLetterSpacingSupported;if(t!==void 0){const e=Ft.get().getCanvasRenderingContext2D().prototype;t=G._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,s,i,n,a,o,h,l){this.text=t,this.style=e,this.width=s,this.height=i,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,s=G._canvas,i=e.wordWrap){var v;const n=`${t}:${e.styleKey}`;if(G._measurementCache[n])return G._measurementCache[n];const a=Pc(e),o=G.measureFont(a);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const h=G.__context;h.font=a;const c=(i?G._wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let f=0;for(let w=0;w<c.length;w++){const A=G._measureText(c[w],e.letterSpacing,h);u[w]=A,f=Math.max(f,A)}const d=((v=e._stroke)==null?void 0:v.width)||0;let g=f+d;e.dropShadow&&(g+=e.dropShadow.distance);const x=e.lineHeight||o.fontSize;let m=Math.max(x,o.fontSize+d)+(c.length-1)*(x+e.leading);return e.dropShadow&&(m+=e.dropShadow.distance),new G(t,e,g,m,c,u,x+e.leading,f,o)}static _measureText(t,e,s){let i=!1;G.experimentalLetterSpacingSupported&&(G.experimentalLetterSpacing?(s.letterSpacing=`${e}px`,s.textLetterSpacing=`${e}px`,i=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const n=s.measureText(t);let a=n.width;const o=-n.actualBoundingBoxLeft;let l=n.actualBoundingBoxRight-o;if(a>0)if(i)a-=e,l-=e;else{const c=(G.graphemeSegmenter(t).length-1)*e;a+=c,l+=c}return Math.max(a,l)}static _wordWrap(t,e,s=G._canvas){const i=s.getContext("2d",xr);let n=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=G._collapseSpaces(c),f=G._collapseNewlines(c);let d=!u;const g=e.wordWrapWidth+l,x=G._tokenize(t);for(let m=0;m<x.length;m++){let b=x[m];if(G._isNewline(b)){if(!f){o+=G._addLine(a),d=!u,a="",n=0;continue}b=" "}if(u){const w=G.isBreakingSpace(b),A=G.isBreakingSpace(a[a.length-1]);if(w&&A)continue}const v=G._getFromCache(b,l,h,i);if(v>g)if(a!==""&&(o+=G._addLine(a),a="",n=0),G.canBreakWords(b,e.breakWords)){const w=G.wordWrapSplit(b);for(let A=0;A<w.length;A++){let R=w[A],k=R,P=1;for(;w[A+P];){const W=w[A+P];if(!G.canBreakChars(k,W,b,A,e.breakWords))R+=W;else break;k=W,P++}A+=P-1;const Z=G._getFromCache(R,l,h,i);Z+n>g&&(o+=G._addLine(a),d=!1,a="",n=0),a+=R,n+=Z}}else{a.length>0&&(o+=G._addLine(a),a="",n=0);const w=m===x.length-1;o+=G._addLine(b,!w),d=!1,a="",n=0}else v+n>g&&(d=!1,o+=G._addLine(a),a="",n=0),(a.length>0||!G.isBreakingSpace(b)||d)&&(a+=b,n+=v)}return o+=G._addLine(a,!1),o}static _addLine(t,e=!0){return t=G._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,s,i){let n=s[t];return typeof n!="number"&&(n=G._measureText(t,e,i)+e,s[t]=n),n}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const s=t[e];if(!G.isBreakingSpace(s))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:G._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:G._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let s="";if(typeof t!="string")return e;for(let i=0;i<t.length;i++){const n=t[i],a=t[i+1];if(G.isBreakingSpace(n,a)||G._isNewline(n)){s!==""&&(e.push(s),s=""),e.push(n);continue}s+=n}return s!==""&&e.push(s),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,i,n){return!0}static wordWrapSplit(t){return G.graphemeSegmenter(t)}static measureFont(t){if(G._fonts[t])return G._fonts[t];const e=G._context;e.font=t;const s=e.measureText(G.METRICS_STRING+G.BASELINE_SYMBOL),i={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return G._fonts[t]=i,i}static clearMetrics(t=""){t?delete G._fonts[t]:G._fonts={}}static get _canvas(){if(!G.__canvas){let t;try{const e=new OffscreenCanvas(0,0),s=e.getContext("2d",xr);if(s!=null&&s.measureText)return G.__canvas=e,e;t=Ft.get().createCanvas()}catch{t=Ft.get().createCanvas()}t.width=t.height=10,G.__canvas=t}return G.__canvas}static get _context(){return G.__context||(G.__context=G._canvas.getContext("2d",xr)),G.__context}};Dt.METRICS_STRING="|q";Dt.BASELINE_SYMBOL="M";Dt.BASELINE_MULTIPLIER=1.4;Dt.HEIGHT_MULTIPLIER=2;Dt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})();Dt.experimentalLetterSpacing=!1;Dt._fonts={};Dt._newlines=[10,13];Dt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Dt._measurementCache={};let Ic=Dt;var Rc=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Pa={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ec=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function Fc(r){const t=Pa[r],e=t.length;let s=Ec,i="";const n="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let a;for(let o=0;o<r;o++){let h=n.replace("%index%",o.toString());a=o,o>=e&&(a=r-o-1),h=h.replace("%value%",t[a].toString()),i+=h,i+=`
`}return s=s.replace("%blur%",i),s=s.replace("%size%",r.toString()),s}const Oc=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Bc(r,t){const e=Math.ceil(r/2);let s=Oc,i="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let a=0;a<r;a++){let o=n.replace("%index%",a.toString());o=o.replace("%sampleIndex%",`${a-(e-1)}.0`),i+=o,i+=`
`}return s=s.replace("%blur%",i),s=s.replace("%size%",r.toString()),s=s.replace("%dimension%",t?"z":"w"),s}function Nc(r,t){const e=Bc(t,r),s=Fc(t);return us.from({vertex:e,fragment:s,name:`blur-${r?"horizontal":"vertical"}-pass-filter`})}var Dc=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function Gc(r,t){const e=Pa[t],s=e.length,i=[],n=[],a=[];for(let u=0;u<t;u++){i[u]=`@location(${u}) offset${u}: vec2<f32>,`,r?n[u]=`filteredCord + vec2(${u-s+1} * pixelStrength, 0.0),`:n[u]=`filteredCord + vec2(0.0, ${u-s+1} * pixelStrength),`;const f=u<s?u:t-u-1,d=e[f].toString();a[u]=`finalColor += textureSample(uTexture, uSampler, offset${u}) * ${d};`}const o=i.join(`
`),h=n.join(`
`),l=a.join(`
`),c=Dc.replace("%blur-struct%",o).replace("%blur-vertex-out%",h).replace("%blur-fragment-in%",o).replace("%blur-sampling%",l).replace("%dimension%",r?"z":"w");return _e.from({vertex:{source:c,entryPoint:"mainVertex"},fragment:{source:c,entryPoint:"mainFragment"}})}const Ia=class Ra extends Xr{constructor(t){t={...Ra.defaultOptions,...t};const e=Nc(t.horizontal,t.kernelSize),s=Gc(t.horizontal,t.kernelSize);super({glProgram:e,gpuProgram:s,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...t}),this.horizontal=t.horizontal,this._quality=0,this.quality=t.quality,this.blur=t.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(t,e,s,i){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)t.applyFilter(this,e,s,i);else{const n=Ze.getSameSizeTexture(e);let a=e,o=n;this._state.blend=!1;const h=t.renderer.type===Ye.WEBGPU;for(let l=0;l<this.passes-1;l++){t.applyFilter(this,a,o,l===0?!0:h);const c=o;o=a,a=c}this._state.blend=!0,t.applyFilter(this,a,s,i),Ze.returnTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};Ia.defaultOptions={strength:8,quality:4,kernelSize:5};let _r=Ia;class ii extends Xr{constructor(...t){let e=t[0]??{};typeof e=="number"&&(X(ct,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),e={strength:e},t[1]!==void 0&&(e.quality=t[1]),t[2]!==void 0&&(e.resolution=t[2]||"inherit"),t[3]!==void 0&&(e.kernelSize=t[3])),e={..._r.defaultOptions,...e};const{strength:s,strengthX:i,strengthY:n,quality:a,...o}=e;super({...o,compatibleRenderers:Ye.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new _r({horizontal:!0,...e}),this.blurYFilter=new _r({horizontal:!1,...e}),this.quality=a,this.strengthX=i??s,this.strengthY=n??s,this.repeatEdgePixels=!1}apply(t,e,s,i){const n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(n&&a){const o=Ze.getSameSizeTexture(e);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(t,e,o,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,o,s,i),Ze.returnTexture(o)}else a?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,e,s,i)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(t,e,s,i))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get strengthX(){return this.blurXFilter.blur}set strengthX(t){this.blurXFilter.blur=t,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(t){this.blurYFilter.blur=t,this.updatePadding()}get blur(){return X("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(t){X("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=t}get blurX(){return X("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(t){X("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=t}get blurY(){return X("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(t){X("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}ii.defaultOptions={strength:8,quality:4,kernelSize:5};var zc=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uColorMatrix[20];
uniform float uAlpha;

uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * 0.2);
    float diff = (randomValue - 0.5) *  0.5;

    if (uAlpha == 0.0) {
        finalColor = color;
        return;
    }

    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    vec4 result;

    result.r = (uColorMatrix[0] * color.r);
        result.r += (uColorMatrix[1] * color.g);
        result.r += (uColorMatrix[2] * color.b);
        result.r += (uColorMatrix[3] * color.a);
        result.r += uColorMatrix[4];

    result.g = (uColorMatrix[5] * color.r);
        result.g += (uColorMatrix[6] * color.g);
        result.g += (uColorMatrix[7] * color.b);
        result.g += (uColorMatrix[8] * color.a);
        result.g += uColorMatrix[9];

    result.b = (uColorMatrix[10] * color.r);
       result.b += (uColorMatrix[11] * color.g);
       result.b += (uColorMatrix[12] * color.b);
       result.b += (uColorMatrix[13] * color.a);
       result.b += uColorMatrix[14];

    result.a = (uColorMatrix[15] * color.r);
       result.a += (uColorMatrix[16] * color.g);
       result.a += (uColorMatrix[17] * color.b);
       result.a += (uColorMatrix[18] * color.a);
       result.a += uColorMatrix[19];

    vec3 rgb = mix(color.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    finalColor = vec4(rgb, result.a);
}
`,fn=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct ColorMatrixUniforms {
  uColorMatrix:array<vec4<f32>, 5>,
  uAlpha:f32,
};


@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(1) @binding(0) var<uniform> colorMatrixUniforms : ColorMatrixUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
  };
  
fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
  );
}


@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
) -> @location(0) vec4<f32> {


  var c = textureSample(uTexture, uSampler, uv);
  
  if (colorMatrixUniforms.uAlpha == 0.0) {
    return c;
  }

 
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.r /= c.a;
      c.g /= c.a;
      c.b /= c.a;
    }

    var cm = colorMatrixUniforms.uColorMatrix;


    var result = vec4<f32>(0.);

    result.r = (cm[0][0] * c.r);
    result.r += (cm[0][1] * c.g);
    result.r += (cm[0][2] * c.b);
    result.r += (cm[0][3] * c.a);
    result.r += cm[1][0];

    result.g = (cm[1][1] * c.r);
    result.g += (cm[1][2] * c.g);
    result.g += (cm[1][3] * c.b);
    result.g += (cm[2][0] * c.a);
    result.g += cm[2][1];

    result.b = (cm[2][2] * c.r);
    result.b += (cm[2][3] * c.g);
    result.b += (cm[3][0] * c.b);
    result.b += (cm[3][1] * c.a);
    result.b += cm[3][2];

    result.a = (cm[3][3] * c.r);
    result.a += (cm[4][0] * c.g);
    result.a += (cm[4][1] * c.b);
    result.a += (cm[4][2] * c.a);
    result.a += cm[4][3];

    var rgb = mix(c.rgb, result.rgb, colorMatrixUniforms.uAlpha);

    rgb.r *= result.a;
    rgb.g *= result.a;
    rgb.b *= result.a;

    return vec4(rgb, result.a);
}`;class Lc extends Xr{constructor(t={}){const e=new Yr({uColorMatrix:{value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],type:"f32",size:20},uAlpha:{value:1,type:"f32"}}),s=_e.from({vertex:{source:fn,entryPoint:"mainVertex"},fragment:{source:fn,entryPoint:"mainFragment"}}),i=us.from({vertex:Rc,fragment:zc,name:"color-matrix-filter"});super({...t,gpuProgram:s,glProgram:i,resources:{colorMatrixUniforms:e}}),this.alpha=1}_loadMatrix(t,e=!1){let s=t;e&&(this._multiply(s,this.matrix,t),s=this._colorMatrix(s)),this.resources.colorMatrixUniforms.uniforms.uColorMatrix=s,this.resources.colorMatrixUniforms.update()}_multiply(t,e,s){return t[0]=e[0]*s[0]+e[1]*s[5]+e[2]*s[10]+e[3]*s[15],t[1]=e[0]*s[1]+e[1]*s[6]+e[2]*s[11]+e[3]*s[16],t[2]=e[0]*s[2]+e[1]*s[7]+e[2]*s[12]+e[3]*s[17],t[3]=e[0]*s[3]+e[1]*s[8]+e[2]*s[13]+e[3]*s[18],t[4]=e[0]*s[4]+e[1]*s[9]+e[2]*s[14]+e[3]*s[19]+e[4],t[5]=e[5]*s[0]+e[6]*s[5]+e[7]*s[10]+e[8]*s[15],t[6]=e[5]*s[1]+e[6]*s[6]+e[7]*s[11]+e[8]*s[16],t[7]=e[5]*s[2]+e[6]*s[7]+e[7]*s[12]+e[8]*s[17],t[8]=e[5]*s[3]+e[6]*s[8]+e[7]*s[13]+e[8]*s[18],t[9]=e[5]*s[4]+e[6]*s[9]+e[7]*s[14]+e[8]*s[19]+e[9],t[10]=e[10]*s[0]+e[11]*s[5]+e[12]*s[10]+e[13]*s[15],t[11]=e[10]*s[1]+e[11]*s[6]+e[12]*s[11]+e[13]*s[16],t[12]=e[10]*s[2]+e[11]*s[7]+e[12]*s[12]+e[13]*s[17],t[13]=e[10]*s[3]+e[11]*s[8]+e[12]*s[13]+e[13]*s[18],t[14]=e[10]*s[4]+e[11]*s[9]+e[12]*s[14]+e[13]*s[19]+e[14],t[15]=e[15]*s[0]+e[16]*s[5]+e[17]*s[10]+e[18]*s[15],t[16]=e[15]*s[1]+e[16]*s[6]+e[17]*s[11]+e[18]*s[16],t[17]=e[15]*s[2]+e[16]*s[7]+e[17]*s[12]+e[18]*s[17],t[18]=e[15]*s[3]+e[16]*s[8]+e[17]*s[13]+e[18]*s[18],t[19]=e[15]*s[4]+e[16]*s[9]+e[17]*s[14]+e[18]*s[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}tint(t,e){const[s,i,n]=yt.shared.setValue(t).toArray(),a=[s,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(a,e)}greyscale(t,e){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}grayscale(t,e){this.greyscale(t,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const s=Math.cos(t),i=Math.sin(t),n=Math.sqrt,a=1/3,o=n(a),h=s+(1-s)*a,l=a*(1-s)-o*i,c=a*(1-s)+o*i,u=a*(1-s)+o*i,f=s+a*(1-s),d=a*(1-s)-o*i,g=a*(1-s)-o*i,x=a*(1-s)+o*i,m=s+a*(1-s),b=[h,l,c,0,0,u,f,d,0,0,g,x,m,0,0,0,0,0,1,0];this._loadMatrix(b,e)}contrast(t,e){const s=(t||0)+1,i=-.5*(s-1),n=[s,0,0,0,i,0,s,0,0,i,0,0,s,0,i,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const s=t*2/3+1,i=(s-1)*-.5,n=[s,i,i,0,0,i,s,i,0,0,i,i,s,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,s,i,n){t||(t=.2),e||(e=.15),s||(s=16770432),i||(i=3375104);const a=yt.shared,[o,h,l]=a.setValue(s).toArray(),[c,u,f]=a.setValue(i).toArray(),d=[.3,.59,.11,0,0,o,h,l,t,0,c,u,f,e,0,o-c,h-u,l-f,0,0];this._loadMatrix(d,n)}night(t,e){t||(t=.1);const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,e)}predator(t,e){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.resources.colorMatrixUniforms.uniforms.uColorMatrix}set matrix(t){this.resources.colorMatrixUniforms.uniforms.uColorMatrix=t}get alpha(){return this.resources.colorMatrixUniforms.uniforms.uAlpha}set alpha(t){this.resources.colorMatrixUniforms.uniforms.uAlpha=t}}class $t extends Zr{constructor(t){t instanceof Rt&&(t={context:t});const{context:e,roundPixels:s,...i}=t||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Rt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new $t(this._context.clone()):(this._ownedContext=null,new $t(this._context))}lineStyle(t,e,s){X(ct,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return t&&(i.width=t),e&&(i.color=e),s&&(i.alpha=s),this.context.strokeStyle=i,this}beginFill(t,e){X(ct,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t!==void 0&&(s.color=t),e!==void 0&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){X(ct,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Rt.defaultStrokeStyle.width||t.color!==Rt.defaultStrokeStyle.color||t.alpha!==Rt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return X(ct,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return X(ct,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return X(ct,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return X(ct,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return X(ct,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return X(ct,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Vc extends Zr{constructor(t,e){const{text:s,resolution:i,style:n,anchor:a,width:o,height:h,roundPixels:l,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=s??"",this.style=n,this.resolution=i??null,this.allowChildren=!1,this._anchor=new wt({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=l??!1,o!==void 0&&(this.width=o),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,s=this.bounds.height,i=-e*this.anchor.x;let n=0;return t.x>=i&&t.x<=i+e&&(n=-s*this.anchor.y,t.y>=n&&t.y<=n+s)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function Uc(r,t){let e=r[0]??{};return(typeof e=="string"||r[1])&&(X(ct,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:r[1]}),e}class Ea extends Vc{constructor(...t){const e=Uc(t,"Text");super(e,Ke),this.renderPipeId="text"}updateBounds(){const t=this._bounds,e=this._anchor,s=Ic.measureText(this._text,this._style),{width:i,height:n}=s;t.minX=-e._x*i,t.maxX=t.minX+i,t.minY=-e._y*n,t.maxY=t.minY+n}}Pt.add(Xa,qa);var q;(function(r){r.assertEqual=i=>i;function t(i){}r.assertIs=t;function e(i){throw new Error}r.assertNever=e,r.arrayToEnum=i=>{const n={};for(const a of i)n[a]=a;return n},r.getValidEnumValues=i=>{const n=r.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of n)a[o]=i[o];return r.objectValues(a)},r.objectValues=i=>r.objectKeys(i).map(function(n){return i[n]}),r.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const n=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&n.push(a);return n},r.find=(i,n)=>{for(const a of i)if(n(a))return a},r.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function s(i,n=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(n)}r.joinValues=s,r.jsonStringifyReplacer=(i,n)=>typeof n=="bigint"?n.toString():n})(q||(q={}));var Gr;(function(r){r.mergeShapes=(t,e)=>({...t,...e})})(Gr||(Gr={}));const O=q.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qt=r=>{switch(typeof r){case"undefined":return O.undefined;case"string":return O.string;case"number":return isNaN(r)?O.nan:O.number;case"boolean":return O.boolean;case"function":return O.function;case"bigint":return O.bigint;case"symbol":return O.symbol;case"object":return Array.isArray(r)?O.array:r===null?O.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?O.promise:typeof Map<"u"&&r instanceof Map?O.map:typeof Set<"u"&&r instanceof Set?O.set:typeof Date<"u"&&r instanceof Date?O.date:O.object;default:return O.unknown}},I=q.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),$c=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Mt extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(n){return n.message},s={_errors:[]},i=n=>{for(const a of n.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)s._errors.push(e(a));else{let o=s,h=0;for(;h<a.path.length;){const l=a.path[h];h===a.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(a))):o[l]=o[l]||{_errors:[]},o=o[l],h++}}};return i(this),s}static assert(t){if(!(t instanceof Mt))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,q.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},s=[];for(const i of this.issues)i.path.length>0?(e[i.path[0]]=e[i.path[0]]||[],e[i.path[0]].push(t(i))):s.push(t(i));return{formErrors:s,fieldErrors:e}}get formErrors(){return this.flatten()}}Mt.create=r=>new Mt(r);const Re=(r,t)=>{let e;switch(r.code){case I.invalid_type:r.received===O.undefined?e="Required":e=`Expected ${r.expected}, received ${r.received}`;break;case I.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(r.expected,q.jsonStringifyReplacer)}`;break;case I.unrecognized_keys:e=`Unrecognized key(s) in object: ${q.joinValues(r.keys,", ")}`;break;case I.invalid_union:e="Invalid input";break;case I.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${q.joinValues(r.options)}`;break;case I.invalid_enum_value:e=`Invalid enum value. Expected ${q.joinValues(r.options)}, received '${r.received}'`;break;case I.invalid_arguments:e="Invalid function arguments";break;case I.invalid_return_type:e="Invalid function return type";break;case I.invalid_date:e="Invalid date";break;case I.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(e=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?e=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?e=`Invalid input: must end with "${r.validation.endsWith}"`:q.assertNever(r.validation):r.validation!=="regex"?e=`Invalid ${r.validation}`:e="Invalid";break;case I.too_small:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:e="Invalid input";break;case I.too_big:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?e=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:e="Invalid input";break;case I.custom:e="Invalid input";break;case I.invalid_intersection_types:e="Intersection results could not be merged";break;case I.not_multiple_of:e=`Number must be a multiple of ${r.multipleOf}`;break;case I.not_finite:e="Number must be finite";break;default:e=t.defaultError,q.assertNever(r)}return{message:e}};let Fa=Re;function Wc(r){Fa=r}function Is(){return Fa}const Rs=r=>{const{data:t,path:e,errorMaps:s,issueData:i}=r,n=[...e,...i.path||[]],a={...i,path:n};if(i.message!==void 0)return{...i,path:n,message:i.message};let o="";const h=s.filter(l=>!!l).slice().reverse();for(const l of h)o=l(a,{data:t,defaultError:o}).message;return{...i,path:n,message:o}},jc=[];function F(r,t){const e=Is(),s=Rs({issueData:t,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,e,e===Re?void 0:Re].filter(i=>!!i)});r.common.issues.push(s)}class _t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const s=[];for(const i of e){if(i.status==="aborted")return $;i.status==="dirty"&&t.dirty(),s.push(i.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,e){const s=[];for(const i of e){const n=await i.key,a=await i.value;s.push({key:n,value:a})}return _t.mergeObjectSync(t,s)}static mergeObjectSync(t,e){const s={};for(const i of e){const{key:n,value:a}=i;if(n.status==="aborted"||a.status==="aborted")return $;n.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),n.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(s[n.value]=a.value)}return{status:t.value,value:s}}}const $=Object.freeze({status:"aborted"}),Te=r=>({status:"dirty",value:r}),vt=r=>({status:"valid",value:r}),zr=r=>r.status==="aborted",Lr=r=>r.status==="dirty",ge=r=>r.status==="valid",Je=r=>typeof Promise<"u"&&r instanceof Promise;function Es(r,t,e,s){if(typeof t=="function"?r!==t||!0:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(r)}function Oa(r,t,e,s,i){if(typeof t=="function"?r!==t||!0:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(r,e),e}var N;(function(r){r.errToObj=t=>typeof t=="string"?{message:t}:t||{},r.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(N||(N={}));var Ve,Ue;class Wt{constructor(t,e,s,i){this._cachedPath=[],this.parent=t,this.data=e,this._path=s,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const pn=(r,t)=>{if(ge(t))return{success:!0,data:t.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new Mt(r.common.issues);return this._error=e,this._error}}};function j(r){if(!r)return{};const{errorMap:t,invalid_type_error:e,required_error:s,description:i}=r;if(t&&(e||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(a,o)=>{var h,l;const{message:c}=r;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(h=c??s)!==null&&h!==void 0?h:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(l=c??e)!==null&&l!==void 0?l:o.defaultError}},description:i}}class H{get description(){return this._def.description}_getType(t){return Qt(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:Qt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new _t,ctx:{common:t.parent.common,data:t.data,parsedType:Qt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(Je(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const s=this.safeParse(t,e);if(s.success)return s.data;throw s.error}safeParse(t,e){var s;const i={common:{issues:[],async:(s=e==null?void 0:e.async)!==null&&s!==void 0?s:!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qt(t)},n=this._parseSync({data:t,path:i.path,parent:i});return pn(i,n)}"~validate"(t){var e,s;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qt(t)};if(!this["~standard"].async)try{const n=this._parseSync({data:t,path:[],parent:i});return ge(n)?{value:n.value}:{issues:i.common.issues}}catch(n){!((s=(e=n==null?void 0:n.message)===null||e===void 0?void 0:e.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:i}).then(n=>ge(n)?{value:n.value}:{issues:i.common.issues})}async parseAsync(t,e){const s=await this.safeParseAsync(t,e);if(s.success)return s.data;throw s.error}async safeParseAsync(t,e){const s={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qt(t)},i=this._parse({data:t,path:s.path,parent:s}),n=await(Je(i)?i:Promise.resolve(i));return pn(s,n)}refine(t,e){const s=i=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(i):e;return this._refinement((i,n)=>{const a=t(i),o=()=>n.addIssue({code:I.custom,...s(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(h=>h?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,e){return this._refinement((s,i)=>t(s)?!0:(i.addIssue(typeof e=="function"?e(s,i):e),!1))}_refinement(t){return new Nt({schema:this,typeName:V.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Ut.create(this,this._def)}nullable(){return he.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ot.create(this)}promise(){return Fe.create(this,this._def)}or(t){return ss.create([this,t],this._def)}and(t){return rs.create(this,t,this._def)}transform(t){return new Nt({...j(this._def),schema:this,typeName:V.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new hs({...j(this._def),innerType:this,defaultValue:e,typeName:V.ZodDefault})}brand(){return new ni({typeName:V.ZodBranded,type:this,...j(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new ls({...j(this._def),innerType:this,catchValue:e,typeName:V.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return ds.create(this,t)}readonly(){return cs.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Zc=/^c[^\s-]{8,}$/i,Hc=/^[0-9a-z]+$/,Yc=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Xc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qc=/^[a-z0-9_-]{21}$/i,Kc=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Jc=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Qc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let br;const eu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,su=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ru=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,iu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,au=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ba="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ou=new RegExp(`^${Ba}$`);function Na(r){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?t=`${t}\\.\\d{${r.precision}}`:r.precision==null&&(t=`${t}(\\.\\d+)?`),t}function hu(r){return new RegExp(`^${Na(r)}$`)}function Da(r){let t=`${Ba}T${Na(r)}`;const e=[];return e.push(r.local?"Z?":"Z"),r.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function lu(r,t){return!!((t==="v4"||!t)&&eu.test(r)||(t==="v6"||!t)&&ru.test(r))}function cu(r,t){if(!Kc.test(r))return!1;try{const[e]=r.split("."),s=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||!i.typ||!i.alg||t&&i.alg!==t)}catch{return!1}}function uu(r,t){return!!((t==="v4"||!t)&&su.test(r)||(t==="v6"||!t)&&iu.test(r))}class Et extends H{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==O.string){const n=this._getOrReturnCtx(t);return F(n,{code:I.invalid_type,expected:O.string,received:n.parsedType}),$}const s=new _t;let i;for(const n of this._def.checks)if(n.kind==="min")t.data.length<n.value&&(i=this._getOrReturnCtx(t,i),F(i,{code:I.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="max")t.data.length>n.value&&(i=this._getOrReturnCtx(t,i),F(i,{code:I.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="length"){const a=t.data.length>n.value,o=t.data.length<n.value;(a||o)&&(i=this._getOrReturnCtx(t,i),a?F(i,{code:I.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&F(i,{code:I.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),s.dirty())}else if(n.kind==="email")Qc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"email",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="emoji")br||(br=new RegExp(tu,"u")),br.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"emoji",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="uuid")Xc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"uuid",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="nanoid")qc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"nanoid",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid")Zc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"cuid",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid2")Hc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"cuid2",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="ulid")Yc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"ulid",code:I.invalid_string,message:n.message}),s.dirty());else if(n.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),F(i,{validation:"url",code:I.invalid_string,message:n.message}),s.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"regex",code:I.invalid_string,message:n.message}),s.dirty())):n.kind==="trim"?t.data=t.data.trim():n.kind==="includes"?t.data.includes(n.value,n.position)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),s.dirty()):n.kind==="toLowerCase"?t.data=t.data.toLowerCase():n.kind==="toUpperCase"?t.data=t.data.toUpperCase():n.kind==="startsWith"?t.data.startsWith(n.value)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:{startsWith:n.value},message:n.message}),s.dirty()):n.kind==="endsWith"?t.data.endsWith(n.value)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:{endsWith:n.value},message:n.message}),s.dirty()):n.kind==="datetime"?Da(n).test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:"datetime",message:n.message}),s.dirty()):n.kind==="date"?ou.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:"date",message:n.message}),s.dirty()):n.kind==="time"?hu(n).test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{code:I.invalid_string,validation:"time",message:n.message}),s.dirty()):n.kind==="duration"?Jc.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"duration",code:I.invalid_string,message:n.message}),s.dirty()):n.kind==="ip"?lu(t.data,n.version)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"ip",code:I.invalid_string,message:n.message}),s.dirty()):n.kind==="jwt"?cu(t.data,n.alg)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"jwt",code:I.invalid_string,message:n.message}),s.dirty()):n.kind==="cidr"?uu(t.data,n.version)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"cidr",code:I.invalid_string,message:n.message}),s.dirty()):n.kind==="base64"?nu.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"base64",code:I.invalid_string,message:n.message}),s.dirty()):n.kind==="base64url"?au.test(t.data)||(i=this._getOrReturnCtx(t,i),F(i,{validation:"base64url",code:I.invalid_string,message:n.message}),s.dirty()):q.assertNever(n);return{status:s.value,value:t.data}}_regex(t,e,s){return this.refinement(i=>t.test(i),{validation:e,code:I.invalid_string,...N.errToObj(s)})}_addCheck(t){return new Et({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...N.errToObj(t)})}url(t){return this._addCheck({kind:"url",...N.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...N.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...N.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...N.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...N.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...N.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...N.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...N.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...N.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...N.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...N.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...N.errToObj(t)})}datetime(t){var e,s;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(e=t==null?void 0:t.offset)!==null&&e!==void 0?e:!1,local:(s=t==null?void 0:t.local)!==null&&s!==void 0?s:!1,...N.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...N.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...N.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...N.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e==null?void 0:e.position,...N.errToObj(e==null?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...N.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...N.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...N.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...N.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...N.errToObj(e)})}nonempty(t){return this.min(1,N.errToObj(t))}trim(){return new Et({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Et({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Et({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}Et.create=r=>{var t;return new Et({checks:[],typeName:V.ZodString,coerce:(t=r==null?void 0:r.coerce)!==null&&t!==void 0?t:!1,...j(r)})};function du(r,t){const e=(r.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,i=e>s?e:s,n=parseInt(r.toFixed(i).replace(".","")),a=parseInt(t.toFixed(i).replace(".",""));return n%a/Math.pow(10,i)}class ne extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==O.number){const n=this._getOrReturnCtx(t);return F(n,{code:I.invalid_type,expected:O.number,received:n.parsedType}),$}let s;const i=new _t;for(const n of this._def.checks)n.kind==="int"?q.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),F(s,{code:I.invalid_type,expected:"integer",received:"float",message:n.message}),i.dirty()):n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),i.dirty()):n.kind==="multipleOf"?du(t.data,n.value)!==0&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):n.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),F(s,{code:I.not_finite,message:n.message}),i.dirty()):q.assertNever(n);return{status:i.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,N.toString(e))}gt(t,e){return this.setLimit("min",t,!1,N.toString(e))}lte(t,e){return this.setLimit("max",t,!0,N.toString(e))}lt(t,e){return this.setLimit("max",t,!1,N.toString(e))}setLimit(t,e,s,i){return new ne({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:s,message:N.toString(i)}]})}_addCheck(t){return new ne({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:N.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:N.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:N.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:N.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:N.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:N.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:N.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:N.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:N.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&q.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(e===null||s.value>e)&&(e=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(e)&&Number.isFinite(t)}}ne.create=r=>new ne({checks:[],typeName:V.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...j(r)});class ae extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==O.bigint)return this._getInvalidInput(t);let s;const i=new _t;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),i.dirty()):n.kind==="multipleOf"?t.data%n.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),F(s,{code:I.not_multiple_of,multipleOf:n.value,message:n.message}),i.dirty()):q.assertNever(n);return{status:i.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return F(e,{code:I.invalid_type,expected:O.bigint,received:e.parsedType}),$}gte(t,e){return this.setLimit("min",t,!0,N.toString(e))}gt(t,e){return this.setLimit("min",t,!1,N.toString(e))}lte(t,e){return this.setLimit("max",t,!0,N.toString(e))}lt(t,e){return this.setLimit("max",t,!1,N.toString(e))}setLimit(t,e,s,i){return new ae({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:s,message:N.toString(i)}]})}_addCheck(t){return new ae({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:N.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:N.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:N.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:N.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:N.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}ae.create=r=>{var t;return new ae({checks:[],typeName:V.ZodBigInt,coerce:(t=r==null?void 0:r.coerce)!==null&&t!==void 0?t:!1,...j(r)})};class Qe extends H{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==O.boolean){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.boolean,received:s.parsedType}),$}return vt(t.data)}}Qe.create=r=>new Qe({typeName:V.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...j(r)});class ye extends H{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==O.date){const n=this._getOrReturnCtx(t);return F(n,{code:I.invalid_type,expected:O.date,received:n.parsedType}),$}if(isNaN(t.data.getTime())){const n=this._getOrReturnCtx(t);return F(n,{code:I.invalid_date}),$}const s=new _t;let i;for(const n of this._def.checks)n.kind==="min"?t.data.getTime()<n.value&&(i=this._getOrReturnCtx(t,i),F(i,{code:I.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),s.dirty()):n.kind==="max"?t.data.getTime()>n.value&&(i=this._getOrReturnCtx(t,i),F(i,{code:I.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),s.dirty()):q.assertNever(n);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ye({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:N.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:N.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}ye.create=r=>new ye({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:V.ZodDate,...j(r)});class Fs extends H{_parse(t){if(this._getType(t)!==O.symbol){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.symbol,received:s.parsedType}),$}return vt(t.data)}}Fs.create=r=>new Fs({typeName:V.ZodSymbol,...j(r)});class ts extends H{_parse(t){if(this._getType(t)!==O.undefined){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.undefined,received:s.parsedType}),$}return vt(t.data)}}ts.create=r=>new ts({typeName:V.ZodUndefined,...j(r)});class es extends H{_parse(t){if(this._getType(t)!==O.null){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.null,received:s.parsedType}),$}return vt(t.data)}}es.create=r=>new es({typeName:V.ZodNull,...j(r)});class Ee extends H{constructor(){super(...arguments),this._any=!0}_parse(t){return vt(t.data)}}Ee.create=r=>new Ee({typeName:V.ZodAny,...j(r)});class me extends H{constructor(){super(...arguments),this._unknown=!0}_parse(t){return vt(t.data)}}me.create=r=>new me({typeName:V.ZodUnknown,...j(r)});class se extends H{_parse(t){const e=this._getOrReturnCtx(t);return F(e,{code:I.invalid_type,expected:O.never,received:e.parsedType}),$}}se.create=r=>new se({typeName:V.ZodNever,...j(r)});class Os extends H{_parse(t){if(this._getType(t)!==O.undefined){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.void,received:s.parsedType}),$}return vt(t.data)}}Os.create=r=>new Os({typeName:V.ZodVoid,...j(r)});class Ot extends H{_parse(t){const{ctx:e,status:s}=this._processInputParams(t),i=this._def;if(e.parsedType!==O.array)return F(e,{code:I.invalid_type,expected:O.array,received:e.parsedType}),$;if(i.exactLength!==null){const a=e.data.length>i.exactLength.value,o=e.data.length<i.exactLength.value;(a||o)&&(F(e,{code:a?I.too_big:I.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&e.data.length<i.minLength.value&&(F(e,{code:I.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&e.data.length>i.maxLength.value&&(F(e,{code:I.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),e.common.async)return Promise.all([...e.data].map((a,o)=>i.type._parseAsync(new Wt(e,a,e.path,o)))).then(a=>_t.mergeArray(s,a));const n=[...e.data].map((a,o)=>i.type._parseSync(new Wt(e,a,e.path,o)));return _t.mergeArray(s,n)}get element(){return this._def.type}min(t,e){return new Ot({...this._def,minLength:{value:t,message:N.toString(e)}})}max(t,e){return new Ot({...this._def,maxLength:{value:t,message:N.toString(e)}})}length(t,e){return new Ot({...this._def,exactLength:{value:t,message:N.toString(e)}})}nonempty(t){return this.min(1,t)}}Ot.create=(r,t)=>new Ot({type:r,minLength:null,maxLength:null,exactLength:null,typeName:V.ZodArray,...j(t)});function Ae(r){if(r instanceof lt){const t={};for(const e in r.shape){const s=r.shape[e];t[e]=Ut.create(Ae(s))}return new lt({...r._def,shape:()=>t})}else return r instanceof Ot?new Ot({...r._def,type:Ae(r.element)}):r instanceof Ut?Ut.create(Ae(r.unwrap())):r instanceof he?he.create(Ae(r.unwrap())):r instanceof jt?jt.create(r.items.map(t=>Ae(t))):r}class lt extends H{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=q.objectKeys(t);return this._cached={shape:t,keys:e}}_parse(t){if(this._getType(t)!==O.object){const l=this._getOrReturnCtx(t);return F(l,{code:I.invalid_type,expected:O.object,received:l.parsedType}),$}const{status:s,ctx:i}=this._processInputParams(t),{shape:n,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof se&&this._def.unknownKeys==="strip"))for(const l in i.data)a.includes(l)||o.push(l);const h=[];for(const l of a){const c=n[l],u=i.data[l];h.push({key:{status:"valid",value:l},value:c._parse(new Wt(i,u,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof se){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of o)h.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(l==="strict")o.length>0&&(F(i,{code:I.unrecognized_keys,keys:o}),s.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of o){const u=i.data[c];h.push({key:{status:"valid",value:c},value:l._parse(new Wt(i,u,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of h){const u=await c.key,f=await c.value;l.push({key:u,value:f,alwaysSet:c.alwaysSet})}return l}).then(l=>_t.mergeObjectSync(s,l)):_t.mergeObjectSync(s,h)}get shape(){return this._def.shape()}strict(t){return N.errToObj,new lt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,s)=>{var i,n,a,o;const h=(a=(n=(i=this._def).errorMap)===null||n===void 0?void 0:n.call(i,e,s).message)!==null&&a!==void 0?a:s.defaultError;return e.code==="unrecognized_keys"?{message:(o=N.errToObj(t).message)!==null&&o!==void 0?o:h}:{message:h}}}:{}})}strip(){return new lt({...this._def,unknownKeys:"strip"})}passthrough(){return new lt({...this._def,unknownKeys:"passthrough"})}extend(t){return new lt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new lt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:V.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new lt({...this._def,catchall:t})}pick(t){const e={};return q.objectKeys(t).forEach(s=>{t[s]&&this.shape[s]&&(e[s]=this.shape[s])}),new lt({...this._def,shape:()=>e})}omit(t){const e={};return q.objectKeys(this.shape).forEach(s=>{t[s]||(e[s]=this.shape[s])}),new lt({...this._def,shape:()=>e})}deepPartial(){return Ae(this)}partial(t){const e={};return q.objectKeys(this.shape).forEach(s=>{const i=this.shape[s];t&&!t[s]?e[s]=i:e[s]=i.optional()}),new lt({...this._def,shape:()=>e})}required(t){const e={};return q.objectKeys(this.shape).forEach(s=>{if(t&&!t[s])e[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Ut;)n=n._def.innerType;e[s]=n}}),new lt({...this._def,shape:()=>e})}keyof(){return Ga(q.objectKeys(this.shape))}}lt.create=(r,t)=>new lt({shape:()=>r,unknownKeys:"strip",catchall:se.create(),typeName:V.ZodObject,...j(t)});lt.strictCreate=(r,t)=>new lt({shape:()=>r,unknownKeys:"strict",catchall:se.create(),typeName:V.ZodObject,...j(t)});lt.lazycreate=(r,t)=>new lt({shape:r,unknownKeys:"strip",catchall:se.create(),typeName:V.ZodObject,...j(t)});class ss extends H{_parse(t){const{ctx:e}=this._processInputParams(t),s=this._def.options;function i(n){for(const o of n)if(o.result.status==="valid")return o.result;for(const o of n)if(o.result.status==="dirty")return e.common.issues.push(...o.ctx.common.issues),o.result;const a=n.map(o=>new Mt(o.ctx.common.issues));return F(e,{code:I.invalid_union,unionErrors:a}),$}if(e.common.async)return Promise.all(s.map(async n=>{const a={...e,common:{...e.common,issues:[]},parent:null};return{result:await n._parseAsync({data:e.data,path:e.path,parent:a}),ctx:a}})).then(i);{let n;const a=[];for(const h of s){const l={...e,common:{...e.common,issues:[]},parent:null},c=h._parseSync({data:e.data,path:e.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!n&&(n={result:c,ctx:l}),l.common.issues.length&&a.push(l.common.issues)}if(n)return e.common.issues.push(...n.ctx.common.issues),n.result;const o=a.map(h=>new Mt(h));return F(e,{code:I.invalid_union,unionErrors:o}),$}}get options(){return this._def.options}}ss.create=(r,t)=>new ss({options:r,typeName:V.ZodUnion,...j(t)});const Jt=r=>r instanceof ns?Jt(r.schema):r instanceof Nt?Jt(r.innerType()):r instanceof as?[r.value]:r instanceof oe?r.options:r instanceof os?q.objectValues(r.enum):r instanceof hs?Jt(r._def.innerType):r instanceof ts?[void 0]:r instanceof es?[null]:r instanceof Ut?[void 0,...Jt(r.unwrap())]:r instanceof he?[null,...Jt(r.unwrap())]:r instanceof ni||r instanceof cs?Jt(r.unwrap()):r instanceof ls?Jt(r._def.innerType):[];class Ls extends H{_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==O.object)return F(e,{code:I.invalid_type,expected:O.object,received:e.parsedType}),$;const s=this.discriminator,i=e.data[s],n=this.optionsMap.get(i);return n?e.common.async?n._parseAsync({data:e.data,path:e.path,parent:e}):n._parseSync({data:e.data,path:e.path,parent:e}):(F(e,{code:I.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),$)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,e,s){const i=new Map;for(const n of e){const a=Jt(n.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);i.set(o,n)}}return new Ls({typeName:V.ZodDiscriminatedUnion,discriminator:t,options:e,optionsMap:i,...j(s)})}}function Vr(r,t){const e=Qt(r),s=Qt(t);if(r===t)return{valid:!0,data:r};if(e===O.object&&s===O.object){const i=q.objectKeys(t),n=q.objectKeys(r).filter(o=>i.indexOf(o)!==-1),a={...r,...t};for(const o of n){const h=Vr(r[o],t[o]);if(!h.valid)return{valid:!1};a[o]=h.data}return{valid:!0,data:a}}else if(e===O.array&&s===O.array){if(r.length!==t.length)return{valid:!1};const i=[];for(let n=0;n<r.length;n++){const a=r[n],o=t[n],h=Vr(a,o);if(!h.valid)return{valid:!1};i.push(h.data)}return{valid:!0,data:i}}else return e===O.date&&s===O.date&&+r==+t?{valid:!0,data:r}:{valid:!1}}class rs extends H{_parse(t){const{status:e,ctx:s}=this._processInputParams(t),i=(n,a)=>{if(zr(n)||zr(a))return $;const o=Vr(n.value,a.value);return o.valid?((Lr(n)||Lr(a))&&e.dirty(),{status:e.value,value:o.data}):(F(s,{code:I.invalid_intersection_types}),$)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([n,a])=>i(n,a)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}rs.create=(r,t,e)=>new rs({left:r,right:t,typeName:V.ZodIntersection,...j(e)});class jt extends H{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==O.array)return F(s,{code:I.invalid_type,expected:O.array,received:s.parsedType}),$;if(s.data.length<this._def.items.length)return F(s,{code:I.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),$;!this._def.rest&&s.data.length>this._def.items.length&&(F(s,{code:I.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const n=[...s.data].map((a,o)=>{const h=this._def.items[o]||this._def.rest;return h?h._parse(new Wt(s,a,s.path,o)):null}).filter(a=>!!a);return s.common.async?Promise.all(n).then(a=>_t.mergeArray(e,a)):_t.mergeArray(e,n)}get items(){return this._def.items}rest(t){return new jt({...this._def,rest:t})}}jt.create=(r,t)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new jt({items:r,typeName:V.ZodTuple,rest:null,...j(t)})};class is extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==O.object)return F(s,{code:I.invalid_type,expected:O.object,received:s.parsedType}),$;const i=[],n=this._def.keyType,a=this._def.valueType;for(const o in s.data)i.push({key:n._parse(new Wt(s,o,s.path,o)),value:a._parse(new Wt(s,s.data[o],s.path,o)),alwaysSet:o in s.data});return s.common.async?_t.mergeObjectAsync(e,i):_t.mergeObjectSync(e,i)}get element(){return this._def.valueType}static create(t,e,s){return e instanceof H?new is({keyType:t,valueType:e,typeName:V.ZodRecord,...j(s)}):new is({keyType:Et.create(),valueType:t,typeName:V.ZodRecord,...j(e)})}}class Bs extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==O.map)return F(s,{code:I.invalid_type,expected:O.map,received:s.parsedType}),$;const i=this._def.keyType,n=this._def.valueType,a=[...s.data.entries()].map(([o,h],l)=>({key:i._parse(new Wt(s,o,s.path,[l,"key"])),value:n._parse(new Wt(s,h,s.path,[l,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const h of a){const l=await h.key,c=await h.value;if(l.status==="aborted"||c.status==="aborted")return $;(l.status==="dirty"||c.status==="dirty")&&e.dirty(),o.set(l.value,c.value)}return{status:e.value,value:o}})}else{const o=new Map;for(const h of a){const l=h.key,c=h.value;if(l.status==="aborted"||c.status==="aborted")return $;(l.status==="dirty"||c.status==="dirty")&&e.dirty(),o.set(l.value,c.value)}return{status:e.value,value:o}}}}Bs.create=(r,t,e)=>new Bs({valueType:t,keyType:r,typeName:V.ZodMap,...j(e)});class xe extends H{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==O.set)return F(s,{code:I.invalid_type,expected:O.set,received:s.parsedType}),$;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(F(s,{code:I.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),e.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(F(s,{code:I.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),e.dirty());const n=this._def.valueType;function a(h){const l=new Set;for(const c of h){if(c.status==="aborted")return $;c.status==="dirty"&&e.dirty(),l.add(c.value)}return{status:e.value,value:l}}const o=[...s.data.values()].map((h,l)=>n._parse(new Wt(s,h,s.path,l)));return s.common.async?Promise.all(o).then(h=>a(h)):a(o)}min(t,e){return new xe({...this._def,minSize:{value:t,message:N.toString(e)}})}max(t,e){return new xe({...this._def,maxSize:{value:t,message:N.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}xe.create=(r,t)=>new xe({valueType:r,minSize:null,maxSize:null,typeName:V.ZodSet,...j(t)});class Me extends H{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==O.function)return F(e,{code:I.invalid_type,expected:O.function,received:e.parsedType}),$;function s(o,h){return Rs({data:o,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,Is(),Re].filter(l=>!!l),issueData:{code:I.invalid_arguments,argumentsError:h}})}function i(o,h){return Rs({data:o,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,Is(),Re].filter(l=>!!l),issueData:{code:I.invalid_return_type,returnTypeError:h}})}const n={errorMap:e.common.contextualErrorMap},a=e.data;if(this._def.returns instanceof Fe){const o=this;return vt(async function(...h){const l=new Mt([]),c=await o._def.args.parseAsync(h,n).catch(d=>{throw l.addIssue(s(h,d)),l}),u=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(u,n).catch(d=>{throw l.addIssue(i(u,d)),l})})}else{const o=this;return vt(function(...h){const l=o._def.args.safeParse(h,n);if(!l.success)throw new Mt([s(h,l.error)]);const c=Reflect.apply(a,this,l.data),u=o._def.returns.safeParse(c,n);if(!u.success)throw new Mt([i(c,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Me({...this._def,args:jt.create(t).rest(me.create())})}returns(t){return new Me({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,e,s){return new Me({args:t||jt.create([]).rest(me.create()),returns:e||me.create(),typeName:V.ZodFunction,...j(s)})}}class ns extends H{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}ns.create=(r,t)=>new ns({getter:r,typeName:V.ZodLazy,...j(t)});class as extends H{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return F(e,{received:e.data,code:I.invalid_literal,expected:this._def.value}),$}return{status:"valid",value:t.data}}get value(){return this._def.value}}as.create=(r,t)=>new as({value:r,typeName:V.ZodLiteral,...j(t)});function Ga(r,t){return new oe({values:r,typeName:V.ZodEnum,...j(t)})}class oe extends H{constructor(){super(...arguments),Ve.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),s=this._def.values;return F(e,{expected:q.joinValues(s),received:e.parsedType,code:I.invalid_type}),$}if(Es(this,Ve)||Oa(this,Ve,new Set(this._def.values)),!Es(this,Ve).has(t.data)){const e=this._getOrReturnCtx(t),s=this._def.values;return F(e,{received:e.data,code:I.invalid_enum_value,options:s}),$}return vt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return oe.create(t,{...this._def,...e})}exclude(t,e=this._def){return oe.create(this.options.filter(s=>!t.includes(s)),{...this._def,...e})}}Ve=new WeakMap;oe.create=Ga;class os extends H{constructor(){super(...arguments),Ue.set(this,void 0)}_parse(t){const e=q.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==O.string&&s.parsedType!==O.number){const i=q.objectValues(e);return F(s,{expected:q.joinValues(i),received:s.parsedType,code:I.invalid_type}),$}if(Es(this,Ue)||Oa(this,Ue,new Set(q.getValidEnumValues(this._def.values))),!Es(this,Ue).has(t.data)){const i=q.objectValues(e);return F(s,{received:s.data,code:I.invalid_enum_value,options:i}),$}return vt(t.data)}get enum(){return this._def.values}}Ue=new WeakMap;os.create=(r,t)=>new os({values:r,typeName:V.ZodNativeEnum,...j(t)});class Fe extends H{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==O.promise&&e.common.async===!1)return F(e,{code:I.invalid_type,expected:O.promise,received:e.parsedType}),$;const s=e.parsedType===O.promise?e.data:Promise.resolve(e.data);return vt(s.then(i=>this._def.type.parseAsync(i,{path:e.path,errorMap:e.common.contextualErrorMap})))}}Fe.create=(r,t)=>new Fe({type:r,typeName:V.ZodPromise,...j(t)});class Nt extends H{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===V.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:s}=this._processInputParams(t),i=this._def.effect||null,n={addIssue:a=>{F(s,a),a.fatal?e.abort():e.dirty()},get path(){return s.path}};if(n.addIssue=n.addIssue.bind(n),i.type==="preprocess"){const a=i.transform(s.data,n);if(s.common.async)return Promise.resolve(a).then(async o=>{if(e.value==="aborted")return $;const h=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return h.status==="aborted"?$:h.status==="dirty"||e.value==="dirty"?Te(h.value):h});{if(e.value==="aborted")return $;const o=this._def.schema._parseSync({data:a,path:s.path,parent:s});return o.status==="aborted"?$:o.status==="dirty"||e.value==="dirty"?Te(o.value):o}}if(i.type==="refinement"){const a=o=>{const h=i.refinement(o,n);if(s.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?$:(o.status==="dirty"&&e.dirty(),a(o.value),{status:e.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?$:(o.status==="dirty"&&e.dirty(),a(o.value).then(()=>({status:e.value,value:o.value}))))}if(i.type==="transform")if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!ge(a))return a;const o=i.transform(a.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>ge(a)?Promise.resolve(i.transform(a.value,n)).then(o=>({status:e.value,value:o})):a);q.assertNever(i)}}Nt.create=(r,t,e)=>new Nt({schema:r,typeName:V.ZodEffects,effect:t,...j(e)});Nt.createWithPreprocess=(r,t,e)=>new Nt({schema:t,effect:{type:"preprocess",transform:r},typeName:V.ZodEffects,...j(e)});class Ut extends H{_parse(t){return this._getType(t)===O.undefined?vt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ut.create=(r,t)=>new Ut({innerType:r,typeName:V.ZodOptional,...j(t)});class he extends H{_parse(t){return this._getType(t)===O.null?vt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}he.create=(r,t)=>new he({innerType:r,typeName:V.ZodNullable,...j(t)});class hs extends H{_parse(t){const{ctx:e}=this._processInputParams(t);let s=e.data;return e.parsedType===O.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}hs.create=(r,t)=>new hs({innerType:r,typeName:V.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...j(t)});class ls extends H{_parse(t){const{ctx:e}=this._processInputParams(t),s={...e,common:{...e.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Je(i)?i.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Mt(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Mt(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}ls.create=(r,t)=>new ls({innerType:r,typeName:V.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...j(t)});class Ns extends H{_parse(t){if(this._getType(t)!==O.nan){const s=this._getOrReturnCtx(t);return F(s,{code:I.invalid_type,expected:O.nan,received:s.parsedType}),$}return{status:"valid",value:t.data}}}Ns.create=r=>new Ns({typeName:V.ZodNaN,...j(r)});const fu=Symbol("zod_brand");class ni extends H{_parse(t){const{ctx:e}=this._processInputParams(t),s=e.data;return this._def.type._parse({data:s,path:e.path,parent:e})}unwrap(){return this._def.type}}class ds extends H{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?$:n.status==="dirty"?(e.dirty(),Te(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?$:i.status==="dirty"?(e.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(t,e){return new ds({in:t,out:e,typeName:V.ZodPipeline})}}class cs extends H{_parse(t){const e=this._def.innerType._parse(t),s=i=>(ge(i)&&(i.value=Object.freeze(i.value)),i);return Je(e)?e.then(i=>s(i)):s(e)}unwrap(){return this._def.innerType}}cs.create=(r,t)=>new cs({innerType:r,typeName:V.ZodReadonly,...j(t)});function mn(r,t){const e=typeof r=="function"?r(t):typeof r=="string"?{message:r}:r;return typeof e=="string"?{message:e}:e}function za(r,t={},e){return r?Ee.create().superRefine((s,i)=>{var n,a;const o=r(s);if(o instanceof Promise)return o.then(h=>{var l,c;if(!h){const u=mn(t,s),f=(c=(l=u.fatal)!==null&&l!==void 0?l:e)!==null&&c!==void 0?c:!0;i.addIssue({code:"custom",...u,fatal:f})}});if(!o){const h=mn(t,s),l=(a=(n=h.fatal)!==null&&n!==void 0?n:e)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...h,fatal:l})}}):Ee.create()}const pu={object:lt.lazycreate};var V;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(V||(V={}));const mu=(r,t={message:`Input not instance of ${r.name}`})=>za(e=>e instanceof r,t),La=Et.create,Va=ne.create,gu=Ns.create,yu=ae.create,Ua=Qe.create,xu=ye.create,_u=Fs.create,bu=ts.create,vu=es.create,wu=Ee.create,Cu=me.create,Su=se.create,Au=Os.create,Tu=Ot.create,Mu=lt.create,ku=lt.strictCreate,Pu=ss.create,Iu=Ls.create,Ru=rs.create,Eu=jt.create,Fu=is.create,Ou=Bs.create,Bu=xe.create,Nu=Me.create,Du=ns.create,Gu=as.create,zu=oe.create,Lu=os.create,Vu=Fe.create,gn=Nt.create,Uu=Ut.create,$u=he.create,Wu=Nt.createWithPreprocess,ju=ds.create,Zu=()=>La().optional(),Hu=()=>Va().optional(),Yu=()=>Ua().optional(),Xu={string:r=>Et.create({...r,coerce:!0}),number:r=>ne.create({...r,coerce:!0}),boolean:r=>Qe.create({...r,coerce:!0}),bigint:r=>ae.create({...r,coerce:!0}),date:r=>ye.create({...r,coerce:!0})},qu=$;var ot=Object.freeze({__proto__:null,defaultErrorMap:Re,setErrorMap:Wc,getErrorMap:Is,makeIssue:Rs,EMPTY_PATH:jc,addIssueToContext:F,ParseStatus:_t,INVALID:$,DIRTY:Te,OK:vt,isAborted:zr,isDirty:Lr,isValid:ge,isAsync:Je,get util(){return q},get objectUtil(){return Gr},ZodParsedType:O,getParsedType:Qt,ZodType:H,datetimeRegex:Da,ZodString:Et,ZodNumber:ne,ZodBigInt:ae,ZodBoolean:Qe,ZodDate:ye,ZodSymbol:Fs,ZodUndefined:ts,ZodNull:es,ZodAny:Ee,ZodUnknown:me,ZodNever:se,ZodVoid:Os,ZodArray:Ot,ZodObject:lt,ZodUnion:ss,ZodDiscriminatedUnion:Ls,ZodIntersection:rs,ZodTuple:jt,ZodRecord:is,ZodMap:Bs,ZodSet:xe,ZodFunction:Me,ZodLazy:ns,ZodLiteral:as,ZodEnum:oe,ZodNativeEnum:os,ZodPromise:Fe,ZodEffects:Nt,ZodTransformer:Nt,ZodOptional:Ut,ZodNullable:he,ZodDefault:hs,ZodCatch:ls,ZodNaN:Ns,BRAND:fu,ZodBranded:ni,ZodPipeline:ds,ZodReadonly:cs,custom:za,Schema:H,ZodSchema:H,late:pu,get ZodFirstPartyTypeKind(){return V},coerce:Xu,any:wu,array:Tu,bigint:yu,boolean:Ua,date:xu,discriminatedUnion:Iu,effect:gn,enum:zu,function:Nu,instanceof:mu,intersection:Ru,lazy:Du,literal:Gu,map:Ou,nan:gu,nativeEnum:Lu,never:Su,null:vu,nullable:$u,number:Va,object:Mu,oboolean:Yu,onumber:Hu,optional:Uu,ostring:Zu,pipeline:ju,preprocess:Wu,promise:Vu,record:Fu,set:Bu,strictObject:ku,string:La,symbol:_u,transformer:gn,tuple:Eu,undefined:bu,union:Pu,unknown:Cu,void:Au,NEVER:qu,ZodIssueCode:I,quotelessJson:$c,ZodError:Mt});class Ku{constructor(){L(this,"internalData",[]);L(this,"fakeAccounts",[{Id:"ACC-10001",name:"Global Concepts Ltd",type:"Account",createdDate:"2022-03-15T14:30:45.123Z",industry:"Technology",numberOfEmployees:1250,annualRevenue:25e6,website:"https://www.globalconcepts.com",phone:"(415) 555-1234"},{Id:"ACC-10016",name:"Oxford Manuscript Restoration",type:"Account",createdDate:"2022-02-09T09:22:45.624Z",industry:"Arts & Culture",numberOfEmployees:42,annualRevenue:31e5,website:"https://www.oxfordmanuscripts.com",phone:"(617) 555-9012"},{Id:"ACC-10017",name:"Canterbury Heritage Foundation",type:"Account",createdDate:"2021-09-17T11:33:18.953Z",industry:"Non-Profit",numberOfEmployees:68,annualRevenue:28e5,website:"https://www.canterburyheritage.org",phone:"(508) 555-3456"},{Id:"ACC-10002",name:"Primary and Secondary Healthcare",type:"Account",createdDate:"2021-11-08T09:15:22.456Z",industry:"Healthcare",numberOfEmployees:3500,annualRevenue:75e6,website:"https://www.pshealth.com",phone:"(310) 555-2345"},{Id:"ACC-10003",name:"RF Goldman Holdings",type:"Account",createdDate:"2022-01-22T11:45:10.789Z",industry:"Financial Services",numberOfEmployees:850,annualRevenue:15e6,website:"https://www.rfgoldman.com",phone:"(212) 555-3456"},{Id:"ACC-10004",name:"Amalgamated Fluorodynamics",type:"Account",createdDate:"2021-08-17T16:20:30.321Z",industry:"Manufacturing",numberOfEmployees:2200,annualRevenue:45e6,website:"https://www.amalgamatedfluoro.com",phone:"(713) 555-4567"},{Id:"ACC-10005",name:"Lineamatic",type:"Account",createdDate:"2022-05-03T10:05:15.654Z",industry:"Retail",numberOfEmployees:750,annualRevenue:12e6,website:"https://www.lineamatic.com",phone:"(312) 555-5678"},{Id:"ACC-10006",name:"National Endowment Service",type:"Account",createdDate:"2021-10-11T13:40:55.987Z",industry:"Education",numberOfEmployees:580,annualRevenue:85e5,website:"https://www.nationalendowment.com",phone:"(617) 555-6789"},{Id:"ACC-10007",name:"Petrolair",type:"Account",createdDate:"2022-02-28T15:55:25.741Z",industry:"Energy",numberOfEmployees:1800,annualRevenue:65e6,website:"https://www.petrolair.com",phone:"(713) 555-7890"},{Id:"ACC-10008",name:"Cambridge Historical Preservation Society",type:"Account",createdDate:"2021-07-16T11:30:20.365Z",industry:"Non-Profit",numberOfEmployees:120,annualRevenue:35e5,website:"https://www.cambridgehistorical.org",phone:"(617) 555-8901"},{Id:"ACC-10009",name:"Peninsular Technologies",type:"Account",createdDate:"2022-04-05T09:25:35.482Z",industry:"Technology",numberOfEmployees:950,annualRevenue:22e6,website:"https://www.peninsulartech.com",phone:"(650) 555-9012"},{Id:"ACC-10010",name:"Covenant Trust Banking",type:"Account",createdDate:"2021-09-22T13:50:40.159Z",industry:"Financial Services",numberOfEmployees:1450,annualRevenue:38e6,website:"https://www.covenanttrust.com",phone:"(212) 555-0123"},{Id:"ACC-10011",name:"Ironclad Manufacturing",type:"Account",createdDate:"2022-01-30T10:15:55.753Z",industry:"Manufacturing",numberOfEmployees:1850,annualRevenue:42e6,website:"https://www.ironcladmfg.com",phone:"(412) 555-1234"},{Id:"ACC-10012",name:"Meridian Healthcare Systems",type:"Account",createdDate:"2021-12-14T14:40:30.628Z",industry:"Healthcare",numberOfEmployees:2750,annualRevenue:58e6,website:"https://www.meridianhealthcare.com",phone:"(305) 555-2345"},{Id:"ACC-10013",name:"Commonwealth Publishing House",type:"Account",createdDate:"2022-02-19T09:35:25.147Z",industry:"Media",numberOfEmployees:475,annualRevenue:92e5,website:"https://www.commonwealthpublishing.com",phone:"(617) 555-3456"}]);L(this,"fakeContacts",[{Id:"CON-10001",accountId:"ACC-10001",type:"Contact",name:"Michael Williams",firstName:"Michael",lastName:"Williams",email:"michael.williams@globalconcepts.com",createdDate:"2022-03-20T09:10:25.123Z",phone:"(415) 555-1001",title:"CTO"},{Id:"CON-10040",accountId:"ACC-10016",type:"Contact",name:"Beatrice Wordsworth",firstName:"Beatrice",lastName:"Wordsworth",email:"beatrice.wordsworth@oxfordmanuscripts.com",createdDate:"2022-02-10T10:12:45.843Z",phone:"(617) 555-9101",title:"Head Conservator"},{Id:"CON-10041",accountId:"ACC-10016",type:"Contact",name:"William Caxton",firstName:"William",lastName:"Caxton",email:"william.caxton@oxfordmanuscripts.com",createdDate:"2022-02-11T11:25:55.965Z",phone:"(617) 555-9102",title:"Paleography Expert"},{Id:"CON-10042",accountId:"ACC-10017",type:"Contact",name:"Thomas Becket",firstName:"Thomas",lastName:"Becket",email:"thomas.becket@canterburyheritage.org",createdDate:"2021-09-19T12:20:40.274Z",phone:"(508) 555-3401",title:"Executive Director"},{Id:"CON-10002",accountId:"ACC-10001",type:"Contact",name:"Jennifer Davis",firstName:"Jennifer",lastName:"Davis",email:"jennifer.davis@globalconcepts.com",createdDate:"2022-03-25T14:30:45.456Z",phone:"(415) 555-1002",title:"VP of Marketing"},{Id:"CON-10003",accountId:"ACC-10002",type:"Contact",name:"Robert Smith",firstName:"Robert",lastName:"Smith",email:"robert.smith@pshealth.com",createdDate:"2021-11-15T10:20:30.789Z",phone:"(310) 555-2001",title:"CEO"},{Id:"CON-10004",accountId:"ACC-10002",type:"Contact",name:"Susan Johnson",firstName:"Susan",lastName:"Johnson",email:"susan.johnson@pshealth.com",createdDate:"2021-11-18T11:25:35.321Z",phone:"(310) 555-2002",title:"Director"},{Id:"CON-10005",accountId:"ACC-10003",type:"Contact",name:"David Martinez",firstName:"David",lastName:"Martinez",email:"david.martinez@rfgoldman.com",createdDate:"2022-01-25T13:15:40.654Z",phone:"(212) 555-3001",title:"CFO"},{Id:"CON-10006",accountId:"ACC-10004",type:"Contact",name:"Elizabeth Brown",firstName:"Elizabeth",lastName:"Brown",email:"elizabeth.brown@amalgamatedfluoro.com",createdDate:"2021-08-22T15:30:45.987Z",phone:"(713) 555-4001",title:"VP of Operations"},{Id:"CON-10007",accountId:"ACC-10004",type:"Contact",name:"William Garcia",firstName:"William",lastName:"Garcia",email:"william.garcia@amalgamatedfluoro.com",createdDate:"2021-08-25T16:40:50.741Z",phone:"(713) 555-4002",title:"Manager"},{Id:"CON-10008",accountId:"ACC-10005",type:"Contact",name:"Sarah Wilson",firstName:"Sarah",lastName:"Wilson",email:"sarah.wilson@lineamatic.com",createdDate:"2022-05-10T09:45:15.852Z",phone:"(312) 555-5001",title:"Director of Sales"},{Id:"CON-10009",accountId:"ACC-10006",type:"Contact",name:"Thomas Rodriguez",firstName:"Thomas",lastName:"Rodriguez",email:"thomas.rodriguez@nationalendowment.com",createdDate:"2021-10-18T11:20:35.963Z",phone:"(617) 555-6001",title:"CEO"},{Id:"CON-10010",accountId:"ACC-10007",type:"Contact",name:"Nancy Taylor",firstName:"Nancy",lastName:"Taylor",email:"nancy.taylor@petrolair.com",createdDate:"2022-03-05T14:35:25.123Z",phone:"(713) 555-7001",title:"VP of Sales"},{Id:"CON-10011",accountId:"ACC-10007",type:"Contact",name:"Charles Anderson",firstName:"Charles",lastName:"Anderson",email:"charles.anderson@petrolair.com",createdDate:"2022-03-08T15:45:30.456Z",phone:"(713) 555-7002",title:"CTO"},{Id:"CON-10013",accountId:"ACC-10003",type:"Contact",name:"Jonathan Parker",firstName:"Jonathan",lastName:"Parker",email:"jonathan.parker@rfgoldman.com",createdDate:"2022-01-27T11:30:40.321Z",phone:"(212) 555-3004",title:"SVP of Investments"},{Id:"CON-10014",accountId:"ACC-10001",type:"Contact",name:"Patricia Reynolds",firstName:"Patricia",lastName:"Reynolds",email:"patricia.reynolds@globalconcepts.com",createdDate:"2022-03-26T13:40:45.654Z",phone:"(415) 555-1003",title:"CEO"},{Id:"CON-10015",accountId:"ACC-10001",type:"Contact",name:"Richard Harrison",firstName:"Richard",lastName:"Harrison",email:"richard.harrison@globalconcepts.com",createdDate:"2022-03-27T14:50:50.987Z",phone:"(415) 555-1004",title:"COO"},{Id:"CON-10016",accountId:"ACC-10002",type:"Contact",name:"Margaret Thompson",firstName:"Margaret",lastName:"Thompson",email:"margaret.thompson@pshealth.com",createdDate:"2021-11-19T15:35:40.741Z",phone:"(310) 555-2003",title:"CTO"},{Id:"CON-10017",accountId:"ACC-10004",type:"Contact",name:"James Perez",firstName:"James",lastName:"Perez",email:"james.perez@amalgamatedfluoro.com",createdDate:"2021-08-26T16:55:55.852Z",phone:"(713) 555-4003",title:"CEO"},{Id:"CON-10018",accountId:"ACC-10005",type:"Contact",name:"Dorothy Mitchell",firstName:"Dorothy",lastName:"Mitchell",email:"dorothy.mitchell@lineamatic.com",createdDate:"2022-05-11T09:25:30.963Z",phone:"(312) 555-5002",title:"CEO"},{Id:"CON-10019",accountId:"ACC-10006",type:"Contact",name:"Christopher Wright",firstName:"Christopher",lastName:"Wright",email:"christopher.wright@nationalendowment.com",createdDate:"2021-10-19T11:30:45.123Z",phone:"(617) 555-6002",title:"CFO"},{Id:"CON-10020",accountId:"ACC-10006",type:"Contact",name:"Elizabeth Carter",firstName:"Elizabeth",lastName:"Carter",email:"elizabeth.carter@nationalendowment.com",createdDate:"2021-10-20T12:40:55.456Z",phone:"(617) 555-6003",title:"Director of Grants"},{Id:"CON-10021",accountId:"ACC-10008",type:"Contact",name:"Samuel Lloyd",firstName:"Samuel",lastName:"Lloyd",email:"samuel.lloyd@cambridgehistorical.org",createdDate:"2021-07-18T10:25:35.789Z",phone:"(617) 555-8001",title:"Executive Director"},{Id:"CON-10023",accountId:"ACC-10008",type:"Contact",name:"George Cromwell",firstName:"George",lastName:"Cromwell",email:"george.cromwell@cambridgehistorical.org",createdDate:"2021-07-20T12:45:45.654Z",phone:"(617) 555-8003",title:"Director of Research"},{Id:"CON-10024",accountId:"ACC-10009",type:"Contact",name:"Laura Chen",firstName:"Laura",lastName:"Chen",email:"laura.chen@peninsulartech.com",createdDate:"2022-04-06T09:15:25.987Z",phone:"(650) 555-9001",title:"CEO"},{Id:"CON-10026",accountId:"ACC-10009",type:"Contact",name:"Emily Liu",firstName:"Emily",lastName:"Liu",email:"emily.liu@peninsulartech.com",createdDate:"2022-04-08T11:35:35.852Z",phone:"(650) 555-9003",title:"VP of Engineering"},{Id:"CON-10027",accountId:"ACC-10010",type:"Contact",name:"Henry Winthrop",firstName:"Henry",lastName:"Winthrop",email:"henry.winthrop@covenanttrust.com",createdDate:"2021-09-23T13:45:30.963Z",phone:"(212) 555-0101",title:"CEO"},{Id:"CON-10028",accountId:"ACC-10010",type:"Contact",name:"Catherine Beauregard",firstName:"Catherine",lastName:"Beauregard",email:"catherine.beauregard@covenanttrust.com",createdDate:"2021-09-24T14:55:35.123Z",phone:"(212) 555-0102",title:"SVP of Client Relations"},{Id:"CON-10029",accountId:"ACC-10011",type:"Contact",name:"Andrew Fairfax",firstName:"Andrew",lastName:"Fairfax",email:"andrew.fairfax@ironcladmfg.com",createdDate:"2022-01-31T10:05:45.456Z",phone:"(412) 555-1201",title:"President"},{Id:"CON-10030",accountId:"ACC-10011",type:"Contact",name:"Rebecca Steele",firstName:"Rebecca",lastName:"Steele",email:"rebecca.steele@ironcladmfg.com",createdDate:"2022-02-01T11:15:50.789Z",phone:"(412) 555-1202",title:"VP of Production"},{Id:"CON-10032",accountId:"ACC-10012",type:"Contact",name:"Michelle Nightingale",firstName:"Michelle",lastName:"Nightingale",email:"michelle.nightingale@meridianhealthcare.com",createdDate:"2021-12-15T14:35:25.654Z",phone:"(305) 555-2301",title:"Chief Medical Officer"},{Id:"CON-10033",accountId:"ACC-10012",type:"Contact",name:"Benjamin Galloway",firstName:"Benjamin",lastName:"Galloway",email:"benjamin.galloway@meridianhealthcare.com",createdDate:"2021-12-16T15:45:30.987Z",phone:"(305) 555-2302",title:"CEO"},{Id:"CON-10034",accountId:"ACC-10013",type:"Contact",name:"Olivia Milton",firstName:"Olivia",lastName:"Milton",email:"olivia.milton@commonwealthpublishing.com",createdDate:"2022-02-20T09:25:15.741Z",phone:"(617) 555-3401",title:"Editor-in-Chief"}]);this.internalData=this.makeMockData()}makeMockData(){const t=[];return t.push(...this.fakeAccounts),t.push(...this.fakeContacts),t}async respondWithData(){try{return await new Promise(t=>setTimeout(t,500)),JSON.stringify(this.internalData)}catch(t){throw console.error("Error: ",t),t}}}const Ju=ot.object({Id:ot.string(),name:ot.string(),createdDate:ot.string(),type:ot.string(),industry:ot.string(),numberOfEmployees:ot.number(),annualRevenue:ot.number(),website:ot.string(),phone:ot.string()}),Qu=ot.object({Id:ot.string(),name:ot.string(),createdDate:ot.string(),type:ot.string(),accountId:ot.string(),firstName:ot.string(),lastName:ot.string(),email:ot.string(),phone:ot.string(),title:ot.string()}),td=ot.discriminatedUnion("type",[Ju.extend({type:ot.literal("Account")}),Qu.extend({type:ot.literal("Contact")})]);class ed{constructor(){}async getRecords(){const t=new Ku;try{return await t.respondWithData()}catch{throw new Error("Couldn't retrieve records from mock endpoint... major skill issue")}}}class sd{constructor(){L(this,"connection",new ed);L(this,"records",[])}async fetchRecords(){try{const t=await this.connection.getRecords(),e=JSON.parse(t);this.processRecords(e)}catch{throw new Error("Bad stuff happened: JSON parse failed")}return this.records}processRecords(t){t.forEach(e=>{const s=td.safeParse(e);if(!s.success){console.warn("Validation failed: ",s.error);return}this.records.push(s.data)})}}class rd{constructor(t){L(this,"actors",[]);L(this,"appReference");this.appReference=t}addActor(t){try{t.addToStage(),this.actors.push(t)}catch(e){console.error("Couldn't add actor to scene: ",e)}}update(){for(let t of this.actors)t.update()}[Symbol.iterator](){return this.actors[Symbol.iterator]()}}class id{constructor(t){L(this,"color1",3652320);L(this,"color2",616065);L(this,"bgGradient");L(this,"appReference");this.appReference=t;const e=new ie({type:"radial",center:{x:.5,y:.33},innerRadius:0,outerCenter:{x:.5,y:.33},outerRadius:.7,colorStops:[{offset:0,color:this.color1},{offset:1,color:this.color2}],textureSpace:"local"});this.bgGradient=new $t,this.bgGradient.rect(0,0,t.screen.width,t.screen.height),this.bgGradient.fill(e)}addToStage(){this.appReference.stage.addChild(this.bgGradient)}update(){}}class nd{constructor(t,e){L(this,"mousePosition",{x:0,y:0});L(this,"cursorShadow");L(this,"appReference");this.mousePosition=e,this.cursorShadow=new $t,this.appReference=t,this.cursorShadow.circle(e.x,e.y,66),this.cursorShadow.fill(16777215);const s=new ii;s.strength=36,this.cursorShadow.alpha=.19,this.cursorShadow.filters=[s]}addToStage(){this.appReference.stage.addChild(this.cursorShadow)}update(){this.cursorShadow.position.set(this.mousePosition.x,this.mousePosition.y)}}class ad{constructor(t,e){L(this,"parent");L(this,"container");L(this,"recordData");L(this,"offsetX",-40);L(this,"offsetY",-130);this.parent=e,this.container=new Yt,this.recordData=t,this.container.visible=!1;let s="";for(let a in this.recordData)s+=a.toString(),s+=": ",s+=this.recordData[a].toString(),s+=`
`;const i=new Ke({fontSize:14,fill:"white",dropShadow:{blur:0,distance:2}}),n=new Ea({text:s,style:i});n.position.x-=this.offsetX,this.container.addChild(n)}show(){this.container.visible=!0}hide(){this.container.visible=!1}update(){}}class $a{constructor(t,e,s){L(this,"appReference");L(this,"container");L(this,"recordData");L(this,"isDragging",!1);L(this,"globalMousePositionRef");L(this,"tooltip");L(this,"hitAreaOffset");L(this,"hitAreaRadius");this.appReference=t,this.container=new Yt,this.recordData=Object.assign({},e),this.globalMousePositionRef=s,this.tooltip=new ad(this.recordData,this.container),this.container.addChild(this.tooltip.container)}setupInteractivity(){this.container&&(this.container.eventMode="dynamic",this.container.cursor="pointer",this.container.hitArea=new pt(this.container.x-this.hitAreaOffset,this.container.y-15,this.hitAreaRadius,this.hitAreaRadius),this.container.on("pointerover",this.onPointerOver.bind(this)),this.container.on("pointerout",this.onPointerOut.bind(this)),this.container.on("pointerdown",this.onPointerDown.bind(this)),this.container.on("pointerup",this.onPointerUp.bind(this)))}onPointerOver(){console.log(`Mouse over record: ${this.recordData.Id}`),this.container.scale=1.2,this.tooltip.container.visible=!this.tooltip.container.visible}onPointerOut(){this.container.scale=1,this.tooltip.container.visible=!this.tooltip.container.visible}onPointerDown(){console.log(`Clicked record: ${this.recordData.Id}`),console.log("Record details:",this.recordData),this.isDragging=!0}onPointerUp(){this.isDragging=!1}drag(){this.isDragging&&(this.container.x=this.globalMousePositionRef.x,this.container.y=this.globalMousePositionRef.y)}addToStage(){if(this.configureGraphic(),this.setupInteractivity(),this.container)this.appReference.stage.addChild(this.container);else throw new Error("You must initialize the graphic object before adding it to the stage (call configureGraphic)")}}class od extends $a{constructor(e,s,i){super(e,s,i);L(this,"sinMod");L(this,"glowFilter",null);L(this,"pulseDirection",1);L(this,"pulseValue",0);this.sinMod=Math.random()*10}configureGraphic(){const e=new $t;e.fill(7074612),e.stroke({width:2,color:5089320}),e.roundRect(0,0,24,24,3.2),e.endFill(),this.container.addChild(e);const s=new Pe(nt.WHITE);s.width=24,s.height=24,s.tint=16777215,s.alpha=.3;const i=new $t;i.fill(16777215),i.roundRect(0,0,24,24,6),i.endFill(),s.mask=i,this.container.addChild(i),s.height=12;const n=new ii({strength:.2,quality:1});this.glowFilter=new Lc,this.glowFilter.brightness(1.2,!1),e.filters=[n,this.glowFilter],this.container.addChild(s),this.container.pivot.x=12,this.container.pivot.y=12,this.hitAreaOffset=0,this.hitAreaRadius=32,this.container.eventMode="static",this.container.on("pointerover",()=>{this.container.scale.set(1.15,1.15),this.glowFilter&&this.glowFilter.brightness(1.5,!1)}),this.container.on("pointerout",()=>{this.container.scale.set(1,1),this.glowFilter&&this.glowFilter.brightness(1.2,!1)})}update(){this.sinMod+=.05,this.sinMod>Math.PI*2&&(this.sinMod=0);const e=.02,s=.01;this.container.position.y=this.container.position.y+Math.sin(this.sinMod)*e,this.container.position.x+=Math.cos(this.sinMod*.7)*.2*s,this.glowFilter&&(this.pulseValue+=.01*this.pulseDirection,this.pulseValue>=1?this.pulseDirection=-1:this.pulseValue<=0&&(this.pulseDirection=1),this.glowFilter.brightness(1.1+this.pulseValue*.5,!1)),this.drag()}}class hd extends $a{constructor(e,s,i){super(e,s,i);L(this,"sinMod");this.sinMod=Math.random()*10}configureGraphic(){var i;const e=new $t;e.ellipse(this.container.x,this.container.y,20,20),e.beginFill(5625589),e.endFill(),this.container.addChild(e);const s=new $t;s.beginFill(11271158,.4),s.drawCircle(2,-4,12),s.endFill(),(i=this.container)==null||i.addChild(s),this.hitAreaOffset=15,this.hitAreaRadius=30,this.container.pivot.x=10,this.container.pivot.y=10}update(){this.sinMod+=.02,this.sinMod>Math.PI*2&&(this.sinMod=0);const e=.04,s=.01;this.container.position.y=this.container.position.y+Math.sin(this.sinMod)*e,this.container.position.x+=Math.cos(this.sinMod*.7)*.2*s,this.drag()}}class ld{constructor(t,e,s){L(this,"appReference");L(this,"container");L(this,"line");L(this,"beginRecord");L(this,"endRecord");L(this,"beginX");L(this,"beginY");L(this,"endX");L(this,"endY");this.appReference=t,this.beginRecord=e,this.endRecord=s,this.beginX=this.beginRecord.container.x,this.beginY=this.beginRecord.container.y,this.endX=this.endRecord.container.x,this.endY=this.endRecord.container.y,this.container=new Yt,this.container.eventMode="none",this.line=new $t,this.container.addChild(this.line)}addToStage(){this.appReference.stage.addChild(this.container)}update(){this.beginX=this.beginRecord.container.position.x,this.beginY=this.beginRecord.container.position.y,this.endX=this.endRecord.container.position.x,this.endY=this.endRecord.container.position.y,this.line.clear(),this.line.moveTo(this.beginX,this.beginY).lineTo(this.endX,this.endY),this.line.stroke({color:16777215,width:2,alpha:.5})}}class cd{constructor(t,e,s=50,i){L(this,"app");L(this,"actors");L(this,"screenWidth");L(this,"screenHeight");L(this,"padding",50);L(this,"globalMousePositionRef");L(this,"accountActorMap",new Map);L(this,"contactActorMap",new Map);this.app=t,this.actors=e,this.screenWidth=this.app.screen.width,this.screenHeight=this.app.screen.height,this.padding=s,this.globalMousePositionRef=i}createAccountPositions(t){const e=[],s=this.screenWidth*.25,i=this.screenHeight*.5,n=this.screenHeight*.7,a=this.screenWidth*.2,o=70;let h=0;const l=t*20;for(;e.length<t&&h<l;){h++;const u=(e.length/Math.max(t-1,1)-.5)*n;let f=s+(Math.random()-.3)*a,d=i+u;d+=(Math.random()-.5)*30,f=Math.max(this.padding,Math.min(this.screenWidth*.4,f)),d=Math.max(this.padding,Math.min(this.screenHeight-this.padding,d));let g=!1;for(const x of e){const m=x.x-f,b=x.y-d;if(Math.sqrt(m*m+b*b)<o){g=!0;break}}g||e.push({x:f,y:d})}if(e.length<t){const c=Math.ceil(Math.sqrt(t-e.length)),u=Math.ceil((t-e.length)/c),f=a/Math.max(u,1),d=n/Math.max(c,1);for(let g=e.length;g<t;g++){const x=g-e.length,m=x%u,b=Math.floor(x/u),v=s-a/2+m*f+f/2,w=i-n/2+b*d+d/2;e.push({x:v,y:w})}}return e}createContactPositions(t){const e=[],i=new Map;for(const o of t){const h=o.accountId;i.has(h)||i.set(h,[]),i.get(h).push(o)}const n=new Map;for(const[o,h]of this.accountActorMap.entries())n.set(o,{x:h.container.position.x,y:h.container.position.y});const a=Array.from(n.values());for(const[o,h]of i.entries()){if(!n.has(o)){console.warn(`Contact has no related account: ${o}`);continue}const l=n.get(o),c=h.length;if(c>0){const u=Math.max(l.x+120,this.screenWidth*.6);for(let f=0;f<c;f++){const d=h[f],g=(f-(c-1)/2)/Math.max(c,1)*120;let x=!1,m=0,b,v;for(;!x&&m<10;){m++,b=u+Math.random()*160,v=l.y+g+(Math.random()-.5)*40,b=Math.max(this.screenWidth*.5,Math.min(this.screenWidth-this.padding,b)),v=Math.max(this.padding,Math.min(this.screenHeight-this.padding,v));let A=!1;for(const R of a){const k=R.x-b,P=R.y-v;if(Math.sqrt(k*k+P*P)<100){A=!0;break}}A||(x=!0)}const w={x:b,y:v,contactId:d.Id};e.push(w),a.push({x:b,y:v})}}}return e}createAccountActors(t){if(t.length===0)return;const e=this.createAccountPositions(t.length);t.forEach((s,i)=>{const n=new hd(this.app,s,this.globalMousePositionRef);this.actors.addActor(n),n.container.position.set(e[i].x,e[i].y),this.accountActorMap.set(s.Id,n)})}createContactActors(t){if(t.length===0)return;const e=this.createContactPositions(t);t.forEach(s=>{const i=new od(this.app,s,this.globalMousePositionRef);this.actors.addActor(i);const n=e.find(a=>a.contactId===s.Id);n&&i.container.position.set(n.x,n.y),this.contactActorMap.set(s.Id,i)})}createRelationships(){for(const[t,e]of this.contactActorMap.entries()){const i=e.recordData.accountId;if(this.accountActorMap.has(i)){const n=this.accountActorMap.get(i),a=new ld(this.app,e,n);this.actors.addActor(a)}}}createRecordActors(t){if(!t||t.length===0){console.warn("No records to create actors from");return}const e=[],s=[];for(const i of t)i.type==="Account"?e.push(i):i.type==="Contact"&&s.push(i);this.createAccountActors(e),this.createContactActors(s),this.createRelationships(),console.log(`Created ${e.length} accounts, ${s.length} contacts`)}}class ud{constructor(t){L(this,"appReference");this.appReference=t}async load(){const t={x:0,y:0};this.appReference.stage.eventMode="static",this.appReference.stage.hitArea=this.appReference.screen,this.appReference.stage.on("pointermove",l=>{t.x=l.global.x,t.y=l.global.y});const e=new rd(this.appReference);this.appReference.ticker.add(()=>{e.update()}),e.addActor(new id(this.appReference)),e.addActor(new nd(this.appReference,t));const i=await new sd().fetchRecords();console.log(`Records received in Scene: ${i.length}`),new cd(this.appReference,e,50,t).createRecordActors(i);const a=`this demo visualizes CRM records retrieved from a mock endpoint 
    and draws lines to represent their relationships
    this demo covers:
    Types: interfaces, abstract classes, discriminated unions, generics
Safety: schema validation, null checks, type guards
Async: promises, async/await, error handling
External library integration: PixiJS, Zod with type definitions
Events: pointer events, click and drag
Architecture: component-based
Practices: explicit types, access control, error handling, immutability`,o=new Ke({fontSize:12,fill:16777215,align:"center"}),h=new Ea({text:a,style:o});h.position={x:0,y:this.appReference.canvas.height-h.height-24},this.appReference.stage.addChild(h)}}(async()=>{const r=new la;await r.init({background:"#2c3335",resizeTo:window,antialias:!0}),document.getElementById("pixi-container").appendChild(r.canvas),await new ud(r).load()})();export{yt as $,na as A,Ct as B,Yt as C,Ft as D,rt as E,Xr as F,_e as G,Mn as H,Bt as I,Ze as J,wi as K,Pe as L,J as M,uh as N,wh as O,xt as P,ft as Q,Ye as R,bh as S,ys as T,Tr as U,pt as V,Th as W,Si as X,Ks as Y,Ti as Z,Uo as _,Zt as a,In as a0,aa as a1,X as a2,ct as a3,Rh as a4,Jh as a5,yl as a6,_l as a7,Sl as a8,Tl as a9,Ml as aa,Kr as ab,ie as ac,Pc as ad,Ic as ae,ks as af,Ke as ag,Ce as ah,Sc as ai,ba as aj,Ui as ak,Li as al,oo as am,$t as an,lo as ao,Ca as ap,Zh as b,Xe as c,As as d,Pt as e,Vi as f,$h as g,Hr as h,sa as i,Ln as j,Ht as k,Yr as l,gl as m,ci as n,xl as o,wl as p,Al as q,Co as r,ca as s,Gs as t,nt as u,ho as v,Tt as w,us as x,Pl as y,te as z};
